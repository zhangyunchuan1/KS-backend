webpackJsonp([17],{"CV+A":function(e,t){},Gh0L:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("ZPfm"),s=a("XLwt"),n=a.n(s),r={name:"activeStatus",components:{BreadCrumb:i.a},data:function(){var e=this;return{pickerOptions:{disabledDate:function(t){return(t.getTime()-new Date(e.startTime).getTime())/1e3/60/60/24>31}},startTime:"",startviewTime:"",endTime:"",endviewTime:"",userType:"",userviewType:"",breadData:[{id:1,name:"活动管理",urls:"/index",icon:"icon-home"},{id:2,name:"活动状态",urls:"/index/test",icon:"icon-home"}],userOptions:[{value:1,label:"个人用户"},{value:2,label:"专业商家"},{value:3,label:"普通商家"}],activeNum:[],activeTotal:0,activeviewTotal:0,activeDate:[],activeviewDate:[],car:{normal:0,business:0},motorcycle:{normal:0,business:0},plane:{normal:0,business:0},intelligent:{normal:0,business:0},carview:{normal:0,business:0},motorcycleview:{normal:0,business:0},planeview:{normal:0,business:0},intelligentview:{normal:0,business:0},totalByDate:0,totalByDateview:0,caractive:[],motoractive:[],planeactive:[],intelligentactive:[],carviewactive:[],motorviewactive:[],planeviewactive:[],intelligentviewactive:[],carMenuID:"",motorMenuID:"",planeMenuID:"",intelligentMenuID:""}},methods:{drawLine:function(){var e=this,t=(new Date(this.endTime).getTime()-new Date(this.startTime).getTime())/1e3/60/60/24,a=new Date(this.startTime).getDate(),i=new Date(this.startTime).getFullYear(),s=new Date(this.startTime).getMonth()+1,r=[],l=0;switch(s){case 1:l=31;break;case 2:l=i%400==0||i%4==0&&i%100!=0?29:28;break;case 3:l=31;break;case 4:l=30;break;case 5:l=31;break;case 6:l=30;break;case 7:case 8:l=31;break;case 9:l=30;break;case 10:l=31;break;case 11:l=30;break;case 12:l=31}for(var c=0;c<t;c++)a+c>l?r.push(a+c-l):r.push(a+c);var v=[],o=[],m=[],u=[];r.map(function(t){var a=0,n=0,r=0,l=0,c=0,p=0,_=0,d=0,w=0,y=0,b=0,h=0,g=0,D=0,T=0,f=0;t=e.initFormat(t),e.caractive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(a+=Number(e.actives),1===e.user_type?n+=Number(e.actives):2===e.user_type?r+=Number(e.actives):3===e.user_type&&(l+=Number(e.actives)))}),e.motoractive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(c+=Number(e.actives),1===e.user_type?p+=Number(e.actives):2===e.user_type?_+=Number(e.actives):3===e.user_type&&(d+=Number(e.actives)))}),e.planeactive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(w+=Number(e.actives),1===e.user_type?y+=Number(e.actives):2===e.user_type?b+=Number(e.actives):3===e.user_type&&(h+=Number(e.actives)))}),e.intelligentactive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(g+=Number(e.actives),1===e.user_type?D+=Number(e.actives):2===e.user_type?T+=Number(e.actives):3===e.user_type&&(f+=Number(e.actives)))}),1===e.userType?(v.push(n),o.push(p),m.push(y),u.push(D)):2===e.userType?(v.push(r),o.push(_),m.push(b),u.push(T)):3===e.userType?(v.push(l),o.push(d),m.push(h),u.push(f)):""===e.userType&&(v.push(a),o.push(c),m.push(w),u.push(g))}),n.a.init(document.getElementById("myChart")).setOption({tooltip:{trigger:"axis"},xAxis:{type:"category",data:r},yAxis:{type:"value"},series:[{itemStyle:{normal:{color:"#009efb",lineStyle:{color:"#009efb"}}},name:"汽车",type:"line",smooth:!0,data:v},{itemStyle:{normal:{color:"#55ce63",lineStyle:{color:"#55ce63"}}},name:"摩托车",type:"line",smooth:!0,data:o},{itemStyle:{normal:{color:"#ff7676",lineStyle:{color:"#ff7676"}}},name:"无人机",type:"line",smooth:!0,data:m},{itemStyle:{normal:{color:"#FFB82E",lineStyle:{color:"#FFB82E"}}},name:"智能设备",type:"line",smooth:!0,data:u}]})},getDataByDate:function(){var e=this;this.HttpClient.post("/admin/analysis/diagram",{type:5,begin:this.startTime,end:this.endTime}).then(function(t){200===t.data.code&&(e.activeDate=t.data.data,console.log(e.activeDate),e.totalByDate=0,e.car.normal=0,e.car.business=0,e.motorcycle.normal=0,e.motorcycle.business=0,e.plane.normal=0,e.plane.business=0,e.intelligent.normal=0,e.intelligent.business=0,e.caractive=[],e.motoractive=[],e.planeactive=[],e.intelligentactive=[],e.activeDate.map(function(t){t.folder_type===e.carMenuID?(e.caractive.push(t),1===t.user_type?(e.car.normal+=Number(t.actives),e.totalByDate+=Number(t.actives)):(e.car.business+=Number(t.actives),e.totalByDate+=Number(t.actives))):t.folder_type===e.motorMenuID?(e.motoractive.push(t),1===t.user_type?(e.motorcycle.normal+=Number(t.actives),e.totalByDate+=Number(t.actives)):(e.motorcycle.business+=Number(t.actives),e.totalByDate+=Number(t.actives))):t.folder_type===e.planeMenuID?(e.planeactive.push(t),1===t.user_type?(e.plane.normal+=Number(t.actives),e.totalByDate+=Number(t.actives)):(e.plane.business+=Number(t.actives),e.totalByDate+=Number(t.actives))):t.folder_type===e.intelligentMenuID&&(e.intelligentactive.push(t),1===t.user_type?(e.intelligent.normal+=Number(t.actives),e.totalByDate+=Number(t.actives)):(e.intelligent.business+=Number(t.actives),e.totalByDate+=Number(t.actives)))}),e.drawLine())})},getviewDataByDate:function(){var e=this;console.log(this.startviewTime),console.log(this.endviewTime),this.HttpClient.post("/admin/analysis/diagram",{type:5,begin:this.startviewTime,end:this.endviewTime}).then(function(t){200===t.data.code&&(e.activeviewDate=t.data.data,console.log(e.activeviewDate),e.totalByDateview=0,e.carview.normal=0,e.carview.business=0,e.motorcycleview.normal=0,e.motorcycleview.business=0,e.planeview.normal=0,e.planeview.business=0,e.intelligentview.normal=0,e.intelligentview.business=0,e.carviewactive=[],e.motorviewactive=[],e.planeviewactive=[],e.intelligentviewactive=[],e.activeviewDate.map(function(t){t.folder_type===e.carMenuID?(e.carviewactive.push(t),1===t.user_type?(e.carview.normal+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view)):(e.carview.business+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view))):t.folder_type===e.motorMenuID?(e.motorviewactive.push(t),1===t.user_type?(e.motorcycleview.normal+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view)):(e.motorcycleview.business+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view))):t.folder_type===e.planeMenuID?(e.planeviewactive.push(t),1===t.user_type?(e.planeview.normal+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view)):(e.planeview.business+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view))):t.folder_type===e.intelligentMenuID&&(e.intelligentviewactive.push(t),1===t.user_type?(e.intelligentview.normal+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view)):(e.intelligentview.business+=Number(t.actives_view),e.totalByDateview+=Number(t.actives_view)))}),e.drawviewLine())})},drawviewLine:function(){var e=this,t=(new Date(this.endviewTime).getTime()-new Date(this.startviewTime).getTime())/1e3/60/60/24,a=new Date(this.startviewTime).getDate(),i=new Date(this.startviewTime).getFullYear(),s=new Date(this.startviewTime).getMonth()+1,r=[],l=0;switch(s){case 1:l=31;break;case 2:l=i%400==0||i%4==0&&i%100!=0?29:28;break;case 3:l=31;break;case 4:l=30;break;case 5:l=31;break;case 6:l=30;break;case 7:case 8:l=31;break;case 9:l=30;break;case 10:l=31;break;case 11:l=30;break;case 12:l=31}for(var c=0;c<t;c++)a+c>l?r.push(a+c-l):r.push(a+c);var v=[],o=[],m=[],u=[];r.map(function(t){var a=0,n=0,r=0,l=0,c=0,p=0,_=0,d=0,w=0,y=0,b=0,h=0,g=0,D=0,T=0,f=0;t=e.initFormat(t),e.carviewactive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(a+=Number(e.actives_view),1===e.user_type?n+=Number(e.actives_view):2===e.user_type?r+=Number(e.actives_view):3===e.user_type&&(l+=Number(e.actives_view)))}),e.motorviewactive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(c+=Number(e.actives_view),1===e.user_type?p+=Number(e.actives_view):2===e.user_type?_+=Number(e.actives_view):3===e.user_type&&(d+=Number(e.actives_view)))}),e.planeviewactive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(w+=Number(e.actives_view),1===e.user_type?y+=Number(e.actives_view):2===e.user_type?b+=Number(e.actives_view):3===e.user_type&&(h+=Number(e.actives_view)))}),e.intelligentviewactive.map(function(e){new Date(i+"-"+(s<10?"0"+s:s)+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()&&new Date((s>=12?i+1+"-01":i+"-"+(s<10?"0"+(s+1):s+1))+"-"+t).getTime()!==new Date(e.created_at.split(" ")[0]).getTime()||(g+=Number(e.actives_view),1===e.user_type?D+=Number(e.actives_view):2===e.user_type?T+=Number(e.actives_view):3===e.user_type&&(f+=Number(e.actives_view)))}),1===e.userviewType?(v.push(n),o.push(p),m.push(y),u.push(D)):2===e.userviewType?(v.push(r),o.push(_),m.push(b),u.push(T)):3===e.userviewType?(v.push(l),o.push(d),m.push(h),u.push(f)):""===e.userviewType&&(v.push(a),o.push(c),m.push(w),u.push(g))}),n.a.init(document.getElementById("myviewChart")).setOption({tooltip:{trigger:"axis"},xAxis:{type:"category",data:r},yAxis:{type:"value"},series:[{itemStyle:{normal:{color:"#009efb",lineStyle:{color:"#009efb"}}},name:"汽车",type:"line",smooth:!0,data:v},{itemStyle:{normal:{color:"#55ce63",lineStyle:{color:"#55ce63"}}},name:"摩托车",type:"line",smooth:!0,data:o},{itemStyle:{normal:{color:"#ff7676",lineStyle:{color:"#ff7676"}}},name:"无人机",type:"line",smooth:!0,data:m},{itemStyle:{normal:{color:"#FFB82E",lineStyle:{color:"#FFB82E"}}},name:"智能设备",type:"line",smooth:!0,data:u}]})},initFormat:function(e){return e<10&&(e="0"+e),e},initDateValue:function(e){var t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),s=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return t+"-"+(a=this.initFormat(a))+"-"+(i=this.initFormat(i))+" "+(s=this.initFormat(s))+":"+(n=this.initFormat(n))+":"+(r=this.initFormat(r))}},created:function(){var e=this,t=this.initDateValue(new Date).split("-");"01"==t[1]?(t[0]=t[0]-1,t[1]="12"):t[1]=t[1]-1,t.join("-"),this.startTime=t.join("-"),this.endTime=this.initDateValue(new Date);var a=this.initDateValue(new Date).split("-");"01"==a[1]?(a[0]=a[0]-1,a[1]="12"):a[1]=a[1]-1,a.join("-"),this.startviewTime=a.join("-"),this.endviewTime=this.initDateValue(new Date),this.HttpClient.post("/admin/analysis/numCache",{type:5}).then(function(t){200===t.data.code&&(e.activeNum=t.data.data,console.log(t.data.data),e.activeNum.map(function(t){"汽车"==t.name?e.carMenuID=t.menu_id:"摩托"==t.name?e.motorMenuID=t.menu_id:"模型"==t.name?e.planeMenuID=t.menu_id:"智能设备"==t.name&&(e.intelligentMenuID=t.menu_id),t.number=0,t.number+=Number(t.analysis.company_actives),t.number+=Number(t.analysis.normal_actives),t.numberview=0,t.numberview+=Number(t.analysis.company_actives_view),t.numberview+=Number(t.analysis.normal_actives_view),e.activeTotal+=t.number,e.activeviewTotal+=t.numberview}))}),this.getDataByDate(),this.getviewDataByDate()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ActivityData"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:e.breadData}}),e._v(" "),a("div",{staticClass:"content"},[a("p",{staticClass:"title"},[e._v("活动状态")]),e._v(" "),a("div",{staticStyle:{padding:"0 20px"}},[a("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0",cellpadding:"0"}},[a("thead",[a("th",{staticClass:"my_th",attrs:{colspan:e.activeNum.length}},[e._m(0),e._v("\n            "+e._s(e.activeTotal)+"\n          ")])]),e._v(" "),a("tbody",[a("tr",{staticClass:"tr1"},e._l(e.activeNum,function(t){return a("td",{key:t.id},[e._v(e._s(t.name))])})),e._v(" "),a("tr",{staticClass:"tr2"},e._l(e.activeNum,function(t){return a("td",{key:t.id},[e._v(e._s(t.number))])}))])]),e._v(" "),a("div",[a("div",{staticClass:"conditions"},[a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[e._v("开始")]),e._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},on:{change:e.getDataByDate},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}})],1),e._v(" "),a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[e._v("截止")]),e._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},on:{change:e.getDataByDate},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1),e._v(" "),a("el-select",{staticClass:"select_type",attrs:{size:"mini",clearable:"",placeholder:"全部"},on:{change:e.drawLine},model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"shape_content"},[a("div",{staticClass:"shape_header"},[a("div",{staticClass:"shape_header_left"},[a("p",{staticClass:"left_title"},[e._v("活动数量曲线图")]),e._v(" "),a("div",{staticClass:"time_range"},[a("span",[e._v(e._s(e.startTime.split(" ")[0]))]),e._v(" "),a("span",[e._v("---")]),e._v(" "),a("span",[e._v(e._s(e.endTime.split(" ")[0]))])])]),e._v(" "),a("div",{staticClass:"shape_header_right"},[a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color1"}),e._v(" "),a("p",[e._v("汽车占"+e._s(((e.car.normal+e.car.business)/e.totalByDate*100).toFixed(2))+"%")])]),e._v(" "),a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color2"}),e._v(" "),a("p",[e._v("摩托车占"+e._s(((e.motorcycle.normal+e.motorcycle.business)/e.totalByDate*100).toFixed(2))+"%")])]),e._v(" "),a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color3"}),e._v(" "),a("p",[e._v("模型占"+e._s(((e.plane.normal+e.plane.business)/e.totalByDate*100).toFixed(2))+"%")])]),e._v(" "),a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color4"}),e._v(" "),a("p",[e._v("智能设备占"+e._s(((e.intelligent.normal+e.intelligent.business)/e.totalByDate*100).toFixed(2))+"%")])])])]),e._v(" "),a("div",{style:{width:"980px",height:"400px"},attrs:{id:"myChart"}})])])]),e._v(" "),a("div",{staticStyle:{padding:"0 20px"}},[a("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0",cellpadding:"0"}},[a("thead",[a("th",{staticClass:"my_th",attrs:{colspan:e.activeNum.length}},[e._m(1),e._v("\n            "+e._s(e.activeviewTotal)+"\n          ")])]),e._v(" "),a("tbody",[a("tr",{staticClass:"tr1"},e._l(e.activeNum,function(t){return a("td",{key:t.id},[e._v(e._s(t.name))])})),e._v(" "),a("tr",{staticClass:"tr2"},e._l(e.activeNum,function(t){return a("td",{key:t.id},[e._v(e._s(t.numberview))])}))])]),e._v(" "),a("div",[a("div",{staticClass:"conditions"},[a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[e._v("开始")]),e._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},on:{change:e.getviewDataByDate},model:{value:e.startviewTime,callback:function(t){e.startviewTime=t},expression:"startviewTime"}})],1),e._v(" "),a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[e._v("截止")]),e._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},on:{change:e.getviewDataByDate},model:{value:e.endviewTime,callback:function(t){e.endviewTime=t},expression:"endviewTime"}})],1),e._v(" "),a("el-select",{staticClass:"select_type",attrs:{size:"mini",clearable:"",placeholder:"全部"},on:{change:e.drawviewLine},model:{value:e.userviewType,callback:function(t){e.userviewType=t},expression:"userviewType"}},e._l(e.userOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"shape_content"},[a("div",{staticClass:"shape_header"},[a("div",{staticClass:"shape_header_left"},[a("p",{staticClass:"left_title"},[e._v("活动浏览量曲线图")]),e._v(" "),a("div",{staticClass:"time_range"},[a("span",[e._v(e._s(e.startviewTime.split(" ")[0]))]),e._v(" "),a("span",[e._v("---")]),e._v(" "),a("span",[e._v(e._s(e.endviewTime.split(" ")[0]))])])]),e._v(" "),a("div",{staticClass:"shape_header_right"},[a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color1"}),e._v(" "),a("p",[e._v("汽车占"+e._s(((e.carview.normal+e.carview.business)/e.totalByDateview*100).toFixed(2))+"%")])]),e._v(" "),a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color2"}),e._v(" "),a("p",[e._v("摩托车占"+e._s(((e.motorcycleview.normal+e.motorcycleview.business)/e.totalByDateview*100).toFixed(2))+"%")])]),e._v(" "),a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color3"}),e._v(" "),a("p",[e._v("模型占"+e._s(((e.planeview.normal+e.planeview.business)/e.totalByDateview*100).toFixed(2))+"%")])]),e._v(" "),a("div",{staticClass:"right_items"},[a("div",{staticClass:"point color4"}),e._v(" "),a("p",[e._v("智能设备占"+e._s(((e.intelligentview.normal+e.intelligentview.business)/e.totalByDateview*100).toFixed(2))+"%")])])])]),e._v(" "),a("div",{style:{width:"980px",height:"400px"},attrs:{id:"myviewChart"}})])])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("i",{staticClass:"iconfont icon-star"}),this._v("\n              活动总数\n            ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("i",{staticClass:"iconfont icon-star"}),this._v("\n              活动浏览量\n            ")])}]};var c=a("VU/8")(r,l,!1,function(e){a("CV+A"),a("UaG/")},"data-v-91b36f40",null);t.default=c.exports},"UaG/":function(e,t){}});