webpackJsonp([157],{"4SeZ":function(t,e){},PMqn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),n=a.n(i),o=a("gRE1"),s=a.n(o),l=a("exGp"),r=a.n(l),c={name:"UserComment",components:{BreadCrumb:a("ZPfm").a},data:function(){return{breadData:[{id:1,name:"淘货",urls:"/index/market/Market",icon:"icon-home"},{id:2,name:"销售情况",urls:"/index/market/marketSales/MarketSales",icon:"icon-home"},{id:3,name:"用户评论",urls:"/index/market/marketSales/UserComment",icon:"icon-home"}],contentHeader:null,typeList:[],IDSearch:"",rate:0,tableData:[],disableDialog:!1,rejectList:[],rejectReason:"",rejectValue:"",restoreDialog:!1,evaluationDialog:!1,evaluationBox:!1,evaluationBtm:!0,innerVisible:!1,commentInfo:{},imgUrl:"",currentPage:1,pageSize:25,total:0}},methods:{evaluationBoxOpen:function(){1==this.evaluationBtm?(this.evaluationBox=!0,this.evaluationBtm=!1):(this.evaluationBox=!1,this.evaluationBtm=!0)},getCommentFrequency:function(){var t=this;this.HttpClient.post("/admin/answers/rate",{type:1}).then(function(e){console.log(e),200===e.data.code&&(t.rate=e.data.data.rate)})},getCommentList:function(){var t=this,e={page:this.currentPage,size:this.pageSize,type:7};this.IDSearch&&(e.order_no=this.IDSearch),this.contentHeader&&(e.folder_id=this.contentHeader),this.HttpClient.post("/admin/answers/getList",e).then(function(e){console.log(e),200===e.data.code&&(t.tableData=e.data.data.data,t.total=e.data.data.total)})},changeStatus:function(t){var e=this;console.log(this.id);var a={answer_id:this.id,status:t};3===t&&(a.review=this.rejectReason,a.review_id=this.rejectValue),this.HttpClient.post("/admin/answers/changeStatus",a).then(function(a){200===a.data.code?(e.$message.success(a.data.msg),1===t?e.restoreDialog=!1:3===t&&(e.disableDialog=!1),setTimeout(function(){e.getCommentList()},500)):e.$message.error(a.data.msg)})},previewButton:function(t){var e=this;this.id=t,this.evaluationDialog=!0,this.HttpClient.post("/admin/answers/preview",{id:t}).then(function(t){console.log(t),200===t.data.code&&(e.commentInfo=t.data.data)})},forbiddenButton:function(t){var e=this;this.id=t,console.log(this.id),this.HttpClient.post("/admin/webReview/getList",{type:"answers"}).then(function(t){200===t.data.code&&(e.rejectList=t.data.data)}),this.disableDialog=!0},enabledButton:function(t){this.id=t,this.restoreDialog=!0},previewImg:function(t){this.innerVisible=!0,this.imgUrl=this.Tools.handleImg(t)},forbiddenConfirm:function(){this.changeStatus(3)},enabledConfirm:function(){this.changeStatus(1)},getTypeList:function(){var t=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.HttpClient.post("/admin/menu/getList",{menu_type:2,type:0,goods:!0}).then(function(e){console.log(e),200===e.data.code&&(t.typeList=s()(e.data.data))});case 2:case"end":return e.stop()}},e,t)}))()},currentChange:function(t){this.currentPage=t,this.getCommentList()}},created:function(){var t=this;return r()(n.a.mark(function e(){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTypeList();case 2:t.getCommentFrequency(),t.getCommentList();case 4:case"end":return e.stop()}},e,t)}))()}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"userComment"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"userComment_main"},[t._m(0),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content_header"},[a("div",{staticClass:"content_header_frequency"},[t._v("评论频率"),a("span",[t._v(t._s(t.rate.toFixed(2)))])]),t._v(" "),a("el-radio-group",{on:{change:t.getCommentList},model:{value:t.contentHeader,callback:function(e){t.contentHeader=e},expression:"contentHeader"}},[a("el-radio",{attrs:{border:"",label:null}},[t._v("全部板块")]),t._v(" "),t._l(t.typeList,function(e){return a("el-radio",{key:e.id,attrs:{border:"",label:e.menu_id}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),a("div",{staticClass:"content_table"},[a("div",{staticClass:"content_table_header"},[a("div",{staticClass:"content_search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"订单编号搜索",size:"mini",clearable:""},on:{clear:t.getCommentList},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getCommentList(e):null}},model:{value:t.IDSearch,callback:function(e){t.IDSearch=e},expression:"IDSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getCommentList},slot:"append"})],1)],1)]),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"用户昵称",align:"center","show-overflow-tooltip":"",width:"150",prop:"nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"订单编号",align:"center","show-overflow-tooltip":"",width:"160",prop:"order_no",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"下单时间",align:"center",width:"160",prop:"created_at",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"到货时间",align:"center",width:"160",prop:"take_delivery_time",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                    "+t._s(e.row.take_delivery_time?e.row.take_delivery_time:"无")+"\n                                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center",width:"100",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:1===e.row.status?"color:#1E90FF;":"color:#A52A2A;"},[t._v(t._s(1===e.row.status?"正常":"未通过"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"打分",align:"center",width:"100",prop:"score",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"评价内容",align:"center","show-overflow-tooltip":"",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{domProps:{innerHTML:t._s(e.row.content)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"encyclopedia_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"encyclopedia_btm"},[a("el-button",{attrs:{size:"medium ",type:"text"}},[t._v("查看商品")]),t._v(" "),a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.previewButton(e.row.id)}}},[t._v("查看评论")]),t._v(" "),2===e.row.status||1===e.row.status?a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.forbiddenButton(e.row.answer_id)}}},[t._v("\n                                        禁用\n                                    ")]):t._e(),t._v(" "),1!==e.row.status?a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.enabledButton(e.row.answer_id)}}},[t._v("启用")]):t._e()],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pagination"},[t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)],1)])])]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.disableDialog},on:{"update:visible":function(e){t.disableDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("禁用")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("理由：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:4},model:{value:t.rejectReason,callback:function(e){t.rejectReason=e},expression:"rejectReason"}})],1)]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("类别：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-radio-group",{model:{value:t.rejectValue,callback:function(e){t.rejectValue=e},expression:"rejectValue"}},t._l(t.rejectList,function(e){return a("el-radio",{key:e.id,attrs:{border:"",label:e.review_id}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.disableDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.forbiddenConfirm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"restoreDialog",visible:t.restoreDialog,center:""},on:{"update:visible":function(e){t.restoreDialog=e}}},[a("span",{staticClass:"restoreDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"restoreDialog_box"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("p",[t._v("确定恢复吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.restoreDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.enabledConfirm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"evaluationDialog",visible:t.evaluationDialog,center:""},on:{"update:visible":function(e){t.evaluationDialog=e}}},[a("span",{staticClass:"evaluationDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"evaluationDialog_box"},[a("p",{staticClass:"evaluation_title"},[t._v("评价内容：")]),t._v(" "),a("div",{staticClass:"evaluation_box",class:{evaluationBox:t.evaluationBox},domProps:{innerHTML:t._s(t.commentInfo.content)}}),t._v(" "),a("div",{staticClass:"evaluationBtm",on:{click:t.evaluationBoxOpen}},[t.evaluationBtm?a("span",[t._v("查看更多")]):a("span",[t._v("收起")])]),t._v(" "),a("p",{staticClass:"annex_title"},[t._v("附件:")]),t._v(" "),a("div",{staticClass:"annex_box"},t._l(t.commentInfo.attachment,function(e,i){return a("img",{key:i,attrs:{src:t.Tools.handleImg(e.path),alt:""},on:{click:function(a){t.previewImg(e.path)}}})}))]),t._v(" "),a("el-dialog",{attrs:{width:"30%","custom-class":"evaluationChildren",visible:t.innerVisible,"append-to-body":""},on:{"update:visible":function(e){t.innerVisible=e}}},[a("img",{attrs:{src:t.imgUrl,alt:""}})]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.evaluationDialog=!1}}},[t._v("关 闭")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("用户评论")])])}]};var u=a("VU/8")(c,d,!1,function(t){a("4SeZ")},null,null);e.default=u.exports}});