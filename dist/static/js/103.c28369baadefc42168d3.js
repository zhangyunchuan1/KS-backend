webpackJsonp([103],{EzsQ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("gRE1"),o=a.n(i),n=a("ZPfm"),s=a("+jNi"),l={name:"ArticleComment",components:{BreadCrumb:n.a,DeleteModal:s.a},data:function(){return{breadData:[{id:1,name:"文章管理",urls:"/index/article",icon:"icon-home"},{id:2,name:"评论管理",urls:"/index/article/comment",icon:"icon-home"}],statisticsTotal:0,statisticsData:[],typelistData:[],contentTime:"",contentData:[],tableforbiddenList:[],forbiddenList:[],disableDialog:!1,disableDialogRadio:{},recoverDialog:!1,previewDialog:!1,articleTitle:"",nickname:"",currentPage:1,pageSize:25,total:0,answerId:"",previewContent:""}},methods:{getTypeList:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:2,type:6}).then(function(e){200===e.data.code&&(console.log(e),o()(e.data.data).forEach(function(e){var a={};a.text=e.name,a.value=e.name,console.log(a),t.typelistData.push(a)}),console.log(t.typelistData))})},filterTag:function(t,e,a){return e[a.property]===t},getTotalData:function(){var t=this;this.HttpClient.post("/admin/answers/getAnswerCount",{type:"article"}).then(function(e){console.log(e.data.data),200===e.data.code&&(t.statisticsTotal=e.data.data.total,t.statisticsData=e.data.data.info)})},getforbidList:function(){var t=this;this.HttpClient.post("/admin/webReview/getList",{type:"answers"}).then(function(e){console.log(e.data.data),200==e.data.code&&(t.forbiddenList=e.data.data,t.forbiddenList.forEach(function(e){var a={};a.text=e.name,a.value=e.name,t.tableforbiddenList.push(a)}))})},getCommentList:function(){var t=this,e={type:1,page:this.currentPage,size:this.pageSize};this.articleTitle&&(e.source_title=this.articleTitle),this.nickname&&(e.user_name=this.nickname),this.contentTime.length>0&&(e.start_time=this.contentTime[0],e.end_time=this.contentTime[1]),this.HttpClient.post("/admin/answers/getList",e).then(function(e){console.log(e),200===e.data.code&&(t.contentData=e.data.data.data,t.total=e.data.data.total,t.statisticsData.totalnum=t.total)})},changeStatus:function(t){var e=this;console.log(this.disableDialogRadio);var a={answer_id:this.answerId,status:t};3===t&&(a.review=this.disableDialogRadio.name,a.review_id=this.disableDialogRadio.review_id),this.HttpClient.post("/admin/answers/changeStatus",a).then(function(t){console.log(t),200===t.data.code?(e.$message.success("操作成功"),e.disableDialog=!1,setTimeout(function(){e.getCommentList()},500)):e.$message.error(t.data.msg)})},rejectButton:function(t,e){this.disableDialog=!0,this.answerId=t,this.getforbidList()},deleteButton:function(t){this.answerId=t,this.$refs.delete.deleteDialog=!0},recoverButton:function(t){this.answerId=t,this.recoverDialog=!0},previewButton:function(t){var e=this;this.previewDialog=!0,this.HttpClient.post("/admin/answers/preview",{id:t}).then(function(t){console.log(t),200===t.data.code&&(e.previewContent=t.data.data.content)})},confirmReject:function(){this.changeStatus(3)},confirmDelete:function(){this.changeStatus(0)},confirmRecover:function(){this.recoverDialog=!1,this.changeStatus(1)},currentChange:function(t){this.currentPage=t,this.getCommentList()}},created:function(){this.getCommentList(),this.getforbidList(),this.getTotalData(),this.getTypeList()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"articleComment"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"articleComment_box"},[a("div",{staticClass:"title"},[t._v("评论管理")]),t._v(" "),a("div",{staticClass:"articleComment_main"},[a("div",{staticClass:"articleComment_statistics"},[a("div",{staticClass:"article_table"},[a("div",{staticClass:"table_title"},[a("i",{staticClass:"iconfont icon-star"}),t._v("评论总数 "+t._s(t.statisticsTotal)+"\n          ")]),t._v(" "),a("div",{staticClass:"table_box"},t._l(t.statisticsData,function(e){return a("div",{key:e.id,staticClass:"table_box_list"},[a("p",[t._v(t._s(e.name))]),t._v(" "),a("p",[t._v(t._s(e.num))])])}))])]),t._v(" "),a("div",{staticClass:"articleComment_content"},[a("form",[a("div",{staticClass:"content_header"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.getCommentList},model:{value:t.contentTime,callback:function(e){t.contentTime=e},expression:"contentTime"}}),t._v(" "),a("div",{staticClass:"content_header_search"},[a("el-input",{attrs:{placeholder:"文章名称",clearable:""},on:{clear:t.getCommentList},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getCommentList(e):null}},model:{value:t.articleTitle,callback:function(e){t.articleTitle=e},expression:"articleTitle"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getCommentList},slot:"append"})],1),t._v(" "),a("el-input",{attrs:{placeholder:"昵称搜索",clearable:""},on:{clear:t.getCommentList},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getCommentList(e):null}},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getCommentList},slot:"append"})],1)],1)],1),t._v(" "),a("div",{staticClass:"content_table",staticStyle:{width:"80%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contentData,border:""}},[a("el-table-column",{attrs:{prop:"id",sortable:"",width:"80px",align:"center",label:"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"nickname",width:"100","show-overflow-tooltip":"",align:"center",label:"昵称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"actual_name",width:"110px","show-overflow-tooltip":"",align:"center",label:"用户名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"category_name",width:"110px",align:"center","show-overflow-tooltip":"",label:"类别",filters:t.typelistData,"filter-method":t.filterTag},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.category_name?a("span",[t._v(t._s(e.row.category_name))]):a("span",{},[t._v("暂无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"source_title",width:"120px",align:"center","show-overflow-tooltip":"",label:"文章名称"}}),t._v(" "),a("el-table-column",{attrs:{width:"200",align:"center","show-overflow-tooltip":"",label:"评论内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"commentContent",domProps:{innerHTML:t._s(e.row.content)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"review",width:"120px","show-overflow-tooltip":"",align:"center",label:"禁用类别",filters:t.tableforbiddenList,"filter-method":t.filterTag},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.review?a("span",[t._v(t._s(e.row.review))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",width:"160px",align:"center","show-overflow-tooltip":"",sortable:"",label:"评价时间"}}),t._v(" "),a("el-table-column",{attrs:{sortable:"",width:"120px","show-overflow-tooltip":"",align:"center",label:"通过状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(1===e.row.status?"已通过":2===e.row.status?"未审核":3===e.row.status?"未通过":4===e.row.status?"下架":"删除"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"operating",align:"center",fixed:"right","class-name":"contentOperating",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[3!==e.row.status?a("div",{staticClass:"notpass_color",on:{click:function(a){t.rejectButton(e.row.answer_id)}}},[t._v("禁用")]):t._e(),t._v(" "),1!==e.row.status?a("div",{staticClass:"delete_color",on:{click:function(a){t.deleteButton(e.row.answer_id)}}},[t._v("删除")]):t._e(),t._v(" "),a("div",{on:{click:function(a){t.previewButton(e.row.id)}}},[t._v("预览")]),t._v(" "),1!==e.row.status?a("div",{staticClass:"normal_color",on:{click:function(a){t.recoverButton(e.row.answer_id)}}},[t._v("恢复")]):t._e()]}}])})],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1),t._v(" "),a("div",{staticClass:"quantity_btm"},[t._v("数量："+t._s(t.total))])])])])]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.disableDialog},on:{"update:visible":function(e){t.disableDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("禁用\n    ")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("禁用类别：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.disableDialogRadio,callback:function(e){t.disableDialogRadio=e},expression:"disableDialogRadio"}},t._l(t.forbiddenList,function(e,i){return a("el-radio",{key:i,attrs:{label:e,border:""}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.disableDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmReject}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.recoverDialog},on:{"update:visible":function(e){t.recoverDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("恢复\n    ")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("p",[t._v("确定恢复吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.recoverDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmRecover}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"400px","custom-class":"previewDialog",visible:t.previewDialog},on:{"update:visible":function(e){t.previewDialog=e}}},[a("span",{staticClass:"previewDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-chakan"}),t._v("评论预览\n    ")]),t._v(" "),a("div",{staticClass:"previewDialog_box"},[a("div",{staticClass:"previewDialog_box_title"},[t._v("评论内容：")]),t._v(" "),a("div",{staticClass:"previewDialog_content",domProps:{innerHTML:t._s(t.previewContent)}})]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.previewDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.previewDialog=!1}}},[t._v("确 定")])],1)]),t._v(" "),a("delete-modal",{ref:"delete",on:{doDelete:t.confirmDelete}})],1)},staticRenderFns:[]};var c=a("VU/8")(l,r,!1,function(t){a("liRo")},null,null);e.default=c.exports},liRo:function(t,e){}});