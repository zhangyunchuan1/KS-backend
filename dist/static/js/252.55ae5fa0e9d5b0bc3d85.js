webpackJsonp([252],{"/fsY":function(t,e){},C2RN:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"MerchantConversation",components:{BreadCrumb:a("ZPfm").a},data:function(){return{breadData:[{id:1,name:"商家管理",urls:"/index/businessUser/BusinessUser",icon:"icon-home"},{id:2,name:"商家数据",urls:"/index/market/businessUser/merchantData/MerchantData",icon:"icon-home"},{id:3,name:"商家对话",urls:"/index/market/businessUser/merchantData/MerchantConversation",icon:"icon-home"}],searchTime:"",chatIDSearch:"",BusinessNickName:"",othersNickname:"",chatNumSearch:"dialog_num_low",tableData:[],chatDialog:!1,bussinessName:"",userName:"",chatData:[],currentPage:1,pageSize:25,total:0,dialogID:"",dialoguserID:"",starttime:"",endtime:"",currentdialogPage:1,pageSizedialog:10,totaldialog:0}},mounted:function(){this.gettablelistData()},methods:{gettablelistData:function(){var t=this,e={page_size:this.pageSize,page:this.currentPage,order_by:this.chatNumSearch,user_nickname:this.BusinessNickName,other_nickname:this.othersNickname,id:this.chatIDSearch,created_at:this.searchTime?this.searchTime[0]:"",updated_at:this.searchTime?this.searchTime[1]:"",user_status:"",other_type:""};this.HttpClient.post("/admin/shopdialog/history",e).then(function(e){console.log(e.data),200==e.data.code&&(t.tableData=e.data.data.data,t.total=e.data.data.total)})},filterHandlerloginstatus:function(t,e,a){return e[a.property]===t},timeSearchFn:function(){console.log(this.searchTime),this.gettablelistData()},lookChatFn:function(t){console.log(t),this.chatDialog=!0,this.dialogID=t.list_uid,this.dialoguserID=t.uid,this.bussinessName=t.user_nickname,this.userName=t.list_nickname,this.starttime=t.created_at,this.endtime=t.updated_at,this.getchatlist()},getchatlist:function(){var t=this,e={page_size:this.pageSizedialog,page:this.currentdialogPage,list_uid:this.dialogID,user_id:this.dialoguserID};this.HttpClient.post("/admin/dialog/info",e).then(function(e){console.log(e.data),200==e.data.code&&(t.chatData=e.data.data.data,t.totaldialog=e.data.data.total)})},currentChange:function(t){this.currentPage=t,this.getlistData()},currentdialogChange:function(t){this.currentdialogPage=t,this.getchatlist()}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"merchantConversation"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"merchantConversation_main"},[t._m(0),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content_header"},[a("div",{staticClass:"content_time"},[a("el-date-picker",{attrs:{type:"daterange",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.timeSearchFn},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}})],1),t._v(" "),a("div",{staticClass:"content_header_search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"对话ID搜索"},model:{value:t.chatIDSearch,callback:function(e){t.chatIDSearch=e},expression:"chatIDSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.gettablelistData},slot:"append"})],1),t._v(" "),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"商家昵称搜索"},model:{value:t.BusinessNickName,callback:function(e){t.BusinessNickName=e},expression:"BusinessNickName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.gettablelistData},slot:"append"})],1),t._v(" "),a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"对方昵称搜索"},model:{value:t.othersNickname,callback:function(e){t.othersNickname=e},expression:"othersNickname"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.gettablelistData},slot:"append"})],1)],1)]),t._v(" "),a("div",{staticClass:"content_table"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"对话ID",align:"center",width:"90",prop:"id",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"商家昵称",align:"center",width:"180","show-overflow-tooltip":"",prop:"user_nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"登录状态",align:"center",width:"120",prop:"user_status",filters:[{text:"正常",value:1},{text:"禁用",value:3}],"filter-method":t.filterHandlerloginstatus},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(1==e.row.user_status?"正常":3==e.row.user_status?"禁用":""))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"对方昵称",align:"center",width:"180",prop:"list_nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"事件名称",align:"center",width:"120",prop:"type"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(1==e.row.type?"活动":2==e.row.type?"服务":3==e.row.type?"商城":4==e.row.type?"他人":5==e.row.type?"淘货":6==e.row.type?"购物车":7==e.row.type?"关注":8==e.row.type?"客服":9==e.row.type?"视频":""))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"对话创建时间",align:"center",width:"200",prop:"created_at"}}),t._v(" "),a("el-table-column",{attrs:{label:"对话结束时间",align:"center",width:"200",prop:"updated_at"}}),t._v(" "),a("el-table-column",{attrs:{label:"对话次数",align:"center",width:"120",prop:"dialog_num",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"对话状态",align:"center",width:"120",prop:"dl_status"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(1==e.row.dl_status?"正常":"屏蔽"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"mallReview_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"scope_btm"},[a("el-button",{attrs:{size:"medium",type:"text"},on:{click:function(a){t.lookChatFn(e.row)}}},[t._v("查看对话")])],1)]}}])})],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)])]),t._v(" "),a("el-dialog",{attrs:{width:"500px","custom-class":"chatDialog",visible:t.chatDialog},on:{"update:visible":function(e){t.chatDialog=e}}},[a("span",{staticClass:"chatDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-xiaoxi"}),t._v("\n      "+t._s(t.bussinessName)+" 与 "+t._s(t.userName)+" 的对话\n    ")]),t._v(" "),a("div",{staticClass:"chatDialog_box"},[a("span",[t._v(t._s(t.starttime)+" - 开始对话")]),t._v(" "),t._l(t.chatData,function(e,s){return a("div",{key:s},[t.dialoguserID==e.send_id?a("div",{staticClass:"othersChat"},[a("p",[t._v(t._s(e.content))])]):t._e(),t._v(" "),t.dialogID==e.send_id?a("div",{staticClass:"ownChat"},[a("p",[t._v(t._s(e.content))])]):t._e()])}),t._v(" "),a("span",[t._v(t._s(t.endtime)+" - 结束对话")])],2),t._v(" "),t.totaldialog?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.totaldialog,"page-size":t.pageSize},on:{"current-change":t.currentdialogChange}}):t._e()],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("商家对话")])])}]};var n=a("VU/8")(s,i,!1,function(t){a("/fsY")},null,null);e.default=n.exports}});