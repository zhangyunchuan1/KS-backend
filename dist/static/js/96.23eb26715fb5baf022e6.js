webpackJsonp([96],{bekn:function(e,t){},lNAJ:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={name:"InsideUserJurisdiction",components:{BreadCrumb:s("ZPfm").a},data:function(){return{sureVisible:!1,deleteVisible:!1,user_info:null,user_name:"",status:1,checkedHasRole:[],breadData:[{id:1,name:"内部管理",urls:"/index",icon:"icon-home"},{id:2,name:"用户管理",urls:"/index/test",icon:"icon-home"},{id:3,name:"用户角色权限分配",urls:"/index/test",icon:"icon-home"}],old_array:[],allRole:[],hasRole:[],newAllRole:[],roleId:null}},created:function(){this.getData()},methods:{deleteDistribution:function(){var e=this;this.HttpClient.post("/admin/roleuser/destroy",{user_id:this.select_userID,role_id:this.roleId}).then(function(t){if(console.log(t),200===t.data.code){for(var s in e.$message.success(t.data.msg),e.deleteVisible=!1,e.hasRole)e.hasRole[s].id===e.roleId&&e.hasRole.splice(s,1);for(var l in e.checkedHasRole)e.checkedHasRole[l]===e.roleId&&e.checkedHasRole.splice(l,1)}else{for(var i=0;i<e.hasRole.length;i++)e.checkedHasRole.push(e.hasRole[i].id);e.$message.error(t.data.msg)}})},handleCancelDelete:function(){this.deleteVisible=!1,this.checkedHasRole.push(this.roleId)},sureDistribution:function(){var e=this;this.HttpClient.post("/admin/roleuser/create",{user_id:this.select_userID,role_id:this.roleId}).then(function(t){if(console.log(t),200===t.data.code){e.$message.success(t.data.msg),e.sureVisible=!1;for(var s=0;s<e.allRole.length;s++)e.allRole[s].id===e.roleId&&(console.log(e.allRole[s]),e.hasRole.push(e.allRole[s]),e.checkedHasRole.push(e.allRole[s]))}else e.$message.error(t.data.msg)})},handleCancelAdd:function(){for(var e in this.sureVisible=!1,console.log(this.checkedHasRole),this.checkedHasRole)this.checkedHasRole[e]===this.roleId&&this.checkedHasRole.splice(e,1)},changeAllCheck:function(e,t){if(console.log(e,t,this.hasRole),this.roleId=t,!1===e)for(var s=0;s<this.hasRole.length;s++)this.checkedHasRole.push(this.hasRole[s].id);else this.sureVisible=!0},changeHasCheck:function(e,t){console.log(e,t,this.hasRole),this.deleteVisible=!0,this.roleId=t},getRoleList:function(){var e=this;this.HttpClient.post("/admin/role/getAll",{}).then(function(t){console.log(t);for(var s=0;s<t.data.data.length;s++)e.newAllRole.push({id:t.data.data[s].id,name:t.data.data[s].name});console.log(e.newAllRole),e.allRole=e.newAllRole})},handleStatus:function(){var e=this;1===this.user_info.status?this.HttpClient.post("/admin/employee/status",{uid:this.user_info.uid,status:2}).then(function(t){console.log(t),200===t.status&&(e.user_info.status=2)}):2===this.user_info.status&&this.HttpClient.post("/admin/employee/status",{uid:this.user_info.uid,status:1}).then(function(t){console.log(t),200===t.status&&(e.user_info.status=1)}),console.log(this.user_info.status)},handleCheckAllChange:function(){},handleCheckedRoleChange:function(e){console.log(e)},getData:function(){this.user_info=this.$route.query.info,console.log(this.user_info),this.select_userID=this.user_info.id,this.hasRole=this.user_info.roles,this.getRoleList();for(var e=0;e<this.hasRole.length;e++)this.checkedHasRole.push(this.hasRole[e].id);console.log(this.checkedHasRole)}}},i={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"insideUserJurisdiction"},[l("BreadCrumb",{staticClass:"bread",attrs:{breadData:e.breadData}}),e._v(" "),l("div",{staticClass:"content"},[l("p",{staticClass:"title"},[e._v("用户角色分配")]),e._v(" "),l("div",{staticClass:"conditions"},[l("div",{staticClass:"condition"},[l("p",{staticClass:"user_name"},[e._v("姓名: "),l("span",[e._v(e._s(e.user_info.nickname))])]),e._v(" "),l("p",{staticClass:"user_status"},[e._v("状态:")]),e._v(" "),l("p",{staticClass:"user_enable",style:2===e.user_info.status?{background:"#ff5858"}:{},on:{click:e.handleStatus}},[e._v(e._s(1===e.user_info.status?"启用":"禁用"))])])]),e._v(" "),l("div",{staticClass:"user_edit_content"},[l("div",{staticClass:"content_left"},[l("p",{staticClass:"left_title"},[e._v("所有角色")]),e._v(" "),l("div",{staticClass:"all_role"},[l("el-checkbox-group",{staticClass:"checkbox_all",model:{value:e.checkedHasRole,callback:function(t){e.checkedHasRole=t},expression:"checkedHasRole"}},e._l(e.allRole,function(t){return l("el-checkbox",{key:t.id,staticClass:"checkbox_all_item",attrs:{label:t.id},on:{change:function(s){e.changeAllCheck(s,t.id)}}},[e._v(e._s(t.name))])}))],1)]),e._v(" "),l("div",{staticClass:"content_right"},[l("p",{staticClass:"right_title"},[e._v("已拥有角色")]),e._v(" "),l("div",{staticClass:"has_role"},[l("el-checkbox-group",{staticClass:"checkbox_all",model:{value:e.checkedHasRole,callback:function(t){e.checkedHasRole=t},expression:"checkedHasRole"}},e._l(e.hasRole,function(t){return l("el-checkbox",{key:t.id,staticClass:"checkbox_all_item",attrs:{label:t.id},on:{change:function(s){e.changeHasCheck(s,t.id)}}},[e._v(e._s(t.name))])}))],1)])]),e._v(" "),l("div",{staticClass:"btn_group"},[l("el-button",{attrs:{size:"mini"}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("确定")])],1)]),e._v(" "),l("el-dialog",{attrs:{visible:e.sureVisible,width:"300px"},on:{"update:visible":function(t){e.sureVisible=t}}},[l("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[l("i",{staticClass:"iconfont icon-trash delete_icon"}),e._v(" "),l("span",[e._v("删除")])]),e._v(" "),l("div",{staticClass:"delete_content"},[l("img",{staticClass:"boolean_delete",attrs:{src:s("GvV1")}}),e._v(" "),l("p",[e._v("确定分配该角色给此用户吗？")])]),e._v(" "),l("div",{staticClass:"user_footer",attrs:{slot:"footer"},slot:"footer"},[l("el-row",{staticClass:"row_e"},[l("el-button",{staticClass:"btn_deletes",attrs:{size:"small"},on:{click:e.handleCancelAdd}},[e._v("取 消")]),e._v(" "),l("el-button",{staticClass:"btn_delete",attrs:{type:"primary",size:"small"},on:{click:function(t){e.sureDistribution()}}},[e._v("确 定")])],1)],1)]),e._v(" "),l("el-dialog",{attrs:{visible:e.deleteVisible,width:"300px"},on:{"update:visible":function(t){e.deleteVisible=t}}},[l("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[l("i",{staticClass:"iconfont icon-trash delete_icon"}),e._v(" "),l("span",[e._v("删除")])]),e._v(" "),l("div",{staticClass:"delete_content"},[l("img",{staticClass:"boolean_delete",attrs:{src:s("GvV1")}}),e._v(" "),l("p",[e._v("确定移除该用户的此角色吗？")])]),e._v(" "),l("div",{staticClass:"user_footer",attrs:{slot:"footer"},slot:"footer"},[l("el-row",{staticClass:"row_e"},[l("el-button",{staticClass:"btn_deletes",attrs:{size:"small"},on:{click:e.handleCancelDelete}},[e._v("取 消")]),e._v(" "),l("el-button",{staticClass:"btn_delete",attrs:{type:"primary",size:"small"},on:{click:function(t){e.deleteDistribution()}}},[e._v("确 定")])],1)],1)])],1)},staticRenderFns:[]};var a=s("VU/8")(l,i,!1,function(e){s("bekn")},"data-v-7ebfbdac",null);t.default=a.exports}});