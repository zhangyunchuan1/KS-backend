webpackJsonp([186],{"/VTg":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("ZPfm"),s=o("+jNi"),l={name:"ShoppingCart",components:{BreadCrumb:a.a,DeleteModal:s.a},data:function(){return{breadData:[{id:1,name:"购物统计",urls:"/index/mall/shoppingStatistics/shopping-statistics",icon:"icon-home"},{id:2,name:"购物车",urls:"/index/mall/shoppingStatistics/shopping-cart",icon:"icon-home"}],currentPage:1,pageSize:20,total:0,productCurrentPage:1,totalProduct:0,tableData:[],userName:"",centerDialogVisible:!1,buyerContent:{},productDialog:!1,sourceName:"",productList:[],userId:"",cartId:"",isClear:!1}},mounted:function(){this.getShoppingCart()},methods:{remarkButton:function(t){var e=this;this.HttpClient.get("/admin/marketShoppingCart/getUserRemark",{source_id:t.cart_id}).then(function(t){200==t.data.code?(e.centerDialogVisible=!0,e.buyerContent=t.data.data):e.$message.warning(t.data.msg)})},getShoppingCart:function(){var t=this,e={page:this.currentPage,size:this.pageSize};this.userName&&(e.user_name=this.userName),this.HttpClient.post("/admin/marketShoppingCart/index",e).then(function(e){console.log(e),200===e.data.code&&(t.tableData=e.data.data.data,t.total=e.data.data.total)})},getProductList:function(t){var e=this,o={page:this.productCurrentPage,size:this.pageSize,uid:t};this.HttpClient.post("/admin/marketShoppingCart/productList",o).then(function(t){console.log(t),200===t.data.code&&(e.productList=t.data.data.data,e.totalProduct=t.data.data.total)})},showProduct:function(t,e){this.productDialog=!0,this.sourceName=e,this.userId=t,this.getProductList(t)},deleteProductByCart:function(t){var e=this,o=t.uid,a=t.cartId,s={uid:o};a&&(s.cart_id=a),this.HttpClient.delete("/admin/marketShoppingCart",s).then(function(t){200===t.data.code?(e.$message.success(t.data.msg),setTimeout(function(){e.getProductList(e.userId),e.getShoppingCart()})):e.$message.error(t.data.msg)})},deleteButton:function(t,e){this.userId=t,this.cartId=e,this.isClear=!1,this.$refs.delete.deleteDialog=!0},clearCart:function(){this.isClear=!0,this.$refs.delete.deleteDialog=!0},confirmDelete:function(t){t&&(this.isClear?this.deleteProductByCart({uid:this.userId}):this.deleteProductByCart({uid:this.userId,cartId:this.cartId}))},currentChange:function(t){this.currentPage=t,this.getShoppingCart()},ProductCurrentChange:function(t){this.productCurrentPage=t,this.getProductList(this.userId)}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"Sales"},[o("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),o("div",{staticClass:"encyclopedia_main"},[t._m(0),t._v(" "),o("div",{staticClass:"encyclopedia_table"},[o("div",{staticClass:"encyclopedia_search"},[o("div",[o("el-input",{staticClass:"input-with-select",attrs:{placeholder:"账号搜索",clearable:""},on:{clear:t.getShoppingCart},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getShoppingCart(e):null}},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getShoppingCart},slot:"append"})],1)],1)]),t._v(" "),o("div",{staticClass:"encyclopedia_content",staticStyle:{width:"80%"}},[o("el-table",{attrs:{data:t.tableData,border:!0}},[o("el-table-column",{attrs:{label:"用户ID",align:"center",width:"100",prop:"id",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.id||"无"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"用户账号",align:"center",width:"180",prop:"nickname","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.nickname||"无"))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"全部商品",align:"center",width:"580","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[0!==e.row.product.length?o("div",{staticClass:"product_list"},t._l(e.row.product.slice(0,6),function(e,a){return o("div",{key:a,staticClass:"product_list_item"},[t._v(t._s(e.title.slice(0,6)))])})):o("div",{staticClass:"product_list sortout_color"},[t._v("\n                暂无商品\n              ")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"商品个数",align:"center",width:"110","show-overflow-tooltip":"",sortable:"",prop:"product_count"}}),t._v(" "),o("el-table-column",{attrs:{label:"购买总数",align:"center",width:"110","show-overflow-tooltip":"",sortable:"",prop:"product_total"}}),t._v(" "),o("el-table-column",{attrs:{label:"总计价格",align:"center",width:"110","show-overflow-tooltip":"",prop:"product_price",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","class-name":"encyclopedia_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"encyclopedia_btm"},[o("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(o){t.showProduct(e.row.uid,e.row.nickname)}}},[t._v("商品列表")])],1)]}}])})],1),t._v(" "),t.total?o("div",{staticClass:"paging"},[o("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.currentChange}})],1):t._e()],1)])]),t._v(" "),o("el-dialog",{attrs:{visible:t.productDialog,width:"1000px","custom-class":"product_dialog"},on:{"update:visible":function(e){t.productDialog=e}}},[o("span",{staticClass:"product_dialog_title",attrs:{slot:"title"},slot:"title"},[o("span",{staticClass:"title_item"},[o("i",{staticClass:"iconfont icon-orderedlist"}),t._v("商品列表\n      ")]),t._v(" "),o("span",{staticClass:"title_item_name"},[o("span",{staticClass:"title_name"},[t._v("用户账号 :")]),t._v(" "),o("span",{staticClass:"title_name_content"},[t._v(t._s(t.sourceName))])])]),t._v(" "),o("div",{staticClass:"product_dialog_main"},[o("el-table",{attrs:{data:t.productList,border:!0}},[o("el-table-column",{attrs:{label:"商品图片",align:"center",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.show_picture&&e.row.show_picture.length>0?o("img",{attrs:{src:t.Tools.handleImg(e.row.show_picture[0].path)+"?imageView2/1/w/50/h/50",alt:""}}):o("span",{staticClass:"sortout_color"},[t._v("暂无图片")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"商品名称",align:"center",width:"100","show-overflow-tooltip":"",prop:"title"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.title?o("span",[t._v(t._s(e.row.title))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"卖家昵称",align:"center",width:"100","show-overflow-tooltip":"",prop:"nickname"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.nickname?o("span",[t._v(t._s(e.row.nickname))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"来源",align:"center",width:"60","show-overflow-tooltip":"",prop:"source"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.source?o("span",[t._v(t._s(e.row.source))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"商城",align:"center",width:"60","show-overflow-tooltip":"",prop:"folder_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.folder_name?o("span",[t._v(t._s(e.row.folder_name))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"一级目录",align:"center",width:"100","show-overflow-tooltip":"",prop:"menu_1_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.menu_1_name?o("span",[t._v(t._s(e.row.menu_1_name))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"二级目录",align:"center",width:"100","show-overflow-tooltip":"",prop:"menu_2_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.menu_2_name?o("span",[t._v(t._s(e.row.menu_2_name))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"三级目录",align:"center",width:"100","show-overflow-tooltip":"",prop:"menu_3_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.menu_3_name?o("span",[t._v(t._s(e.row.menu_3_name))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"单价",align:"center",width:"80","show-overflow-tooltip":"",sortable:"",prop:"price"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.price?o("span",[t._v(t._s(e.row.price))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"库存",align:"center",width:"80","show-overflow-tooltip":"",prop:"stock",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.stock?o("span",[t._v(t._s(e.row.stock))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"购买数量",align:"center",width:"120","show-overflow-tooltip":"",prop:"quantity",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.quantity?o("span",[t._v(t._s(e.row.quantity))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"小计",align:"center",width:"100","show-overflow-tooltip":"",prop:"total_price",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.total_price?o("span",[t._v(t._s(e.row.total_price))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"添加时间",align:"center",width:"160","show-overflow-tooltip":"",prop:"created_at",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.created_at?o("span",[t._v(t._s(e.row.created_at))]):o("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","min-width":"160","class-name":"encyclopedia_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"encyclopedia_btm"},[o("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(o){t.deleteButton(e.row.uid,e.row.cart_id)}}},[t._v("删除")]),t._v(" "),o("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(o){t.remarkButton(e.row)}}},[t._v("买家备注")])],1)]}}])})],1),t._v(" "),t.totalProduct?o("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,total:t.totalProduct},on:{"current-change":t.ProductCurrentChange}}):t._e()],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.clearCart}},[t._v("清空购物车")]),t._v(" "),o("el-button",{on:{click:function(e){t.productDialog=!1}}},[t._v("关 闭")])],1)]),t._v(" "),o("delete-modal",{ref:"delete",on:{doDelete:t.confirmDelete}}),t._v(" "),o("el-dialog",{attrs:{title:"买家备注",visible:t.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[o("span",{staticClass:"deleteDialog_title",attrs:{slot:"title"},slot:"title"},[o("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),o("span",[t._v(t._s(t.buyerContent.content))]),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("关闭")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"encyclopedia_title"},[e("div",{staticClass:"title"},[this._v("购物车")])])}]};var r=o("VU/8")(l,n,!1,function(t){o("G4WL")},null,null);e.default=r.exports},G4WL:function(t,e){}});