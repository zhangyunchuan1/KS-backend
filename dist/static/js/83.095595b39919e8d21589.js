webpackJsonp([83],{Ogwf:function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e={name:"ToppingActivity",components:{BreadCrumb:i("ZPfm").a},data:function(){return{breadData:[{id:1,name:"活动",urls:"/index/activity/Activity",icon:"icon-home"},{id:2,name:"置顶活动",urls:"/index/activity/ToppingActivity",icon:"icon-home"}],idSearch:"",tableData:[],shelf:!0,modifyImages:!0,shelfDialog:!1,obtainedDialog:!1,searchDialog:!1,infoData:{},imageUrl:"",currentObj:{},imgPath:"",total:null,curentPage:1}},mounted:function(){this.getActivityList()},methods:{handleAddActivity:function(){var t=this;this.HttpClient.post("/admin/actives/setTop",{active_id:this.infoData.active_id}).then(function(a){console.log(a),200===a.data.code?(t.$message.success(a.data.msg),setTimeout(function(){t.getActivityList(),t.searchDialog=!1},500)):t.$message.error(a.data.msg)})},getActivityList:function(){var t=this;this.HttpClient.post("/admin/actives/topLists",{page:this.curentPage}).then(function(a){console.log(a),t.tableData=a.data.data.data,t.total=a.data.data.total})},currentChange:function(t){this.curentPage=t,this.getActivityList()},handleIDSearch:function(){var t=this;this.searchDialog=!0,this.HttpClient.post("/admin/actives/getActiveInfo",{id:this.idSearch}).then(function(a){console.log(a),t.infoData=a.data.data})},handleLowerShelf:function(t){this.currentObj=t,this.obtainedDialog=!0},obtainedDialogBtm:function(){var t=this;this.HttpClient.post("/admin/actives/changeStatus",{active_id:this.currentObj.active_id,status:1}).then(function(a){200===a.data.code&&(t.$message.success(a.data.msg),setTimeout(function(){t.getActivityList(),t.obtainedDialog=!1},500))})},handleRoofPlacement:function(t){new Date(t.registration_deadline).valueOf()>(new Date).valueOf()?(this.imgPath="",console.log(t),this.currentObj=t,this.shelfDialog=!0):this.$message.warning("报名已截止，无法置顶！")},shelfDialogBtm:function(){var t=this;this.imgPath&&this.HttpClient.post("/admin/actives/changeStatus",{active_id:this.currentObj.active_id,status:10,image_path:this.imgPath}).then(function(a){console.log(a),200===a.data.code&&(t.$message.success(a.data.msg),setTimeout(function(){t.getActivityList(),t.shelfDialog=!1},500))})},handleAvatarSuccess:function(t,a){this.imageUrl=URL.createObjectURL(a.raw)},beforeAvatarUpload:function(t){var a=this;console.log(t),t.size/1024/1024<5?(console.log(t),this.HttpClient.form("/admin/uploadOneImage",{images:t}).then(function(t){console.log(t),200===t.data.code&&(a.$message.success(t.data.msg),a.imgPath=t.data.path)})):this.$message.error("上传图片大小不能超过 2MB!")}}},s={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"toppingActivity"},[i("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),i("div",{staticClass:"toppingActivity_main"},[t._m(0),t._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"content_header"},[i("div",{staticClass:"content_header_search"},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"输入活动ID进行查找添加",clearable:""},on:{change:t.handleIDSearch},model:{value:t.idSearch,callback:function(a){t.idSearch=a},expression:"idSearch"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleIDSearch},slot:"append"})],1)],1)]),t._v(" "),i("div",{staticClass:"content_table"},[i("el-table",{attrs:{data:t.tableData,border:!0}},[i("el-table-column",{attrs:{label:"活动ID",align:"center",width:"90",prop:"id",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{label:"活动名称",align:"center",width:"220","show-overflow-tooltip":"",prop:"title"}}),t._v(" "),i("el-table-column",{attrs:{label:"城市",align:"center",width:"120","show-overflow-tooltip":"",prop:"city_name"}}),t._v(" "),i("el-table-column",{attrs:{label:"报名截止时间",align:"center","show-overflow-tooltip":"",width:"160",prop:"registration_deadline",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{label:"开始时间",align:"center","show-overflow-tooltip":"",width:"160",prop:"active_date_start",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{label:"截止时间",align:"center","show-overflow-tooltip":"",width:"160",prop:"active_date_end",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{label:"售出票数",align:"center","show-overflow-tooltip":"",width:"110",prop:"sale_num",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{label:"关注人数(浏览次数)",align:"center","show-overflow-tooltip":"",width:"100",prop:"view_num",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{label:"状态",align:"center","show-overflow-tooltip":"",width:"110",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(a){return[10!==a.row.status?i("span",{staticClass:"sortout_color"},[t._v("已下架")]):t._e(),t._v(" "),10===a.row.status?i("span",{staticClass:"normal_color"},[t._v("已置顶")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[10===a.row.status?i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(i){t.handleLowerShelf(a.row)}}},[t._v("下架")]):t._e(),t._v(" "),10!==a.row.status?i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(i){t.handleRoofPlacement(a.row)}}},[t._v("置顶")]):t._e(),t._v(" "),10===a.row.status?i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(i){t.handleRoofPlacement(a.row)}}},[t._v("修改图片")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"}},[t._v("售票情况")])]}}])})],1),t._v(" "),i("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":25},on:{"current-change":t.currentChange}})],1)])]),t._v(" "),i("el-dialog",{attrs:{width:"650px","custom-class":"infoDataDialog",visible:t.searchDialog},on:{"update:visible":function(a){t.searchDialog=a}}},[i("span",{staticClass:"obtainedDialog_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-xiajia"}),t._v("查找结果")]),t._v(" "),i("div",{staticClass:"info_content"},[i("div",{staticClass:"line"},[i("span",[t._v("活动名称：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.title))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("城市：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.city_name))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("区县：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.province_name))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("详细地址：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.address))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("联系人：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.contacts))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("联系电话：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.telphone))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("商家昵称：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.nickname))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("商家全称：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.company_name))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("开始时间：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.active_date_end))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("截止时间：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.active_date_start))])]),t._v(" "),i("div",{staticClass:"line"},[i("span",[t._v("报名截止时间：")]),t._v(" "),i("div",[t._v(t._s(t.infoData.registration_deadline))])])]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(a){t.searchDialog=!1}}},[t._v("关 闭")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleAddActivity}},[t._v("添 加")])],1)]),t._v(" "),i("el-dialog",{attrs:{width:"350px","custom-class":"obtainedDialog",visible:t.obtainedDialog},on:{"update:visible":function(a){t.obtainedDialog=a}}},[i("span",{staticClass:"obtainedDialog_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-xiajia"}),t._v("下 架")]),t._v(" "),i("div",{staticClass:"obtainedDialog_box"},[i("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),i("p",[t._v("是否确认下架？")])]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(a){t.obtainedDialog=!1}}},[t._v("关 闭")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.obtainedDialogBtm}},[t._v("确 认")])],1)]),t._v(" "),i("el-dialog",{attrs:{width:"700px","custom-class":"shelfDialog",visible:t.shelfDialog},on:{"update:visible":function(a){t.shelfDialog=a}}},[i("span",{staticClass:"shelfDialog_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-xiajia"}),t._v("置 顶")]),t._v(" "),i("div",{staticClass:"shelfDialog_box"},[i("el-upload",{staticClass:"images-uploader",attrs:{action:"http://test.kslab.com/api/article/null","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?i("img",{staticClass:"images",attrs:{src:t.imageUrl}}):i("i",{staticClass:"el-icon-plus images-uploader-icon"})])],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(a){t.shelfDialog=!1}}},[t._v("关 闭")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.shelfDialogBtm}},[t._v("确 认")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"title"},[a("p",[this._v("置顶活动")])])}]};var o=i("VU/8")(e,s,!1,function(t){i("UgKK")},null,null);a.default=o.exports},UgKK:function(t,a){}});