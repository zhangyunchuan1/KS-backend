webpackJsonp([168],{c0TB:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),n=a.n(i),l=a("exGp"),o=a.n(l),s=a("ZPfm"),r=(a("QL8K"),a("PJh5")),c=a.n(r),d=new(a("GKmE").a),u={name:"LiveSharing",components:{BreadCrumb:s.a},data:function(){return{breadData:[{id:1,name:"文章",urls:"/index/article/encyclopedia",icon:"icon-home"},{id:2,name:"优文分享",urls:"/index/article/liveSharing",icon:"icon-home"}],pageSize:25,total:0,currentPage:1,dialogImageUrl:"",dialogVisible:!1,tableData:[],searchObj:{},liveSharingBtm:!0,obtainedBtm:!1,obtainedDialog:!1,onlineDialog:!1,addLiveDialog:!1,imageUrl:"",addLiveTile:"",addLiveLink:"",addLiveMediaName:"",addLiveArtcleTime:"",images:[],modifyObj:{}}},created:function(){this.getTableList(null)},methods:{getTableList:function(e){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={page:t.currentPage,size:25,type:1},e.next=4,t.HttpClient.post("/admin/article/getRecommendList",a);case 4:i=e.sent,t.tableData=v(i.data.data.data),t.total=i.data.data.total,console.log(i);case 8:case"end":return e.stop()}},e,t)}))()},currentChange:function(e){var t=this;return o()(n.a.mark(function a(){return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.currentPage=e,t.search();case 2:case"end":return a.stop()}},a,t)}))()},release:function(){var e=this;return o()(n.a.mark(function t(){var a,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=void 0,e.images&&e.images.length>0&&(a=e.images[0].url),t.next=4,e.HttpClient.post("/admin/article/addRecommend",{icon:a,title:e.addLiveTile,url:e.addLiveLink,type:1,created_name:e.addLiveMediaName,record_time:c()(e.addLiveArtcleTime).format("YYYY-MM-DD HH:mm:ss")});case 4:i=t.sent,d.getApiMessage(i),"200"==i.data.code&&(e.addLiveDialog=!1),e.search();case 8:case"end":return t.stop()}},t,e)}))()},openShareModal:function(e){this.onlineDialog=!0,this.modifyObj=e},closeShareModal:function(e){this.obtainedDialog=!0,this.modifyObj=e},search:function(){this.getTableList(this.searchObj)},filterSecondary:function(e,t,a){return t[a.property]===e},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},uploadFile:function(e){var t=this;return o()(n.a.mark(function a(){var i;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(console.log(t.images),t.images=[],!(t.images.length>0)){a.next=4;break}return a.abrupt("return",t.$message.warning("只能上传一张图片"));case 4:return a.next=6,t.HttpClient.form("/admin/uploadOneImage",{images:e});case 6:i=a.sent,d.getApiMessage(i),t.images.push({name:e.name,url:i.data.path}),console.log(t.images);case 10:case"end":return a.stop()}},a,t)}))()},handleRemove:function(e,t){console.log(e,t)},addModal:function(){this.addLiveDialog=!0,this.images=[],console.log(this.images)},liveSharingClone:function(){var e=this;return o()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.HttpClient.post("/admin/article/changeRecommendStatus",{id:e.modifyObj.id,status:2});case 2:a=t.sent,d.getApiMessage(a),"200"==a.data.code&&(e.obtainedDialog=!1),e.search();case 6:case"end":return t.stop()}},t,e)}))()},liveSharingBtmClone:function(){this.onlineDialog=!0},liveSharingOpen:function(){var e=this;return o()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.HttpClient.post("/admin/article/changeRecommendStatus",{id:e.modifyObj.id,status:1});case 2:a=t.sent,d.getApiMessage(a),"200"==a.data.code&&(e.onlineDialog=!1),e.search();case 6:case"end":return t.stop()}},t,e)}))()}}};function v(e){if(e&&e.length>0)for(var t in e)"1"==e[t].status?e[t].state="上线":"2"==e[t].status&&(e[t].state="下架");return e}var p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"liveSharing"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:e.breadData}}),e._v(" "),a("div",{staticClass:"liveSharing_main"},[e._m(0),e._v(" "),a("div",{staticClass:"liveSharing_content"},[a("div",{staticClass:"survey_header"},[a("el-button",{staticClass:"survey_add",on:{click:e.addModal}},[e._v("添加")])],1),e._v(" "),a("div",{staticClass:"liveSharing_content_box"},[a("el-table",{attrs:{data:e.tableData,border:!0}},[a("el-table-column",{attrs:{label:"图片","class-name":"images",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.icon}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"标题",align:"center","show-overflow-tooltip":"",width:"240",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"网站链接",align:"center","show-overflow-tooltip":"",width:"260",prop:"url"}}),e._v(" "),a("el-table-column",{attrs:{label:"媒体名称",align:"center","show-overflow-tooltip":"",width:"200",prop:"created_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"文章撰写时间",align:"center","show-overflow-tooltip":"",width:"200",prop:"updated_at",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间","show-overflow-tooltip":"",align:"center",width:"160",prop:"created_at",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"点击次数",align:"center",width:"120","show-overflow-tooltip":"",prop:"view_num",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.view_num?a("span",[e._v(e._s(t.row.view_num))]):a("span",{staticClass:"sortout_color"},[e._v("0")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center","show-overflow-tooltip":"",filters:[{text:"上线",value:"上线"},{text:"下架",value:"下架"}],"filter-method":e.filterSecondary,width:"120",prop:"state"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.state?a("span",[e._v(e._s(t.row.state))]):a("span",{staticClass:"sortout_color"},[e._v("无")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","class-name":"liveSharing_scope"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"liveSharing_btm"},["下架"==t.row.state?a("el-button",{attrs:{size:"medium",type:"text"},on:{click:function(a){e.openShareModal(t.row)}}},[e._v("上线")]):e._e(),e._v(" "),"上线"==t.row.state?a("el-button",{attrs:{size:"medium",type:"text"},on:{click:function(a){e.closeShareModal(t.row)}}},[e._v("下架")]):e._e()],1)]}}])})],1),e._v(" "),e.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total,"page-size":e.pageSize},on:{"current-change":e.currentChange}}):e._e()],1)])]),e._v(" "),a("el-dialog",{attrs:{visible:e.addLiveDialog,width:"470px","custom-class":"addLineDialog"},on:{"update:visible":function(t){e.addLiveDialog=t}}},[a("span",{staticClass:"addLineDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-plus-circle"}),e._v("添加优文分享")]),e._v(" "),a("div",{staticClass:"addLineDialog_main"},[a("el-upload",{staticClass:"up_img_item",attrs:{action:"","list-type":"picture-card","file-list":e.images,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"before-upload":e.uploadFile,multiple:""}},[a("i",{staticClass:"el-icon-plus icon_plus"})]),e._v(" "),a("div",{staticClass:"addLineInput"},[a("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.addLiveTile,callback:function(t){e.addLiveTile=t},expression:"addLiveTile"}}),e._v(" "),a("el-input",{attrs:{placeholder:"请输入网站链接"},model:{value:e.addLiveLink,callback:function(t){e.addLiveLink=t},expression:"addLiveLink"}}),e._v(" "),a("el-input",{attrs:{placeholder:"请输入媒体名称"},model:{value:e.addLiveMediaName,callback:function(t){e.addLiveMediaName=t},expression:"addLiveMediaName"}}),e._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"选择文章时间"},model:{value:e.addLiveArtcleTime,callback:function(t){e.addLiveArtcleTime=t},expression:"addLiveArtcleTime"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addLiveDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.release}},[e._v("发 布")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.obtainedDialog,width:"470px","custom-class":"obtainedDialog"},on:{"update:visible":function(t){e.obtainedDialog=t}}},[a("span",{staticClass:"obtainedDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),e._v(" "),a("div",{staticClass:"obtainedDialog_main"},[a("i",{staticClass:"iconfont icon-warning-circle"}),e._v(" "),a("div",{staticClass:"obtainedDialog_text"},[e._v("确认下架吗？")])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.obtainedDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.liveSharingClone}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.onlineDialog,width:"470px","custom-class":"onlineDialog"},on:{"update:visible":function(t){e.onlineDialog=t}}},[a("span",{staticClass:"onlineDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),e._v(" "),a("div",{staticClass:"onlineDialog_main"},[a("i",{staticClass:"iconfont icon-warning-circle"}),e._v(" "),a("div",{staticClass:"onlineDialog_text"},[e._v("确认上线吗？")])]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onlineDialog}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.liveSharingOpen}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title"},[t("p",[this._v("优文分享")])])}]};var g=a("VU/8")(u,p,!1,function(e){a("iaVQ")},null,null);t.default=g.exports},iaVQ:function(e,t){}});