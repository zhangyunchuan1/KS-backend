webpackJsonp([23],{E13j:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("ZPfm"),a=i("+jNi"),n={name:"InsideDepartment",components:{BreadCrumb:s.a,DeleteModal:a.a},data:function(){return{editVisible:!1,prohibitDialog:!1,enableDialog:!1,breadData:[{id:1,name:"内部管理",urls:"/index",icon:"icon-home"},{id:2,name:"部门管理",urls:"/index/test",icon:"icon-home"}],tableData:[],jobs:[],job:"",id:"",industryTitle:"",industryContent:"",isUpdate:!1,inputValue:null}},mounted:function(){},methods:{handleClose:function(t){this.jobs.splice(this.jobs.indexOf(t),1)},handleInputConfirm:function(){var t=this.inputValue;t&&this.jobs.push(t),this.inputValue=""},handleOpenProhibit:function(t){this.prohibitDialog=!0,this.id=t},handleProhibit:function(){var t=this;this.HttpClient.post("/admin/department/changeStatus",{id:this.id,status:0}).then(function(e){console.log(e),200===e.data.code&&(t.$message.success(e.data.msg),setTimeout(function(){t.getDepartment(),t.prohibitDialog=!1},500))})},handleOpenEnable:function(t){this.enableDialog=!0,this.id=t},handleEnable:function(){var t=this;this.HttpClient.post("/admin/department/changeStatus",{id:this.id,status:1}).then(function(e){console.log(e),200===e.data.code&&(t.$message.success(e.data.msg),setTimeout(function(){t.getDepartment(),t.enableDialog=!1},500))})},handleAddJob:function(){console.log(this.job)},addNewDepartment:function(){this.editVisible=!0,this.isUpdate=!1},addDepartment:function(){var t=this;this.industryTitle&&this.industryContent&&(this.isUpdate?this.HttpClient.post("/admin/department/edit",{id:this.id,name:this.industryTitle,description:this.industryContent,position_arr:this.jobs}).then(function(e){console.log(e),200===e.data.code?(t.editVisible=!1,t.$message.success(e.data.msg),t.industryTitle="",t.industryContent="",setTimeout(function(){t.getDepartment()},500)):t.$message.error(e.data.msg)}):(console.log(this.jobs),this.HttpClient.post("/admin/department/create",{name:this.industryTitle,description:this.industryContent,position_arr:this.jobs}).then(function(e){console.log(e);var i=e.data,s=i.code,a=i.msg;i.data;200===s?(t.editVisible=!1,t.$message.success(a),t.industryTitle="",t.industryContent="",setTimeout(function(){t.getDepartment()},500)):1204===s?t.$message.error(a):t.$message.error("插入失败，请重试！")})))},updateDepartment:function(t){var e=this;this.isUpdate=!0,this.id=t,this.HttpClient.get("/admin/department/edit",{id:t}).then(function(t){console.log(t);var i=t.data,s=i.code,a=i.data;200===s&&(e.industryTitle=a.name,e.industryContent=a.description,e.jobs=a.position_arr,e.editVisible=!0)})},deleteDepartment:function(t){this.id=t,this.$refs.delete.deleteDialog=!0},deleteConfirm:function(t){var e=this;t&&this.HttpClient.post("/admin/department/destroy",{id:this.id}).then(function(t){console.log(t),200===t.data.code?(e.$message.success(t.data.msg),setTimeout(function(){e.getDepartment()},500)):e.$message.error(t.data.msg)})},getDepartment:function(){var t=this;this.HttpClient.post("/admin/department/getList").then(function(e){console.log(e),200===e.data.code&&(t.tableData=e.data.data)})},filterHandler:function(t,e,i){return e[i.property]===t}},created:function(){this.getDepartment()}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"insideDepartment"},[i("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),i("div",{staticClass:"content"},[i("p",{staticClass:"title"},[t._v("部门管理")]),t._v(" "),i("div",{staticClass:"conditions"},[i("div",{staticClass:"condition"}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:t.addNewDepartment}},[t._v("新增部门\n      ")])],1),t._v(" "),i("div",{staticClass:"tabs"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:!0,"header-row-style":{height:"40px"},"header-cell-style":{padding:0,background:"#15bafe",color:"white"},"row-style":{height:"40px"},"cell-style":{padding:0}}},[i("el-table-column",{attrs:{prop:"id",label:"部门ID",width:"100","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{label:"名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"row_activity"},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"description",label:"介绍","min-width":"200","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{prop:"created_at",label:"职位设置",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"bumen"},t._l(e.row.position,function(e,s){return i("el-button",{key:s,attrs:{size:"mini",type:"primary",plain:""}},[t._v(t._s(e))])}))]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"created_at",label:"状态",width:"120","show-overflow-tooltip":"",filters:[{text:"启用",value:1},{text:"禁用",value:2}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?i("span",{staticClass:"normal_color"},[t._v("启用")]):t._e(),t._v(" "),2===e.row.status?i("span",{staticClass:"notpass_color"},[t._v("禁用")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"240",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.updateDepartment(e.row.id)}}},[t._v("修改")]),t._v(" "),1===e.row.status?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.handleOpenProhibit(e.row.id)}}},[t._v("禁用")]):t._e(),t._v(" "),2===e.row.status?i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.handleOpenEnable(e.row.id)}}},[t._v("启用")]):t._e()]}}])})],1)],1)]),t._v(" "),i("el-dialog",{attrs:{visible:t.editVisible,width:"400px"},on:{"update:visible":function(e){t.editVisible=e}}},[i("div",{staticClass:"dialog_head_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-edit-square examine_icon"}),t._v(" "),i("span",[t._v("创建部门")])]),t._v(" "),i("div",{staticClass:"jurisdiction_content"},[i("div",{staticClass:"jurisdiction_content_item"},[i("label",{staticClass:"el_lbl"},[t._v("部门名称:")]),t._v(" "),i("el-input",{staticClass:"el_input",attrs:{placeholder:"输入部门名称",size:"mini"},model:{value:t.industryTitle,callback:function(e){t.industryTitle=e},expression:"industryTitle"}})],1),t._v(" "),i("div",{staticClass:"jurisdiction_content_item"},[i("label",{staticClass:"el_lbl"},[t._v("部门介绍:")]),t._v(" "),i("el-input",{staticClass:"el_input_text_area",attrs:{placeholder:"200字内介绍",type:"textarea",autosize:{minRows:3,maxRows:3}},model:{value:t.industryContent,callback:function(e){t.industryContent=e},expression:"industryContent"}})],1),t._v(" "),i("div",{staticClass:"jurisdiction_content_item"},[i("label",{staticClass:"el_lbl"},[t._v("职位设置:")]),t._v(" "),i("el-input",{staticClass:"el_input_add",attrs:{placeholder:"输入新职位"},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}),t._v(" "),i("el-button",{staticClass:"el-icon-plus",attrs:{type:"primary",size:"mini"},on:{click:t.handleInputConfirm}})],1),t._v(" "),i("div",{staticClass:"jurisdiction_content_tag"},t._l(t.jobs,function(e,s){return i("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}))]),t._v(" "),i("div",{staticClass:"user_footer",attrs:{slot:"footer"},slot:"footer"},[i("el-row",{staticClass:"row_e"},[i("el-button",{staticClass:"btn_deletes",attrs:{size:"small"},on:{click:function(e){t.editVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{staticClass:"btn_delete",attrs:{type:"primary",size:"small"},on:{click:t.addDepartment}},[t._v("保存")])],1)],1)]),t._v(" "),i("delete-modal",{ref:"delete",on:{doDelete:t.deleteConfirm}}),t._v(" "),i("el-dialog",{attrs:{width:"470px","custom-class":"deleteDialog",visible:t.prohibitDialog,center:""},on:{"update:visible":function(e){t.prohibitDialog=e}}},[i("span",{staticClass:"deleteDialog_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),i("div",{staticClass:"deleteDialog_box"},[i("i",{staticClass:"iconfont icon-warning-circle ibg"}),t._v(" "),i("p",[t._v("确定禁用此部门吗？")])]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.prohibitDialog=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleProhibit}},[t._v("确 定")])],1)]),t._v(" "),i("el-dialog",{attrs:{width:"470px","custom-class":"deleteDialog",visible:t.enableDialog,center:""},on:{"update:visible":function(e){t.enableDialog=e}}},[i("span",{staticClass:"deleteDialog_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),i("div",{staticClass:"deleteDialog_box"},[i("i",{staticClass:"iconfont icon-warning-circle ibg"}),t._v(" "),i("p",[t._v("确定启用此部门吗？")])]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.enableDialog=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleEnable}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]};var l=i("VU/8")(n,o,!1,function(t){i("Hfg+"),i("V580")},"data-v-637c5804",null);e.default=l.exports},"Hfg+":function(t,e){},V580:function(t,e){}});