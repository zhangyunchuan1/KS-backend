webpackJsonp([194],{cCXt:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),s=a.n(i),l=a("exGp"),n=a.n(l),o=a("ZPfm"),r=a("+jNi"),c={name:"QuestionManagement",components:{BreadCrumb:o.a,DeleteModal:r.a},data:function(){return{breadData:[{id:1,name:"问题",urls:"/index/question/question",icon:"icon-home"},{id:2,name:"问题管理",urls:"/index/question/questionManagement",icon:"icon-home"}],options:[],value:"",tableData:[],disableDialog:!1,disableDialogRadio:null,textarea:"",deleteDialog:!1,remarkDialog:!1,approveDialog:!1,obtainedDialog:!1,folder_id:null,nickname:null,title:null,questionId:null,rejectList:[],rejectData:null}},mounted:function(){this.getQuestionList(this.folder_id,this.nickname,this.title),this.getFolders()},methods:{getFolders:function(){var t=this;return n()(s.a.mark(function e(){var a,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.HttpClient.post("/admin/menu/getList",{menu_type:2,type:0});case 2:return a=e.sent,e.next=5,a.data;case 5:i=e.sent,console.log(i.data),200===i.code&&(t.options=i.data);case 8:case"end":return e.stop()}},e,t)}))()},updateButton:function(t){this.$router.push({path:"/index/question/question-modify",query:{id:t}})},handleOpendelete:function(t){this.questionId=t,this.deleteDialog=!0},handleDelete:function(){var t=this;this.HttpClient.post("/admin/question/changeStatus",{question_id:this.questionId,status:0}).then(function(e){console.log(e),200===e.data.code?(t.$message.success(e.data.msg),setTimeout(function(){t.getQuestionList(t.folder_id,t.nickname,t.title)},350),t.deleteDialog=!1):t.$message.error(e.data.msg)})},tt:function(t){console.log(t),this.rejectData=t},handleReject:function(t,e,a){var i=this;this.HttpClient.post("/admin/webReview/getList",{type:"upload"}).then(function(t){console.log(t),i.rejectList=t.data.data}),this.questionId=t,this.disableDialog=!0},handleSureReject:function(){var t=this;this.HttpClient.post("/admin/question/changeStatus",{question_id:this.questionId,status:3,refuse:this.textarea,review_id:this.rejectData.review_id,review_name:this.rejectData.name}).then(function(e){console.log(e),200===e.data.code?(t.$message.success(e.data.msg),setTimeout(function(){t.getQuestionList(t.folder_id,t.nickname,t.title)},350),t.disableDialog=!1):t.$message.error(e.data.msg)})},handleOpenApproval:function(t){this.questionId=t,this.approveDialog=!0},handleSureApproval:function(){var t=this;this.HttpClient.post("/admin/question/changeStatus",{question_id:this.questionId,status:1}).then(function(e){console.log(e.data.data),e.data.code&&(t.$message.success(e.data.msg),t.approveDialog=!1,setTimeout(function(){t.getQuestionList(t.folder_id,t.nickname,t.title)},500))})},handleTitleSearch:function(){this.getQuestionList(this.folder_id,this.nickname,this.title)},handleNickNameSearch:function(){this.getQuestionList(this.folder_id,this.nickname,this.title)},handleTypeSearch:function(t){this.folder_id=t,this.getQuestionList(this.folder_id,this.nickname,this.title)},getQuestionList:function(t,e,a){var i=this;this.HttpClient.post("/admin/question/getList",{folder_id:t,nickname:e,title:a}).then(function(t){console.log(t),i.tableData=t.data.data.data})},filterPlate:function(t,e,a){return e[a.property]===t},filterSecondary:function(t,e,a){return e[a.property]===t},handleRemove:function(t,e){console.log(t,e)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"questionManagement"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"question_main"},[t._m(0),t._v(" "),a("div",{staticClass:"question_header"},[a("div",{staticClass:"question_select"},[a("el-select",{attrs:{placeholder:"类型"},on:{change:function(e){t.handleTypeSearch(e)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("el-option",{attrs:{label:"全部",value:" "}}),t._v(" "),t._l(t.options,function(t){return a("el-option",{key:t.menu_id,attrs:{label:t.name,value:t.menu_id}})})],2)],1),t._v(" "),a("div",{staticClass:"question_search"},[a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"昵称搜索"},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){t.handleNickNameSearch()}},slot:"append"})],1)],1),t._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"题目搜索"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){t.handleTitleSearch()}},slot:"append"})],1)],1)])]),t._v(" "),a("div",{staticClass:"question_content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"ID",align:"center",width:"65",prop:"id",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"问题题目",align:"center",prop:"title",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"昵称",align:"center",prop:"nickname",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户名",align:"center",prop:"username",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"字数",align:"center",prop:"word_num",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{label:"所属板块",align:"center",prop:"menu.folder_name",width:"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"子类",align:"center",filters:[{text:"基本理论知识",value:"基本理论知识"},{text:"发动机",value:"发动机"}],"filter-method":t.filterSecondary,prop:"menu.menu_1_name",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户类别",align:"center",filters:[{text:"个人用户",value:1},{text:"专业商家",value:2},{text:"普通商家",value:3}],"filter-method":t.filterSecondary,prop:"user_type",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.user_type?a("span",[t._v("普通商家")]):t._e(),t._v(" "),2===e.row.user_type?a("span",[t._v("专业商家")]):t._e(),t._v(" "),1===e.row.user_type?a("span",[t._v("个人用户")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"130",prop:"created_at",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"通过状态",align:"center",filters:[{text:"未通过",value:3},{text:"已通过",value:1},{text:"已通过",value:2}],"filter-method":t.filterSecondary,prop:"status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.status?a("span",[t._v("未通过")]):t._e(),t._v(" "),2===e.row.status?a("span",[t._v("未通过")]):t._e(),t._v(" "),1===e.row.status?a("span",[t._v("已通过")]):t._e(),t._v(" "),0===e.row.status?a("span",{staticStyle:{color:"red"}},[t._v("已删除")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"审核状态",align:"center",filters:[{text:"待审核",value:2},{text:"已审核",value:1},{text:"已删除",value:0},{text:"已驳回",value:3}],"filter-method":t.filterSecondary,prop:"status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.status?a("span",[t._v("已驳回")]):t._e(),t._v(" "),2===e.row.status?a("span",[t._v("待审核")]):t._e(),t._v(" "),1===e.row.status?a("span",[t._v("已审核")]):t._e(),t._v(" "),0===e.row.status?a("span",{staticStyle:{color:"red"}},[t._v("已删除")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"250px",label:"操作",align:"center","class-name":"question_scope",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"question_btm"},[a("div",{class:2==e.row.status||3==e.row.status?"":"approval",on:{click:function(a){t.handleOpenApproval(e.row.question_id)}}},[t._v("批准")]),t._v(" "),a("div",{class:2==e.row.status||1==e.row.status?"":"approval",on:{click:function(a){t.handleReject(e.row.question_id,e.row.id,e.row.title)}}},[t._v("驳回")]),t._v(" "),a("div",{on:{click:function(a){t.updateButton(e.row.id)}}},[t._v("修改")]),t._v(" "),a("div",{class:0===e.row.status?"approval":"delete",on:{click:function(a){t.handleOpendelete(e.row.question_id)}}},[t._v("删除")]),t._v(" "),a("div",[t._v("预览")])])]}}])})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.disableDialog},on:{"update:visible":function(e){t.disableDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("驳回\n    ")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("理由：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:4},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}})],1)]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("类别：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},t._l(t.rejectList,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.id},on:{change:function(a){t.tt(e)}},model:{value:t.disableDialogRadio,callback:function(e){t.disableDialogRadio=e},expression:"disableDialogRadio"}},[t._v(t._s(e.name))])}))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.disableDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSureReject}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.approveDialog,width:"470px","custom-class":"approveDialog"},on:{"update:visible":function(e){t.approveDialog=e}}},[a("span",{staticClass:"approveDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"approveDialog_main"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("div",{staticClass:"approveDialog_text"},[t._v("确认批准吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.approveDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSureApproval}},[t._v("提 交")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"deleteDialog",visible:t.deleteDialog,center:""},on:{"update:visible":function(e){t.deleteDialog=e}}},[a("span",{staticClass:"deleteDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"deleteDialog_box"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("p",[t._v("确定删除吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.deleteDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleDelete}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"question_title"},[e("div",{staticClass:"title"},[this._v("问题管理")])])}]};var d=a("VU/8")(c,u,!1,function(t){a("jFZ+")},null,null);e.default=d.exports},"jFZ+":function(t,e){}});