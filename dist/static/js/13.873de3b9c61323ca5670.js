webpackJsonp([13],{"4u7l":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"ActivitySeeSignUp",components:{BreadCrumb:i("ZPfm").a},data:function(){return{activityEndTime:null,state:0,input22:0,input21:0,verificationCode:"",ticNumber:null,realName:"习大大",idnumber:"54153216658545148",userId:"251561",businessPhone:"18996657240",textarea:"",checkAll:!1,refundVisible:!1,privateLetterVisible:!1,inspectTicketVisible:!1,identityConfirmVisible:!1,remark:"",warmImg:i("GvV1"),breadData:[{id:1,name:"活动",urls:"/index",icon:"icon-home"},{id:2,name:"查看报名",urls:"/index/activity-modify",icon:"icon-home"}],cityOptions:[{value:1,label:"全部"},{value:2,label:"长期"},{value:3,label:"定时"}],typeOptions:[{value:1,label:"全部"},{value:2,label:"汽车"},{value:3,label:"摩托"},{value:4,label:"无人机"}],levelOptions:[{value:1,label:"全部"},{value:2,label:"改装"}],typeValue:null,plateValue:null,levelValue:null,statusValue:null,dialogImageUrl:"",dialogVisible:!1,tableData:[],headData:{title:"",city_name:""},refundData:[],balance:0,refundableNum:null,userinfo:{actual_name:null,id_card:null,phone:null,username:null},order_id:null,total:null,currentPage:1}},created:function(){console.log(this.$route.query.id),this.getApplicantList(this.$route.query.id)},methods:{handleSubmitVerification:function(){var t=this;this.HttpClient.post("/admin/actives/checkTicket",{order_id:this.order_id,code:this.verificationCode,num:this.ticNumber}).then(function(e){console.log(e),200===e.data.code?(t.state=1,setTimeout(function(){t.getApplicantList(t.$route.query.id),t.inspectTicketVisible=!1},1e3)):t.state=2})},handleInspectTicket:function(t){this.order_id=t.order_id,this.verificationCode=t.code,this.inspectTicketVisible=!0},handleUserAuthentication:function(t){var e=this;this.HttpClient.post("/admin/users/info",{uid:t}).then(function(t){console.log(t),e.userinfo=t.data.data}),this.identityConfirmVisible=!0},handleChangeNum:function(t){console.log(t),this.input21>this.refundableNum?this.$message.console.error("输入退票数大于可退票数"):this.input22=this.input21*this.refundData[0].price},handleRefund:function(t){console.log(t),this.refundData=[],this.refundData.push(t),console.log(this.refundData),this.refundableNum=this.refundData[0].quantity-this.refundData[0].refund_num,this.refundData[0].balance=this.balance,this.refundVisible=!0},handleSendRefund:function(){var t=this;console.log(this.input21,this.refundData[0].order_id),this.HttpClient.post("/admin/actives/returnTicket",{order_id:this.refundData[0].order_id,num:this.input21,msg:this.textarea}).then(function(e){console.log(e),200===e.data.code?(t.$message.success(e.data.msg),setTimeout(function(){t.getApplicantList(t.$route.query.id),t.refundVisible=!1},500)):t.$message.error(e.data.msg)})},getApplicantList:function(t){var e=this;this.HttpClient.post("/admin/activesOrders/orderLists",{size:25,page:this.currentPage,active_id:t}).then(function(t){console.log(t),e.tableData=t.data.lists.data,e.balance=t.data.info.balance,e.total=t.data.lists.total,e.headData=t.data.info;for(var i=0;i<e.tableData.length;i++)e.tableData[i].endTime=t.data.info.active_date_end})},handleTypeChange:function(t){console.log(t,this.typeValue)},handleRemove:function(t,e){console.log(t,e)},handlePreview:function(t){console.log(t)},handleExceed:function(t,e){this.$message.warning("当前限制选择 3 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},beforeRemove:function(t,e){return this.$confirm("确定移除 "+t.name+"？")},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleExamine:function(){this.examineVisible=!1},handleDelete:function(){this.deleteVisible=!1},currentChange:function(t){this.currentPage=t,this.getApplicantList(this.$route.query.id)}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),i("div",{staticClass:"content"},[i("p",{staticClass:"title"},[t._v("查看报名")]),t._v(" "),i("div",{staticClass:"content_contain"},[i("div",{staticClass:"conditions"},[i("div",{staticClass:"activityname",staticStyle:{background:"#15bafe",color:"#fff"}},[t._v(t._s(t.headData.title))]),t._v(" "),i("div",{staticStyle:{background:"#15bafe",color:"#fff"}},[t._v("玩出酷耍生命力，挑战720度回转寿司")]),t._v(" "),i("div",{staticStyle:{background:"#15bafe",color:"#fff"}},[t._v(t._s(t.headData.city_name))])]),t._v(" "),i("div",{staticClass:"tables"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:!0}},[i("el-table-column",{attrs:{label:"选择",width:"50"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("el-checkbox")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{label:"联系人",width:"100",prop:"conducts"}}),t._v(" "),i("el-table-column",{attrs:{prop:"telphone",label:"联系电话",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"quantity",label:"购买票数",width:"150"}}),t._v(" "),i("el-table-column",{attrs:{prop:"price",label:"单价",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"use_num",label:"已使用票数",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"refund_num",label:"退票数",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"pay_time",label:"购票时间",width:"180"}}),t._v(" "),i("el-table-column",{attrs:{prop:"endTime",label:"活动截止时间",width:"180"}}),t._v(" "),i("el-table-column",{attrs:{label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.quantity===e.row.use_num?i("span",{staticClass:"stop_color"},[t._v("已使用")]):t._e(),t._v(" "),e.row.quantity>e.row.use_num&&0!==e.row.use_num?i("span",{staticClass:"normal_color"},[t._v("未用完")]):t._e(),t._v(" "),0===e.row.use_num?i("span",{staticClass:"wait_color"},[t._v("未使用")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.handleRefund(e.row)}}},[t._v("退款")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){t.privateLetterVisible=!0}}},[t._v("私信用户")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.handleInspectTicket(e.row)}}},[t._v("验票")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"text"},on:{click:function(i){t.handleUserAuthentication(e.row.created_id)}}},[t._v("用户身份认证")])]}}])})],1),t._v(" "),i("div",{staticClass:"all"},[[i("el-checkbox",{model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")])],t._v(" "),i("span",[t._v("数量：1")])],2)],1)]),t._v(" "),t.total?i("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":25},on:{"current-change":t.currentChange}}):t._e()],1),t._v(" "),i("el-dialog",{attrs:{visible:t.refundVisible,width:"565px"},on:{"update:visible":function(e){t.refundVisible=e}}},[i("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-edit-square delete_icon"}),t._v(" "),i("span",[t._v("退款")])]),t._v(" "),i("el-table",{staticStyle:{width:"100%","margin-bottom":"15px"},attrs:{data:t.refundData,border:"",stripe:!0}},[i("el-table-column",{attrs:{prop:"quantity",label:"购买票数",width:"104"}}),t._v(" "),i("el-table-column",{attrs:{prop:"use_num",label:"已使用票数",width:"104"}}),t._v(" "),i("el-table-column",{attrs:{prop:"refund_num",label:"当前退票数",width:"104"}}),t._v(" "),i("el-table-column",{attrs:{prop:"balance",label:"账户余额",width:"106"}}),t._v(" "),i("el-table-column",{attrs:{label:"购票方式",width:"106"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.payment?i("span",[t._v("微信")]):t._e(),t._v(" "),2===e.row.payment?i("span",[t._v("支付宝")]):t._e(),t._v(" "),3===e.row.payment?i("span",[t._v("余额支付")]):t._e()]}}])})],1),t._v(" "),i("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"15px"}},[t._v("\n          选择退票数：\n          "),i("el-input",{attrs:{size:"small",placeholder:"请输入退款票数"},on:{change:function(e){t.handleChangeNum(e)}},model:{value:t.input21,callback:function(e){t.input21=e},expression:"input21"}}),t._v(" "),t.input21>t.refundableNum?i("span",{staticStyle:{color:"red"}},[t._v("退款票数大于可退款票数")]):t._e()],1),t._v(" "),i("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"15px"}},[t._v("\n          退款金额： \n          "),i("el-input",{attrs:{size:"small"},model:{value:t.input22,callback:function(e){t.input22=e},expression:"input22"}})],1),t._v(" "),i("div",{staticClass:"tips"},[i("p",[t._v("你准备给此用户退"+t._s(t.input21)+"张票，共计"+t._s(t.input22)+"元。")]),t._v(" "),i("p",[t._v("确定吗？")])]),t._v(" "),i("p",{staticClass:"liyou"},[t._v("退款理由：")]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入退款理由"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),t._v(" "),i("div",{staticClass:"btn"},[i("el-button",[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSendRefund}},[t._v("发送")])],1)],1),t._v(" "),i("el-dialog",{attrs:{visible:t.privateLetterVisible,width:"565px"},on:{"update:visible":function(e){t.privateLetterVisible=e}}},[i("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-edit-square delete_icon"}),t._v(" "),i("span",[t._v("商家名称：")])]),t._v(" "),i("p",{staticClass:"info"},[t._v("信息：")]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入消息内容"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),t._v(" "),i("div",{staticClass:"btn"},[i("el-button",[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"}},[t._v("发送")])],1)],1),t._v(" "),i("el-dialog",{attrs:{visible:t.inspectTicketVisible,width:"345px"},on:{"update:visible":function(e){t.inspectTicketVisible=e}}},[i("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-edit-square delete_icon"}),t._v(" "),i("span",[t._v("验票")])]),t._v(" "),i("div",{staticClass:"demo-input-suffix"},[t._v("\n            验证码：\n            "),i("el-input",{model:{value:t.verificationCode,callback:function(e){t.verificationCode=e},expression:"verificationCode"}})],1),t._v(" "),i("div",{staticClass:"demo-input-suffix"},[t._v("\n            票数：\n            "),i("el-input",{model:{value:t.ticNumber,callback:function(e){t.ticNumber=e},expression:"ticNumber"}})],1),t._v(" "),i("div",{staticClass:"status"},[1===t.state?i("div",{staticStyle:{background:"#2ee496",color:"#fff"}},[t._v("验证成功")]):t._e(),t._v(" "),2===t.state?i("div",{staticStyle:{background:"red",color:"#fff"}},[t._v("验证失败")]):t._e()]),t._v(" "),i("div",{staticClass:"btn"},[i("el-button",{on:{click:function(e){t.inspectTicketVisible}}},[t._v("关闭")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmitVerification}},[t._v("发送")])],1)]),t._v(" "),i("el-dialog",{attrs:{visible:t.identityConfirmVisible,width:"345px"},on:{"update:visible":function(e){t.identityConfirmVisible=e}}},[i("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"iconfont icon-edit-square delete_icon"}),t._v(" "),i("span",[t._v("用户身份确认")])]),t._v(" "),i("div",{staticClass:"demo-input-suffix"},[t._v("\n            商家电话：\n            "),i("el-input",{model:{value:t.userinfo.phone,callback:function(e){t.$set(t.userinfo,"phone",e)},expression:"userinfo.phone"}})],1),t._v(" "),i("div",{staticClass:"demo-input-suffix"},[t._v("\n            用户账号：\n            "),i("el-input",{model:{value:t.userinfo.username,callback:function(e){t.$set(t.userinfo,"username",e)},expression:"userinfo.username"}})],1),t._v(" "),i("div",{staticClass:"demo-input-suffix"},[t._v("\n            身份证号：\n            "),i("el-input",{model:{value:t.userinfo.id_card,callback:function(e){t.$set(t.userinfo,"id_card",e)},expression:"userinfo.id_card"}})],1),t._v(" "),i("div",{staticClass:"demo-input-suffix"},[t._v("\n            真实姓名：\n            "),i("el-input",{model:{value:t.userinfo.actual_name,callback:function(e){t.$set(t.userinfo,"actual_name",e)},expression:"userinfo.actual_name"}})],1)])],1)},staticRenderFns:[]};var l=i("VU/8")(a,n,!1,function(t){i("CKZy"),i("l9ub")},"data-v-eea044cc",null);e.default=l.exports},CKZy:function(t,e){},l9ub:function(t,e){}});