webpackJsonp([206],{Gq53:function(t,e){},beod:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("ZPfm"),l=a("QL8K"),o=a.n(l),i={name:"HeaderAdvert",components:{BreadCrumb:s.a},data:function(){return{breadData:[{id:1,name:"商城",urls:"/index/mall/mall/Mall",icon:"icon-home"},{id:2,name:"商城广告",urls:"/index/service/Service",icon:"icon-home"},{id:3,name:"头部广告",urls:"/index/service/NewTaskAll",icon:"icon-home"}],tableData:[],tmps:[],choseValue:"",RemarksDialog:!1,total:null,imageUrl:null,title:"",url:"",product_int:"",mall:"",isShowProductDialog:!1,products:{},productCover:"",searchResult:!1,bot:!0,tips:"请在上面搜索商品。",uploadId:null,uploadTitle:null,uploadName:null,uploadUrl:null}},mounted:function(){this.getMessageList()},methods:{handleChangePalte:function(){console.log(this.mall)},getMessageList:function(){var t=this;this.HttpClient.get("/admin/advertisement").then(function(e){var a=e.data,s=a.code,l=a.data;200===s&&(t.tableData=l.data.filter(function(t){return 1===t.layout}))})},handleOpenAddAd:function(){this.RemarksDialog=!0,this.searchResult=!1,this.getMallTmp()},getMallTmp:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:1,type:0}).then(function(e){console.log(e);var a=e.data,s=a.code,l=a.data;200===s&&(t.tmps=l)})},searchID:function(){var t=this;this.HttpClient.post("/admin/marketProduct/baseInfo",{id:this.product_int}).then(function(e){console.log(e);var a=e.data,s=a.code,l=a.msg,i=a.data;if(console.log(l),200===s){t.products=i;var n=i.show_picture[0].path;t.productCover=""+o.a.imageUrl+n,t.searchResult=!0}else t.searchResult=!1,t.$message.error("暂无此ID"),t.tips="没有搜索到该商品！"})},changeStatus:function(t){var e=this,a=t.id,s=t.status;s=1===s?3:1,this.HttpClient.post("/admin/advertisement/changeStatus",{id:a,status:s}).then(function(t){var a=t.data,s=a.code,l=a.msg;200===s?(e.$message.success(l),setTimeout(function(){e.getMessageList()},500)):e.$message.error(l)})},deleteAdv:function(t){var e=this;this.HttpClient.delete("/admin/advertisement/"+t).then(function(t){var a=t.data,s=a.code,l=a.msg;200===s?(e.$message.success(l),setTimeout(function(){e.getMessageList()},500)):e.$message.error(l)})},checkProduct:function(t){window.open(t.url,"_blank")},beforeAvatarUpload:function(t){var e=this,a="image/jpeg"===t.type;t.size;if(!a)return this.$message.error("上传图片只能是 JPG 格式!");this.HttpClient.form("/admin/uploadOneImage",{images:t}).then(function(t){var a=t.data,s=a.code,l=a.msg,o=a.path;200===s?(e.$message.success(l),e.imageUrl=o):e.$message.error(l)})},handleSureSelect:function(){this.bot=!1,this.uploadId=this.product_int,this.uploadTitle=this.products.title,this.uploadName=this.products.company_name},handleDeselected:function(){this.searchResult=!1,this.bot=!0,this.uploadId=null,this.uploadTitle=null,this.uploadName=null},handleSubmitNewAdv:function(){for(var t=this,e={title:this.title,image:this.imageUrl,product_int:this.uploadId,product_name:this.uploadTitle,company_name:this.uploadName,folder_id:this.mall,layout:"1"},a=0,s=0;s<this.tableData.length;s++)e.folder_id===this.tableData[s].folder_id&&(a+=1);a>=2?this.$message.warning("每个版块的广告不能大于2条。"):(console.log(e),this.HttpClient.post("/admin/advertisement",e).then(function(e){var a=e.data,s=a.code,l=a.msg;200===s?(t.$message.success(l),t.RemarksDialog=!1,t.title="",t.choseValue="",t.mall="",t.uploadId=null,t.uploadTitle=null,t.uploadName=null,setTimeout(function(){t.getMessageList()},500)):t.$message.error(l)}))},handleCurrentChange:function(t){console.log(t)}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"HeaderAdvert"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"newInformation_main"},[t._m(0),t._v(" "),a("div",{staticClass:"tiledai",on:{click:t.handleOpenAddAd}},[t._v("创建新广告")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content_main"},[a("div",{staticClass:"content_table"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"广告标题",align:"center",width:"200",prop:"title","show-overflow-tooltip":"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.title?a("span",[t._v(t._s(e.row.title))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品ID",align:"center",width:"150","show-overflow-tooltip":"",prop:"id"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.id?a("span",[t._v(t._s(e.row.id))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品名称",align:"center",width:"200","show-overflow-tooltip":"",prop:"product_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.product_name?a("span",[t._v(t._s(e.row.product_name))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"所属板块",align:"center",width:"150","show-overflow-tooltip":"",prop:"folder_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.folder_name?a("span",[t._v(t._s(e.row.folder_name))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"访问次数",align:"center",width:"100","show-overflow-tooltip":"",prop:"view_num"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.view_num))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"购买总数",align:"center",width:"150","show-overflow-tooltip":"",prop:"sole_num"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.sole_num))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"160","show-overflow-tooltip":"",prop:"created_at"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.created_at?a("span",[t._v(t._s(e.row.created_at))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center",width:"80","show-overflow-tooltip":"",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("span",{staticClass:"delete_color"},[t._v("删除")]):t._e(),t._v(" "),1===e.row.status?a("span",{staticClass:"normal_color"},[t._v("上线")]):t._e(),t._v(" "),2===e.row.status?a("span",{staticClass:"audit_color"},[t._v("审核")]):t._e(),t._v(" "),3===e.row.status?a("span",{staticClass:"sortout_color"},[t._v("下线")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"350",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.checkProduct(e.row)}}},[t._v("预览")]),t._v(" "),1===e.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.changeStatus(e.row)}}},[t._v("下线")]):t._e(),t._v(" "),3===e.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.changeStatus(e.row)}}},[t._v("上线")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.deleteAdv(e.row.id)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"}},[t._v("购买记录")])]}}])})],1)],1)])])]),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":25},on:{"current-change":function(e){t.handleCurrentChange(e)}}}):t._e(),t._v(" "),a("el-dialog",{attrs:{visible:t.RemarksDialog,width:"750px","custom-class":"RemarksDialog"},on:{"update:visible":function(e){t.RemarksDialog=e}}},[a("span",{staticClass:"RemarksDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-edit-square"}),t._v("创建新广告\n    ")]),t._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://test.kslab.com/api/article/null","show-file-list":!1,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"广告标题"}},[a("el-input",{model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),a("div",{staticClass:"search_product"},[a("el-form-item",{attrs:{label:"商城板块"}},[a("el-select",{attrs:{placeholder:"活动区域"},on:{change:t.handleChangePalte},model:{value:t.mall,callback:function(e){t.mall=e},expression:"mall"}},t._l(t.tmps,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.menu_id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"产品搜索"}},[a("div",{staticClass:"flex"},[a("el-input",{attrs:{placeholder:"输入产品ID"},model:{value:t.product_int,callback:function(e){t.product_int=e},expression:"product_int"}}),t._v(" \n              "),a("el-button",{attrs:{type:"primary"},on:{click:t.searchID}},[t._v("搜索")])],1)])],1)],1),t._v(" "),t.searchResult?a("div",[a("div",{staticClass:"search_resault"},[a("div",{staticClass:"search_resault_left"},[a("p",[t._v("商品图片")]),t._v(" "),a("img",{attrs:{src:t.productCover,alt:""}})]),t._v(" "),a("div",{staticClass:"search_resault_right"},[a("span",{staticClass:"resault_title"},[t._v("产品名称")]),t._v(" "),a("p",{staticClass:"resault_value"},[t._v(t._s(t.products.title))]),t._v(" "),a("span",{staticClass:"resault_title"},[t._v("商家名称")]),t._v(" "),a("p",{staticClass:"resault_value"},[t._v(t._s(t.products.company_name))]),t._v(" "),a("div",{staticClass:"sure_resault"},[t.bot?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleSureSelect}},[t._v("选择该商品")]):a("el-button",{attrs:{size:"mini"},on:{click:t.handleDeselected}},[t._v("取消选择")])],1)])])]):a("div",{staticClass:"search_resault_tips"},[t._v("\n      "+t._s(t.tips)+"\n    ")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.RemarksDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmitNewAdv}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.isShowProductDialog,"custom-class":"product-dialog",width:"500px"},on:{"update:visible":function(e){t.isShowProductDialog=e}}},[a("div",{staticClass:"flex"},[a("img",{staticClass:"product-cover",attrs:{src:t.productCover}}),t._v(" "),a("div",[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"产品名称"}},[a("el-input",{model:{value:t.products.title,callback:function(e){t.$set(t.products,"title",e)},expression:"products.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商家名称"}},[a("el-input",{model:{value:t.products.company_name,callback:function(e){t.$set(t.products,"company_name",e)},expression:"products.company_name"}})],1)],1)],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowProductDialog=!1}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("头部广告")]),this._v(" "),e("p",{staticStyle:{cursor:"pointer"}},[e("i",{staticClass:"iconfont icon-shuaxin"}),this._v("\n        刷新\n      ")])])}]};var r=a("VU/8")(i,n,!1,function(t){a("Gq53")},null,null);e.default=r.exports}});