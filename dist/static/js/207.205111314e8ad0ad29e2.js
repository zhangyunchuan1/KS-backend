webpackJsonp([207],{"0BAK":function(t,e){},s7JJ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),l=a.n(i),n=a("gRE1"),o=a.n(n),s=a("exGp"),r=a.n(s),c=a("ZPfm"),d=a("+jNi"),u={name:"MallReview",components:{BreadCrumb:c.a,DeleteModal:d.a},data:function(){return{breadData:[{id:1,name:"商城",urls:"/index/mall/mall/Mall",icon:"icon-home"},{id:2,name:"商城商品",urls:"/index/mallProduct/MallProduct",icon:"icon-home"},{id:3,name:"商品审核",urls:"/index/mallProduct/MallReview",icon:"icon-home"}],mallReviewSelect:"",merchantSearch:"",productSearch:"",typeList:[],tableData:[],firstCatalogue:[],secondCatalogue:[],thirdCatalogue:[],productCatalogue:[],firstCategorySelect:"",secondCategorySelect:"",thirdCategorySelect:"",productCategorySelect:"",headerSelect:"",headerOptions:[{status:0,text:"全部"},{status:1,text:"通过"},{status:2,text:"未通过"}],headerAuditSelect:"",headerAuditOptions:[{status:0,text:"全部"},{status:1,text:"已审核"},{status:2,text:"待审核"}],disableDialog:!1,rejectReason:"",rejectValue:"",rejectList:[],approveDialog:!1,adaptDialog:!1,brandDialog:!1,brandSelect:"",brandList:[],seriesSelect:"",seriesList:[],yearSelect:[],yearList:[],configSelect:"",configList:[],brandData:[],brandCurrentPage:1,brandPageSize:10,brandTotal:0,productId:"",brandId:"",currentPage:1,pageSize:25,total:0}},methods:{getAuditList:function(){var t=this,e={page:this.currentPage,size:this.pageSize,folder:this.mallReviewSelect};""!=this.firstCategorySelect&&(e.menu_1=this.firstCategorySelect),""!=this.secondCategorySelect&&(e.menu_2=this.secondCategorySelect),""!=this.thirdCategorySelect&&(e.menu_3=this.thirdCategorySelect),""!=this.productCategorySelect&&(e.id=this.productCategorySelect),""!==this.headerSelect&&(e.pass_status=this.headerSelect),""!==this.headerAuditSelect&&(e.review_status=this.headerAuditSelect),this.productSearch&&(e.title=this.productSearch),this.HttpClient.post("/admin/marketProduct/getListsWithShopMenu",e).then(function(e){200===e.data.code&&(t.tableData=e.data.data.data,console.log(t.tableData),t.total=e.data.data.total)})},getTypeList:function(){var t=this;return r()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.HttpClient.post("/admin/menu/getList",{menu_type:1,type:1}).then(function(e){200===e.data.code&&(t.typeList=o()(e.data.data),t.mallReviewSelect=t.typeList[0].menu_id,t.firstCatalogue=t.typeList[0].child,t.secondCatalogue=t.firstCatalogue[0].child,t.thirdCatalogue=t.secondCatalogue[0].child,t.getClassify(t.thirdCatalogue[1].menu_id),console.log(t.thirdCatalogue))});case 2:case"end":return e.stop()}},e,t)}))()},getClassify:function(t){var e=this;this.HttpClient.post("/shop/menu/getOneChild",{isFolder:0,menu_id:0,last_menu:t}).then(function(t){console.log(t),200===t.data.code&&(e.productCatalogue=t.data.data)})},getBrandList:function(t,e){var a=this,i={};0===e?i.menu_id=t:1===e?i.brand_id=t:2===e?i.series_id=t:i.config_id=t,this.HttpClient.get("/brands",i).then(function(t){var i=t.data,l=i.code,n=i.data;200===l&&(0===e?a.brandList=n:1===e?a.seriesList=n:2===e?a.configList=n:a.yearList=n)})},getBrandSelectedList:function(){var t=this;this.HttpClient.post("/admin/product/relationIndex",{page:this.brandCurrentPage,size:this.brandPageSize,product_id:this.productId}).then(function(e){200===e.data.code&&(t.brandData=e.data.data.data,t.brandTotal=e.data.data.total)})},typeChange:function(){var t=this;this.typeList.map(function(e){e.menu_id===t.mallReviewSelect&&(e.child?(t.firstCatalogue=e.child,t.firstCatalogue[0]&&t.firstCatalogue[0].child?(t.secondCatalogue=t.firstCatalogue[0].child,t.secondCatalogue[0]&&t.secondCatalogue[0].child?t.thirdCatalogue=t.secondCatalogue[0].child:t.thirdCatalogue=[]):(t.secondCatalogue=[],t.thirdCatalogue=[])):(t.firstCatalogue=[],t.secondCatalogue=[],t.thirdCatalogue=[]))}),this.getAuditList()},changeStatus:function(t,e){var a=this,i={product_id:t,status:e};2===e&&(i.refuse=this.rejectReason,i.review_id=this.rejectValue,this.rejectList.map(function(t){t.review_id===a.rejectValue&&(i.review_name=t.name)})),this.HttpClient.post("/admin/marketProduct/changeStatus",i).then(function(t){200===t.data.code?(a.$message.success(t.data.msg),setTimeout(function(){a.getAuditList()},500),1===e?a.approveDialog=!1:2===e&&(a.disableDialog=!1)):a.$message.error(t.data.msg)})},updateButton:function(t){this.$router.push({path:"/index/mall/mallProduct/product-modify",query:{id:t}})},approveButton:function(t){this.productId=t,this.approveDialog=!0},rejectButton:function(t){var e=this;this.productId=t,this.disableDialog=!0,this.HttpClient.post("/admin/webReview/getList",{type:"business"}).then(function(t){200===t.data.code&&(e.rejectList=t.data.data)})},previewButton:function(t){this.$router.push({path:"/index/mall/mallProduct/product-preview",query:{id:t}})},deleteButton:function(t){this.productId=t,this.$refs.delete.deleteDialog=!0},adaptButton:function(t){console.log(t),2===t.suit?(this.productId=t.product_id,this.brandDialog=!0,this.getBrandList(t.menu[0].menu_id,0),this.getBrandSelectedList()):this.adaptDialog=!0},rejectConfirm:function(){this.changeStatus(this.productId,2)},approveConfirm:function(){this.changeStatus(this.productId,1)},deleteConfirm:function(){this.changeStatus(this.productId,0)},addBrand:function(){var t=this,e={product_id:this.productId,action:"add"};this.yearSelect&&this.yearSelect.length>0?e.id=this.yearSelect:this.configList.map(function(a){a.config_id===t.configSelect&&(e.id=a.id)}),this.HttpClient.post("/admin/marketProduct/addOrDelCarType",e).then(function(e){200===e.data.code?(t.$message.success(e.data.msg),setTimeout(function(){t.getBrandSelectedList()},500)):t.$message.error(e.data.msg)})},deleteBrand:function(t){this.brandId=t,this.$refs.deleteBrand.deleteDialog=!0},deleteBrandConfirm:function(t){var e=this;t&&this.HttpClient.post("/admin/marketProduct/addOrDelCarType",{product_id:this.productId,action:"del",id:this.brandId}).then(function(t){200===t.data.code?(e.$message.success(t.data.msg),setTimeout(function(){e.getBrandSelectedList()},500)):e.$message.error(t.data.msg)})},currentChange:function(t){this.currentPage=t,this.getAuditList()},brandCurrentChange:function(t){this.brandCurrentPage=t,this.getBrandSelectedList()},renderProductStatus:function(t,e){var a=this;e.column;return t("el-select",{props:{value:"通过状态",placeholder:"通过状态"},on:{input:function(t){a.headerSelect=t,a.getAuditList()}}},[this.headerOptions.map(function(e){return t("el-option",{props:{value:e.status,label:e.text}})})])},renderProductAuditStatus:function(t,e){var a=this;e.column;return t("el-select",{props:{value:"审核状态",placeholder:"审核状态"},on:{input:function(t){a.headerAuditSelect=t,a.getAuditList()}}},[this.headerAuditOptions.map(function(e){return t("el-option",{props:{value:e.status,label:e.text}})})])},renderProductFirst:function(t,e){var a=this;e.column;return t("el-select",{props:{value:"一级目录",placeholder:"一级目录"},on:{input:function(t){a.firstCategorySelect=t,a.secondCategorySelect="",a.getAuditList()}}},[this.firstCatalogue.map(function(e){return t("el-option",{props:{value:e.menu_id,label:e.name}})})])},renderProductSecond:function(t,e){var a=this;e.column;return t("el-select",{props:{value:"二级目录",placeholder:"二级目录"},on:{input:function(t){a.secondCategorySelect=t,a.firstCategorySelect="",a.thirdCategorySelect="",a.getAuditList()}}},[this.secondCatalogue.map(function(e){return t("el-option",{props:{value:e.menu_id,label:e.name}})})])},renderProductThird:function(t,e){var a=this;e.column;return t("el-select",{props:{value:"三级目录",placeholder:"三级目录"},on:{input:function(t){a.thirdCategorySelect=t,a.firstCategorySelect="",a.secondCategorySelect="",a.getAuditList()}}},[this.thirdCatalogue.map(function(e){return t("el-option",{props:{value:e.menu_id,label:e.name}})})])},renderProductCatalogue:function(t,e){var a=this;e.column;return t("el-select",{props:{value:"产品类型",placeholder:"产品类型"},on:{input:function(t){a.productCategorySelect=t,a.getAuditList()}}},[this.productCatalogue.map(function(e){return t("el-option",{props:{value:e.id,label:e.name}})})])}},created:function(){var t=this;return r()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTypeList();case 2:t.getAuditList();case 3:case"end":return e.stop()}},e,t)}))()},watch:{firstCategorySelect:function(){var t=this;this.firstCatalogue.map(function(e){e.menu_id===t.firrstCategorySelect&&(console.log(t.thirdCatalogue),t.secondCatalogue=e.child,t.thirdCatalogue=t.secondCatalogue?t.secondCatalogue[0].child:[],t.getClassify(t.thirdCatalogue[0].menu_id))})},secondCategorySelect:function(){var t=this;this.secondCatalogue.map(function(e){e.menu_id===t.secondCategorySelect&&(console.log(t.thirdCatalogue),t.thirdCatalogue=e.child,t.getClassify(t.thirdCatalogue[0].menu_id))})},thirdCategorySelect:function(){this.getClassify(this.thirdCategorySelect)}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mallReview"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"mallReview_main"},[t._m(0),t._v(" "),a("div",{staticClass:"mallReview_select"},[a("el-radio-group",{on:{change:t.typeChange},model:{value:t.mallReviewSelect,callback:function(e){t.mallReviewSelect=e},expression:"mallReviewSelect"}},t._l(t.typeList,function(e){return a("el-radio",{key:e.id,attrs:{border:"",label:e.menu_id}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("div",{staticClass:"mallReview_header"},[a("div",{staticClass:"mallReview_search"},[a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"商家名称",clearable:""},on:{change:t.getAuditList},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getAuditList(e):null}},model:{value:t.merchantSearch,callback:function(e){t.merchantSearch=e},expression:"merchantSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getAuditList},slot:"append"})],1)],1),t._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"产品名称",clearable:""},on:{change:t.getAuditList},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getAuditList(e):null}},model:{value:t.productSearch,callback:function(e){t.productSearch=e},expression:"productSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getAuditList},slot:"append"})],1)],1)])]),t._v(" "),a("div",{staticClass:"mallReview_content_box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"ID",align:"center",width:"70",prop:"id",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"商品名称",align:"center",width:"150","show-overflow-tooltip":"",prop:"title"}}),t._v(" "),a("el-table-column",{attrs:{label:"一级目录",align:"center","render-header":t.renderProductFirst,width:"110","show-overflow-tooltip":"",prop:"menu_1_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"二级目录",align:"center","render-header":t.renderProductSecond,width:"110","show-overflow-tooltip":"",prop:"menu_2_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"三级目录",align:"center","render-header":t.renderProductThird,width:"110","show-overflow-tooltip":"",prop:"menu_3_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"产品类型",align:"center","render-header":t.renderProductCatalogue,width:"110","show-overflow-tooltip":"",prop:"category"}}),t._v(" "),a("el-table-column",{attrs:{label:"商家名称",align:"center",width:"110","show-overflow-tooltip":"",prop:"nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"180","class-name":"created_at",prop:"created_at",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"通过状态",align:"center","render-header":t.renderProductStatus,"show-overflow-tooltip":"",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("span",{staticStyle:{color:"#15bafe"}},[t._v("已通过")]):t._e(),t._v(" "),1!==e.row.status?a("span",{staticStyle:{color:"red"}},[t._v("未通过")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"审核状态",align:"center","render-header":t.renderProductAuditStatus,"show-overflow-tooltip":"",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                        "+t._s(3===e.row.status?"待审核":"已审核")+"\n                    ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","class-name":"mallReview_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"mallReview_btm",staticStyle:{color:"#15bafe"}},[3!==e.row.status&&1!==e.row.status?a("el-button",{on:{click:function(a){t.updateButton(e.row.product_id)}}},[t._v("修改")]):t._e(),t._v(" "),3===e.row.status?a("el-button",{on:{click:function(a){t.approveButton(e.row.product_id)}}},[t._v("批准")]):t._e(),t._v(" "),1===e.row.status||3===e.row.status?a("el-button",{staticClass:"notpass_color",on:{click:function(a){t.rejectButton(e.row.product_id)}}},[t._v("驳回")]):t._e(),t._v(" "),a("el-button",{on:{click:function(a){t.previewButton(e.row.product_id)}}},[t._v("预览")]),t._v(" "),3!==e.row.status&&1!==e.row.status?a("el-button",{staticClass:"delete_color",on:{click:function(a){t.deleteButton(e.row.product_id)}}},[t._v("删除")]):t._e(),t._v(" "),"汽车1"===e.row.folder_name||"摩托车"===e.row.folder_name?a("el-button",{on:{click:function(a){t.adaptButton(e.row)}}},[t._v("适应车型")]):t._e()],1)]}}])})],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.disableDialog},on:{"update:visible":function(e){t.disableDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("驳回")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("理由：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:4},model:{value:t.rejectReason,callback:function(e){t.rejectReason=e},expression:"rejectReason"}})],1)]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("类别：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-radio-group",{model:{value:t.rejectValue,callback:function(e){t.rejectValue=e},expression:"rejectValue"}},t._l(t.rejectList,function(e){return a("el-radio",{key:e.id,attrs:{border:"",label:e.review_id}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.disableDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.rejectConfirm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.approveDialog,width:"470px","custom-class":"approveDialog"},on:{"update:visible":function(e){t.approveDialog=e}}},[a("span",{staticClass:"approveDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"approveDialog_main"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("div",{staticClass:"approveDialog_text"},[t._v("确认批准吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.approveDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.approveConfirm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.adaptDialog,width:"400px","custom-class":"adaptDialog"},on:{"update:visible":function(e){t.adaptDialog=e}}},[a("span",{staticClass:"adaptDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"adaptDialog_main"},[a("i",{staticClass:"iconfont icon-icon-test"}),t._v(" "),a("div",{staticClass:"adaptDialog_text"},[t._v("该商品适用于全部车型")])])]),t._v(" "),a("el-dialog",{attrs:{visible:t.brandDialog,width:"600px","custom-class":"brandDialog"},on:{"update:visible":function(e){t.brandDialog=e}}},[a("span",{staticClass:"brandDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"brandDialog_main"},[a("div",{staticClass:"brand_item"},[a("div",{staticClass:"brand_item_title"},[t._v("品牌选择")]),t._v(" "),a("div",{staticClass:"brand_item_list"},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(e){t.getBrandList(t.brandSelect,1)}},model:{value:t.brandSelect,callback:function(e){t.brandSelect=e},expression:"brandSelect"}},t._l(t.brandList,function(e){return a("el-radio",{key:e.brand_id,attrs:{label:e.brand_id,border:""}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),t.brandSelect?a("div",{staticClass:"brand_item"},[a("div",{staticClass:"brand_item_title"},[t._v("系列")]),t._v(" "),a("div",{staticClass:"brand_item_list"},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(e){t.getBrandList(t.seriesSelect,2)}},model:{value:t.seriesSelect,callback:function(e){t.seriesSelect=e},expression:"seriesSelect"}},t._l(t.seriesList,function(e){return a("el-radio",{key:e.series_id,attrs:{label:e.series_id,border:""}},[t._v(t._s(e.name))])}))],1)]):t._e(),t._v(" "),t.seriesSelect?a("div",{staticClass:"brand_item"},[a("div",{staticClass:"brand_item_title"},[t._v("配置")]),t._v(" "),a("div",{staticClass:"brand_item_list"},[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(e){t.getBrandList(t.configSelect,3)}},model:{value:t.configSelect,callback:function(e){t.configSelect=e},expression:"configSelect"}},t._l(t.configList,function(e){return a("el-radio",{key:e.config_id,attrs:{label:e.config_id,border:""}},[t._v(t._s(e.name))])}))],1)]):t._e(),t._v(" "),t.configSelect?a("div",{staticClass:"brand_item"},[a("div",{staticClass:"brand_item_title"},[t._v("年限")]),t._v(" "),a("div",{staticClass:"brand_item_list"},[a("el-checkbox-group",{attrs:{size:"mini"},model:{value:t.yearSelect,callback:function(e){t.yearSelect=e},expression:"yearSelect"}},t._l(t.yearList,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id,border:""}},[t._v(t._s(e.year))])}))],1)]):t._e(),t._v(" "),a("div",{staticClass:"brand_add_button"},[a("el-button",{attrs:{size:"mini",disabled:!t.configSelect},on:{click:t.addBrand}},[t._v("添加")])],1),t._v(" "),a("div",{staticClass:"brand_item"},[a("div",{staticClass:"brand_item_title"},[t._v("现有车系")]),t._v(" "),a("div",{staticClass:"brand_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.brandData,border:!0,size:"mini"}},[a("el-table-column",{attrs:{label:"车辆ID",align:"center",width:"90",prop:"id",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"品牌",align:"center",width:"90",prop:"brand_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"系列",align:"center",width:"90",prop:"series_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"配置",align:"center",width:"90",prop:"config_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"年限",align:"center",width:"90",prop:"year"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"mallReview_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"mallReview_btm"},[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.deleteBrand(e.row.id)}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),t.brandTotal?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.brandTotal,"page-size":t.brandPageSize},on:{"current-change":t.brandCurrentChange}}):t._e()],1)])])]),t._v(" "),a("DeleteModal",{ref:"delete",on:{doDelete:t.deleteConfirm}}),t._v(" "),a("DeleteModal",{ref:"deleteBrand",on:{doDelete:t.deleteBrandConfirm}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("商品审核")])])}]};var g=a("VU/8")(u,p,!1,function(t){a("0BAK")},null,null);e.default=g.exports}});