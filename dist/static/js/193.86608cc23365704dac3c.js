webpackJsonp([193],{"/byv":function(t,e){},JOAE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("lHA8"),s=a.n(i),o=a("Gu7T"),l=a.n(o),n=a("Dd8w"),r=a.n(n),c=a("mvHQ"),d=a.n(c),u=a("Xxa5"),v=a.n(u),p=a("exGp"),m=a.n(p),f=a("ZPfm"),_=a("+jNi"),b=a("QL8K"),g=a.n(b),h=new(a("GKmE").a),w={name:"AnswerManagement",components:{BreadCrumb:f.a,DeleteModal:_.a,app:g.a},data:function(){return{breadData:[{id:1,name:"问题",urls:"/index/question/question",icon:"icon-home"},{id:2,name:"回答管理",urls:"/index/question/answerManagement",icon:"icon-home"}],warmImg:a("GvV1"),app:g.a,searchObj:{},removeVisible:!1,modifyVisible:!1,rejectReason:"",tableData:[],modifyObj:{},approve:!0,approveDialog:!1,disableDialog:!1,viewDialog:!1,recoverDialog:!1,textarea:"",disableDialogRadio:"",pageSize:25,total:0,currentPage:1,avarageFont:0,number:0,plateList:[],images:[],dialogImageUrl:"",dialogVisible:!1,refuseList:[]}},created:function(){this.getTableList(),this.getRefuseList()},methods:{approveAnwser:function(t){this.modifyObj=t,this.approveDialog=!0},approveBtm:function(){var t=this;return m()(v.a.mark(function e(){var a,i,s,o,l;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={explain_id:t.modifyObj.explain_id,status:1},e.next=3,t.HttpClient.post("/admin/question/updateStatus",a);case 3:return i=e.sent,e.next=6,i.data;case 6:s=e.sent,o=s.code,l=s.msg,200===o?(t.$message.success(l),t.approveDialog=!1,setTimeout(function(){t.getTableList()},500)):t.$message.error(l);case 9:case"end":return e.stop()}},e,t)}))()},refuse:function(t){this.modifyObj=t,this.disableDialog=!0},disableBtm:function(){var t=this;return m()(v.a.mark(function e(){var a,i,s,o,l;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={explain_id:t.modifyObj.explain_id,status:3,review:t.rejectReason,review_id:t.disableDialogRadio.review_id,review_name:t.disableDialogRadio.name},e.next=3,t.HttpClient.post("/admin/question/updateStatus",a);case 3:return i=e.sent,e.next=6,i.data;case 6:s=e.sent,o=s.code,l=s.msg,200===o?(t.$message.success(l),t.disableDialog=!1,setTimeout(function(){t.getTableList()},500)):t.$message.error(l);case 9:case"end":return e.stop()}},e,t)}))()},getRefuseList:function(){var t=this;this.HttpClient.post("/admin/webReview/getList",{type:"comments"}).then(function(e){console.log("获取驳回列表:",e.data);var a=e.data,i=a.code,s=a.data;200===i&&(t.refuseList=s)})},recoverAnwser:function(t){this.modifyObj=t,this.recoverDialog=!0},recoverBtm:function(){var t=this,e={explain_id:this.modifyObj.explain_id,status:1};this.HttpClient.post("/admin/question/updateStatus",e).then(function(e){var a=e.data,i=a.code,s=a.msg;200===i?(t.$message.success(s),t.recoverDialog=!1,setTimeout(function(){t.getTableList()},500)):t.$message.error(s)})},modifyAnwser:function(t){this.modifyObj=t,this.modifyVisible=!0},modify:function(){var t=this;return m()(v.a.mark(function e(){var a,i,s;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.transferImage(t.images),i={explain_id:t.modifyObj.explain_id,content:t.modifyObj.content,attachment:a},e.next=4,t.HttpClient.post("/admin/question/updateAnswer",i);case 4:s=e.sent,h.getApiMessage(s),"200"==s.data.code&&(t.modifyVisible=!1,t.images=[]);case 7:case"end":return e.stop()}},e,t)}))()},uploadFile:function(t){var e=this;return m()(v.a.mark(function a(){var i;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.HttpClient.form("/admin/uploadOneImage",{images:t});case 2:i=a.sent,h.getApiMessage(i),e.images.push({name:t.name,url:i.data.path});case 5:case"end":return a.stop()}},a,e)}))()},modifyModal:function(t){this.modifyVisible=!0,this.modifyObj=t;var e=JSON.parse(d()(this.modifyObj.attachment));this.images=showPic(e),console.log("image:",this.images,this.modifyObj.attachment)},remove:function(){var t=this;return m()(v.a.mark(function e(){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.HttpClient.post("/admin/question/updateStatus",{explain_id:t.modifyObj.explain_id,status:0});case 2:a=e.sent,h.getApiMessage(a),"200"==a.data.code&&(t.removeVisible=!1);case 5:case"end":return e.stop()}},e,t)}))()},viewModal:function(t){this.viewDialog=!0,this.modifyObj=t},deleteModal:function(t){this.removeVisible=!0,this.modifyObj=t},currentChange:function(t){var e=this;return m()(v.a.mark(function a(){return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.currentPage=t;case 1:case"end":return a.stop()}},a,e)}))()},filterPlate:function(t,e,a){return e[a.property]===t},filterSecondary:function(t,e,a){return e[a.property]===t},handleRemove:function(t,e){console.log(t,e)},handlePictureCardPreview:function(t){console.log("start"),this.dialogImageUrl=t.url,this.dialogVisible=!0},viewPic:function(t){this.dialogImageUrl=t,this.dialogVisible=!0},getTableList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(v.a.mark(function a(){var i,s,o;return v.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=r()({size:25,order:1},e),a.next=3,t.HttpClient.post("/admin/question/getAnswer",i);case 3:return s=a.sent,a.next=6,s.data;case 6:200===(o=a.sent).code&&o.data.data.length?t.tableData=o.data.data:t.tableData=[];case 8:case"end":return a.stop()}},a,t)}))()},showPic:function(t){if(t&&t.length>0)for(var e in t)t[e].url=g.a.imageUrl+t[e].path;return t},transferImage:function(t){var e=JSON.parse(d()(t));if(e&&e.length>0)for(var a in e)e[a].path=e[a].url,delete e[a].url,delete e[a].uid,delete e[a].status;return e},dealWithTable:function(t){var e=[];if(t&&t.length>0)for(var a in t)"1"==t[a].status?t[a].passState="已通过":"2"!=t[a].status&&"3"!=t[a].status||(t[a].passState="未通过"),"1"==t[a].status||"3"==t[a].status?t[a].auditState="已审核":"2"==t[a].status&&(t[a].auditState="未审核"),t[a].menu&&e.push(t[a].menu);for(var i in e=[].concat(l()(new s.a(e))))e[i]={text:e[i],value:e[i]};return{table:t,plateList:e}},search:function(){}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"answerManagement"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"answer_main"},[t._m(0),t._v(" "),a("div",{staticClass:"answer_header"},[a("div",{staticClass:"answer_select"},[a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[t._v("开始")]),t._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期"},model:{value:t.searchObj.startTime,callback:function(e){t.$set(t.searchObj,"startTime",e)},expression:"searchObj.startTime"}})],1),t._v(" "),a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[t._v("截止")]),t._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期"},model:{value:t.searchObj.endTime,callback:function(e){t.$set(t.searchObj,"endTime",e)},expression:"searchObj.endTime"}})],1)]),t._v(" "),a("div",{staticClass:"answer_search"},[a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"题目搜索",clearable:""},model:{value:t.searchObj.topicSearch,callback:function(e){t.$set(t.searchObj,"topicSearch",e)},expression:"searchObj.topicSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){t.getTableList({title:t.searchObj.topicSearch})}},slot:"append"})],1)],1),t._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"昵称搜索",clearable:""},model:{value:t.searchObj.nickNameSearch,callback:function(e){t.$set(t.searchObj,"nickNameSearch",e)},expression:"searchObj.nickNameSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){t.getTableList({nickname:t.searchObj.nickNameSearch})}},slot:"append"})],1)],1)])]),t._v(" "),a("div",{staticClass:"p-0-25"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"ID",align:"center",width:"65",prop:"id",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"问题题目",align:"title",width:"120","show-overflow-tooltip":"",prop:"title"}}),t._v(" "),a("el-table-column",{attrs:{label:"回答内容",align:"center","show-overflow-tooltip":"",width:"150",prop:"content"}}),t._v(" "),a("el-table-column",{attrs:{label:"昵称",align:"center",width:"220",prop:"nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"所属板块",align:"center",width:"80",prop:"cate_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"字数",align:"center",prop:"word_num",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"150","show-overflow-tooltip":"",prop:"created_at",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"通过状态",align:"center",filters:[{text:"已通过",value:"已通过"},{text:"未通过",value:"未通过"}],"filter-method":t.filterSecondary,prop:"status",width:"125"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("el-tag",[t._v("删除")]):1===e.row.status?a("el-tag",[t._v("通过")]):2===e.row.status?a("el-tag",[t._v("待审核")]):a("el-tag",{attrs:{type:"danger"}},[t._v("未通过")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"审核状态",align:"center",filters:[{text:"已审核",value:1},{text:"未审核",value:2}],"filter-method":t.filterSecondary,prop:"status",width:"125"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("el-tag",[t._v("已审核")]):a("el-tag",{attrs:{type:"danger"}},[t._v("未审核")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200","class-name":"comment_scope",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"comment_btm"},[2==e.row.status?a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.approveAnwser(e.row)}}},[t._v("批准")]):3==e.row.status?a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.recoverAnwser(e.row)}}},[t._v("恢复")]):a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.refuse(e.row)}}},[t._v("驳回")]),t._v(" "),a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.deleteModal(e.row)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.modifyAnwser(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(a){t.viewModal(e.row)}}},[t._v("预览")])],1)]}}])})],1)],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.disableDialog},on:{"update:visible":function(e){t.disableDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("驳回\n    ")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("理由：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:4},model:{value:t.rejectReason,callback:function(e){t.rejectReason=e},expression:"rejectReason"}})],1)]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("类别：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-radio-group",{model:{value:t.disableDialogRadio,callback:function(e){t.disableDialogRadio=e},expression:"disableDialogRadio"}},t._l(t.refuseList,function(e){return a("el-radio",{key:e.review_id,attrs:{border:"",label:e}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.disableDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.disableBtm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.approveDialog,width:"470px","custom-class":"approveDialog"},on:{"update:visible":function(e){t.approveDialog=e}}},[a("span",{staticClass:"approveDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"approveDialog_main"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("div",{staticClass:"approveDialog_text"},[t._v("确认批准吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.approveDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.approveBtm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.recoverDialog,width:"470px","custom-class":"approveDialog"},on:{"update:visible":function(e){t.recoverDialog=e}}},[a("span",{staticClass:"approveDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"approveDialog_main"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("div",{staticClass:"approveDialog_text"},[t._v("确认恢复吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.approveDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.recoverBtm}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.removeVisible,width:"300px"},on:{"update:visible":function(e){t.removeVisible=e}}},[a("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"delete_icon"}),t._v(" "),a("span",[t._v("删除")])]),t._v(" "),a("div",[a("img",{staticClass:"boolean_delete",attrs:{src:t.warmImg}}),t._v(" "),a("p",[t._v("确定删除吗？")])]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-row",{staticClass:"row_e"},[a("el-button",{staticClass:"btn_deletes",attrs:{size:"small"},on:{click:function(e){t.removeVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"btn_delete",attrs:{type:"primary",size:"small"},on:{click:t.remove}},[t._v("提交")])],1)],1)]),t._v(" "),a("el-dialog",{attrs:{width:"500px","custom-class":"viewDialog",visible:t.viewDialog},on:{"update:visible":function(e){t.viewDialog=e}}},[a("span",{staticClass:"viewDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-chakan"}),t._v("预览\n    ")]),t._v(" "),a("div",{staticClass:"view_dialog_box"},[a("p",[t._v("评论内容：")]),t._v(" "),a("div",{staticClass:"view_content"},[t._v(t._s(t.modifyObj.content))]),t._v(" "),a("p",[t._v("附件：")]),t._v(" "),a("div",{staticClass:"view_upload"},t._l(t.modifyObj.attachment,function(e){return a("div",{key:e.path,staticClass:"view_upload_img",on:{click:function(a){t.viewPic(t.app.imageUrl+e.path)}}},[a("img",{attrs:{src:t.app.imageUrl+e.path,alt:""}})])}))])]),t._v(" "),a("el-dialog",{attrs:{width:"500px","custom-class":"viewDialog",visible:t.modifyVisible},on:{"update:visible":function(e){t.modifyVisible=e}}},[a("span",{staticClass:"viewDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-edit-square"}),t._v("修改\n    ")]),t._v(" "),a("div",{staticClass:"view_dialog_box"},[a("p",[t._v("评论内容：")]),t._v(" "),a("el-input",{staticClass:"modify_content",attrs:{type:"textarea",rows:"5"},model:{value:t.modifyObj.content,callback:function(e){t.$set(t.modifyObj,"content",e)},expression:"modifyObj.content"}}),t._v(" "),a("p",[t._v("附件：")]),t._v(" "),a("div",{staticClass:"view_upload"},[a("el-upload",{staticClass:"up_img_item",attrs:{action:"","list-type":"picture-card","file-list":t.images,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"before-upload":t.uploadFile,multiple:""}},[a("i",{staticClass:"el-icon-plus icon_plus"})])],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-row",{staticClass:"row_e"},[a("el-button",{staticClass:"btn_deletes",attrs:{size:"small"},on:{click:function(e){t.modifyVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"btn_delete",attrs:{type:"primary",size:"small"},on:{click:t.modify}},[t._v("提交")])],1)],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"answer_title"},[e("div",{staticClass:"title"},[this._v("回答管理")])])}]};var y=a("VU/8")(w,C,!1,function(t){a("/byv")},null,null);e.default=y.exports}});