webpackJsonp([252],{VaVC:function(t,e){},pW8w:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("ZPfm"),s=(new(a("GKmE").a),{name:"RefundOrder",components:{BreadCrumb:i.a},data:function(){return{breadData:[{id:1,name:"商城",urls:"/index/mall/mall/Mall",icon:"icon-home"},{id:2,name:"商城订单",urls:"/index/mallOrder/MallOrder",icon:"icon-home"},{id:3,name:"退货订单",urls:"/index/mallOrder/RefundOrder",icon:"icon-home"}],mallReviewSelect:null,plateList:[],modifyObj:{},total:0,pageSize:25,currentPage:1,cityId:null,folderId:null,buyerVisible:!1,buyerRemark:{},RefundReason:null,commodityId:null,num:null,UnitPrice:null,totalPrice:null,name:null,telphone:null,detail:null,tableData:[],refundReasonDialog:!1,logisticsDialog:!1,orderDetailsDialog:!1,RemarksDialog:!1,expressObj:{},detailObj:{},searchObj:{},remarkStr:"",remarkList:[],cityList:[],operationId:null}},created:function(){this.getPalteList(),this.getOrderList()},methods:{handleSearchId:function(){console.log(this.searchObj.merchantSearch),this.getOrderList()},handleSearchCompany:function(){console.log(this.searchObj.company),this.getOrderList()},handleSearchName:function(){console.log(this.searchObj.name),this.getOrderList()},handleBuyerRemark:function(t){var e=this;console.log(t),this.HttpClient.post("/admin/marketOrder/orderLog",{order_id:t.order_id}).then(function(t){200==t.data.code?(e.buyerRemark=t.data.data,e.buyerVisible=!0,console.log(e.buyerRemark)):e.$message.warning(t.data.msg)})},tt:function(t){console.log(this.searchObj.city),this.getOrderList()},handleEndTime:function(){console.log(this.searchObj.endTime),this.getOrderList()},handleStartTime:function(t){this.getOrderList()},getOrderList:function(){var t=this;this.HttpClient.post("/admin/marketOrder/refundOrderGoods",{start_time:this.searchObj.startTime,end_time:this.searchObj.endTime,nickname:this.searchObj.company,order_id:this.searchObj.merchantSearch,title:this.searchObj.name,city_id:this.searchObj.city,folder:this.folderId}).then(function(e){console.log(e),t.tableData=e.data.data.data,null===t.cityId&&t.getCityList()})},getCityList:function(){for(var t=[],e=0;e<this.tableData.length;e++)t.push({value:this.tableData[e].city_id,label:this.tableData[e].city_name});console.log(t),this.method1(t)},method1:function(t){for(var e=[],a=[],i=0;i<t.length;i++)-1===e.indexOf(t[i].value)&&(e.push(t[i].value),a.push(t[i]));console.log(e),console.log(a),this.cityList=a,console.log(this.cityList)},getPalteList:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:2,type:0,goods:!0}).then(function(e){console.log(e),t.plateList=e.data.data})},handleChengePlate:function(t){this.folderId=t,console.log(t),this.getOrderList()},handlePrimaryRemark:function(){var t=this;console.log(this.remarkStr),this.HttpClient.post("/admin/remarkLog/create",{content:this.remarkStr,source_id:this.operationId}).then(function(e){console.log(e),200===e.data.code&&(t.$message.success(e.data.msg),setTimeout(function(){t.getRemarkList(t.operationId),t.remarkStr=""},500))})},remarkModal:function(t){console.log(t),this.operationId=t.order_id,this.getRemarkList(t.order_id),this.RemarksDialog=!0},getRemarkList:function(t){var e=this;this.HttpClient.post("/admin/remarkLog/lists",{source_id:t}).then(function(t){console.log(t),e.remarkList=t.data.data.reverse()})},refundReasonModal:function(t){var e=this;this.HttpClient.post("/admin/marketOrder/refundInfo",{order_id:t.order_id}).then(function(t){var a=t.data,i=a.code,s=a.data.reason;e.RefundReason=200===i&&s?s:""}),this.refundReasonDialog=!0},orderDetailModal:function(t){var e=this;console.log(t),this.HttpClient.post("/admin/marketOrder/detailGoods",{id:t.id}).then(function(t){console.log(t),e.commodityId=t.data.data.product_id,e.telphone=t.data.data.telphone,e.detail=t.data.data.detail,e.name=t.data.data.conducts,e.num=t.data.data.quantity,e.UnitPrice=t.data.data.price,e.totalPrice=t.data.data.total_price}),this.orderDetailsDialog=!0},checkExpressModal:function(t){var e=this;console.log(t),this.HttpClient.post("/admin/getLogisticsInfo",{logisticcode:t.logistics_no,order_id:t.order_id,type:1}).then(function(t){console.log(t),e.expressObj.ShipperCode=t.data.data.ShipperName,e.expressObj.LogisticCode=t.data.data.LogisticCode,e.expressObj.Traces=t.data.data.Traces.reverse(),console.log(e.expressObj),e.logisticsDialog=!0})},checkProductionModal:function(t){window.open("http://frontend.kslab.com/home/productDetail?"+t.product_id,"_black")},currentChange:function(t){this.currentPage=t,this.search()}}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"RefundOrder"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"refundOrder_main"},[t._m(0),t._v(" "),a("div",{staticClass:"mallReview_select"},[a("el-radio-group",{model:{value:t.mallReviewSelect,callback:function(e){t.mallReviewSelect=e},expression:"mallReviewSelect"}},[a("el-radio",{attrs:{border:"",label:null}},[t._v("全部")]),t._v(" "),t._l(t.plateList,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.menu_id},on:{change:function(e){t.handleChengePlate(e)}}},[t._v(t._s(e.name))])})],2)],1),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content_header"},[a("div",{staticClass:"content_select"},[a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[t._v("开始")]),t._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",clearable:"",placeholder:"选择日期"},on:{change:function(e){t.handleStartTime(e)}},model:{value:t.searchObj.startTime,callback:function(e){t.$set(t.searchObj,"startTime",e)},expression:"searchObj.startTime"}})],1),t._v(" "),a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[t._v("截止")]),t._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",clearable:"",placeholder:"选择日期"},on:{change:function(e){t.handleEndTime(e)}},model:{value:t.searchObj.endTime,callback:function(e){t.$set(t.searchObj,"endTime",e)},expression:"searchObj.endTime"}})],1)]),t._v(" "),a("div",{staticClass:"content_search"},[a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"商家名称",clearable:""},model:{value:t.searchObj.company,callback:function(e){t.$set(t.searchObj,"company",e)},expression:"searchObj.company"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleSearchCompany},slot:"append"})],1)],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){t.tt(e)}},model:{value:t.searchObj.city,callback:function(e){t.$set(t.searchObj,"city",e)},expression:"searchObj.city"}},[a("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.cityList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})],2)],1),t._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"商品名称",clearable:""},model:{value:t.searchObj.name,callback:function(e){t.$set(t.searchObj,"name",e)},expression:"searchObj.name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleSearchName},slot:"append"})],1)],1),t._v(" "),a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"订单ID搜索",clearable:""},model:{value:t.searchObj.merchantSearch,callback:function(e){t.$set(t.searchObj,"merchantSearch",e)},expression:"searchObj.merchantSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleSearchId},slot:"append"})],1)],1)])]),t._v(" "),a("div",{staticClass:"content_main"},[a("div",{staticClass:"content_table"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"订单ID",align:"center",width:"150","show-overflow-tooltip":"",prop:"order_no",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"商品名称","show-overflow-tooltip":"",align:"center",width:"120",prop:"title"}}),t._v(" "),a("el-table-column",{attrs:{label:"卖家名称",align:"center",width:"200","show-overflow-tooltip":"",prop:"nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"订单时间",align:"center",width:"200","show-overflow-tooltip":"",prop:"created_at",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"目的城市",align:"center","show-overflow-tooltip":"",width:"100",prop:"city_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"退款时间",align:"center",width:"200","show-overflow-tooltip":"",prop:"refund_time",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"实退金额",align:"center",width:"130","show-overflow-tooltip":"",prop:"refund_price",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"350",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.checkProductionModal(e.row)}}},[t._v("查看商品")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.refundReasonModal(e.row)}}},[t._v("退款原因")]),t._v(" "),null!==e.row.logistics_no?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.checkExpressModal(e.row)}}},[t._v("查看物流")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.orderDetailModal(e.row)}}},[t._v("订单详情")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.remarkModal(e.row)}}},[t._v("备注")])]}}])})],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)])])]),t._v(" "),a("el-dialog",{attrs:{visible:t.refundReasonDialog,width:"470px","custom-class":"refundReasonDialog"},on:{"update:visible":function(e){t.refundReasonDialog=e}}},[a("span",{staticClass:"refundReasonDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-refund"}),t._v("退款原因")]),t._v(" "),a("div",{staticClass:"refundReasonDialog_main"},[a("div",{staticClass:"title"},[t._v("退款理由：")]),t._v(" "),a("div",{staticClass:"main_content",domProps:{innerHTML:t._s(t.RefundReason)}})]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.refundReasonDialog=!1}}},[t._v("关 闭")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.logisticsDialog,width:"500px","custom-class":"logisticsDialog"},on:{"update:visible":function(e){t.logisticsDialog=e}}},[a("span",{staticClass:"logisticsDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-wuliuxinxi"}),t._v("物流信息")]),t._v(" "),a("div",{staticClass:"logisticsDialog_main"},[a("div",{staticClass:"title"},[t._v("物流公司："),a("p",[t._v(t._s(t.expressObj.ShipperCode))])]),t._v(" "),a("div",{staticClass:"title"},[t._v("物流编号："),a("p",[t._v(t._s(t.expressObj.LogisticCode))])]),t._v(" "),a("div",{staticClass:"main_content"},t._l(t.expressObj.Traces,function(e,i){return a("div",{key:i,staticClass:"logisticsList"},[a("span",[t._v(t._s(e.AcceptTime))]),t._v(" "),a("p",[t._v(t._s(e.AcceptStation))])])}))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.logisticsDialog=!1}}},[t._v("关 闭")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.orderDetailsDialog,width:"470px","custom-class":"orderDetailsDialog"},on:{"update:visible":function(e){t.orderDetailsDialog=e}}},[a("span",{staticClass:"orderDetailsDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-wenjian"}),t._v("订单详情")]),t._v(" "),a("div",{staticClass:"orderDetailsDialog_main"},[a("div",{staticClass:"main_content"},[a("div",{staticClass:"content_list"},[a("div",{staticClass:"content_title"},[t._v("商品ID：")]),t._v(" "),a("div",{staticClass:"content_box"},[a("p",[t._v(t._s(t.commodityId))]),t._v(" "),a("div",{staticClass:"content_table"},[a("div",{staticClass:"table_list"},[a("p",[t._v("数量")]),t._v(" "),a("span",[t._v(t._s(t.num))])]),t._v(" "),a("div",{staticClass:"table_list"},[a("p",[t._v("单价")]),t._v(" "),a("span",[t._v(t._s(t.UnitPrice))])]),t._v(" "),a("div",{staticClass:"table_list"},[a("p",[t._v("总价")]),t._v(" "),a("span",[t._v(t._s(t.totalPrice))])])])])]),t._v(" "),a("div",{staticClass:"content_list"},[a("div",{staticClass:"content_title"},[t._v("姓名：")]),t._v(" "),a("div",{staticClass:"content_box"},[a("p",[t._v(t._s(t.name))])])]),t._v(" "),a("div",{staticClass:"content_list"},[a("div",{staticClass:"content_title"},[t._v("电话：")]),t._v(" "),a("div",{staticClass:"content_box"},[a("p",[t._v(t._s(t.telphone))])])]),t._v(" "),a("div",{staticClass:"content_list"},[a("div",{staticClass:"content_title"},[t._v("收货地址：")]),t._v(" "),a("div",{staticClass:"content_box"},[a("p",[t._v(t._s(t.detail))])])])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.orderDetailsDialog=!1}}},[t._v("关 闭")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.RemarksDialog,width:"470px","custom-class":"RemarksDialog"},on:{"update:visible":function(e){t.RemarksDialog=e}}},[a("span",{staticClass:"RemarksDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-edit-square"}),t._v("备注")]),t._v(" "),a("div",{staticClass:"RemarksDialog_main"},[a("div",{staticClass:"main_content"},[a("div",{staticClass:"main_content_list"},[a("div",{staticClass:"title"},[t._v("添加备注")]),t._v(" "),a("el-input",{attrs:{type:"textarea",rows:4,resize:"none"},model:{value:t.remarkStr,callback:function(e){t.remarkStr=e},expression:"remarkStr"}})],1),t._v(" "),a("div",{staticClass:"main_content_history"},[a("div",{staticClass:"title"},[t._v("历史")]),t._v(" "),a("div",{staticClass:"history_box"},t._l(t.remarkList,function(e,i){return a("div",{key:i,staticClass:"history_list"},[a("p",{staticClass:"userName"},[t._v(t._s(e.create_name)),a("span",[t._v(t._s(e.created_at))])]),t._v(" "),a("p",{staticClass:"content"},[t._v(t._s(e.content))])])}))])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.RemarksDialog=!1}}},[t._v("关 闭")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handlePrimaryRemark}},[t._v("提 交")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.buyerVisible,width:"470px","custom-class":"RemarksDialog"},on:{"update:visible":function(e){t.buyerVisible=e}}},[a("span",{staticClass:"RemarksDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-edit-square"}),t._v("买家备注")]),t._v(" "),a("div",{staticClass:"RemarksDialog_main"},[a("div",{staticClass:"main_content"},[a("div",{staticClass:"main_content_list"},[a("el-input",{attrs:{type:"textarea",rows:4,resize:"none"},model:{value:t.buyerRemark.content,callback:function(e){t.$set(t.buyerRemark,"content",e)},expression:"buyerRemark.content"}})],1)])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("退款订单")])])}]};var o=a("VU/8")(s,l,!1,function(t){a("VaVC")},null,null);e.default=o.exports}});