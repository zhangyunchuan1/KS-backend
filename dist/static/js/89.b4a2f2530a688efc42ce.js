webpackJsonp([89],{gw5V:function(e,s){},lNAJ:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={name:"InsideUserJurisdiction",components:{BreadCrumb:t("ZPfm").a},data:function(){return{user_info:null,user_name:"",status:1,checkedHasRole:[],breadData:[{id:1,name:"内部管理",urls:"/index",icon:"icon-home"},{id:2,name:"用户管理",urls:"/index/test",icon:"icon-home"},{id:3,name:"用户角色权限分配",urls:"/index/test",icon:"icon-home"}],old_array:[],allRole:[],hasRole:[],newAllRole:[]}},created:function(){this.getData()},methods:{changeAllCheck:function(e,s){var t=this;if(console.log(e,s,this.hasRole),!1===e)for(var a=0;a<this.hasRole.length;a++)this.checkedHasRole.push(this.hasRole[a].id);else this.HttpClient.post("/admin/roleuser/create",{user_id:this.select_userID,role_id:s}).then(function(e){if(console.log(e),200===e.data.code){t.$message.success(e.data.msg);for(var a=0;a<t.allRole.length;a++)t.allRole[a].id===s&&(console.log(t.allRole[a]),t.hasRole.push(t.allRole[a]),t.checkedHasRole.push(t.allRole[a]))}else t.$message.error(e.data.msg)})},changeHasCheck:function(e,s){var t=this;console.log(e,s,this.hasRole),this.HttpClient.post("/admin/roleuser/destroy",{user_id:this.select_userID,role_id:s}).then(function(e){if(console.log(e),200===e.data.code){t.$message.success(e.data.msg);for(var a=0;a<t.hasRole.length;a++)if(console.log(t.hasRole[a].id),t.hasRole[a].id===s){console.log(t.hasRole[a]),console.log(t.hasRole.indexOf(t.hasRole[a]));var l=t.hasRole.indexOf(t.hasRole[a]);t.hasRole.splice(l,1),t.checkedHasRole.splice(l,1)}}else{for(var o=0;o<t.hasRole.length;o++)t.checkedHasRole.push(t.hasRole[o].id);t.$message.error(e.data.msg)}})},getRoleList:function(){var e=this;this.HttpClient.post("/admin/role/getAll",{}).then(function(s){console.log(s);for(var t=0;t<s.data.data.length;t++)e.newAllRole.push({id:s.data.data[t].id,name:s.data.data[t].name});console.log(e.newAllRole),e.allRole=e.newAllRole})},handleStatus:function(){1===this.user_info.status?this.user_info.status=2:2===this.user_info.status&&(this.user_info.status=1),console.log(this.user_info.status)},handleCheckAllChange:function(){},handleCheckedRoleChange:function(e){console.log(e)},getData:function(){this.user_info=this.$route.query.info,console.log(this.user_info),this.select_userID=this.user_info.id,this.hasRole=this.user_info.roles,this.getRoleList();for(var e=0;e<this.hasRole.length;e++)this.checkedHasRole.push(this.hasRole[e].id);console.log(this.checkedHasRole)}}},l={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"insideUserJurisdiction"},[t("BreadCrumb",{staticClass:"bread",attrs:{breadData:e.breadData}}),e._v(" "),t("div",{staticClass:"content"},[t("p",{staticClass:"title"},[e._v("用户角色分配")]),e._v(" "),t("div",{staticClass:"conditions"},[t("div",{staticClass:"condition"},[t("p",{staticClass:"user_name"},[e._v("姓名: "),t("span",[e._v(e._s(e.user_info.nickname))])]),e._v(" "),t("p",{staticClass:"user_status"},[e._v("状态:")]),e._v(" "),t("p",{staticClass:"user_enable",style:2===e.user_info.status?{background:"#ff5858"}:{},on:{click:e.handleStatus}},[e._v(e._s(1===e.user_info.status?"启用":"禁用"))])])]),e._v(" "),t("div",{staticClass:"user_edit_content"},[t("div",{staticClass:"content_left"},[t("p",{staticClass:"left_title"},[e._v("所有角色")]),e._v(" "),t("div",{staticClass:"all_role"},[t("el-checkbox-group",{staticClass:"checkbox_all",on:{change:e.handleCheckedRoleChange},model:{value:e.checkedHasRole,callback:function(s){e.checkedHasRole=s},expression:"checkedHasRole"}},e._l(e.allRole,function(s){return t("el-checkbox",{key:s.id,staticClass:"checkbox_all_item",attrs:{label:s.id},on:{change:function(t){e.changeAllCheck(t,s.id)}}},[e._v(e._s(s.name))])}))],1)]),e._v(" "),t("div",{staticClass:"content_right"},[t("p",{staticClass:"right_title"},[e._v("已拥有角色")]),e._v(" "),t("div",{staticClass:"has_role"},[t("el-checkbox-group",{staticClass:"checkbox_all",on:{change:e.handleCheckedRoleChange},model:{value:e.checkedHasRole,callback:function(s){e.checkedHasRole=s},expression:"checkedHasRole"}},e._l(e.hasRole,function(s){return t("el-checkbox",{key:s.id,staticClass:"checkbox_all_item",attrs:{label:s.id},on:{change:function(t){e.changeHasCheck(t,s.id)}}},[e._v(e._s(s.name))])}))],1)])]),e._v(" "),t("div",{staticClass:"btn_group"},[t("el-button",{attrs:{size:"mini"}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{size:"mini",type:"primary"}},[e._v("确定")])],1)])],1)},staticRenderFns:[]};var o=t("VU/8")(a,l,!1,function(e){t("gw5V")},"data-v-76774dee",null);s.default=o.exports}});