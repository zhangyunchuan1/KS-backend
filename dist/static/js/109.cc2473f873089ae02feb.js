webpackJsonp([109],{"l//x":function(t,e){},"tY+Y":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("ZPfm"),o=a("+jNi"),l={name:"ArticleManagement",components:{BreadCrumb:i.a,ModalDelete:o.a},data:function(){return{breadData:[{id:1,name:"文章管理",urls:"/index/article/Article",icon:"icon-home"},{id:2,name:"文章管理",urls:"/index/article/ArticleManagement",icon:"icon-home"}],userOptions:[{value:1,label:"公司"},{value:2,label:"普通用户"}],contentTime:"",contentData:[],approveDialog:!1,disableDialog:!1,rejectReason:"",disableDialogRadio:"",disableDialogList:"",modalDelete:!1,username:"",nickname:"",currentPage:1,pageSize:25,total:0,wordAverage:0,id:""}},methods:{formatter:function(t,e){return t.address},filterHandler:function(t,e,a){return e[a.property]===t},tableRowClassName:function(t){var e=t.row;return 1===e.status?"success":2===e.status?"wait":3===e.status?"error":""},getArticleList:function(){var t=this,e={page:this.currentPage,size:this.pageSize};this.nickname&&(e.nickname=this.nickname),this.username&&(e.username=this.username),this.contentTime.length>0&&(e.start_time=this.contentTime[0],e.end_time=this.contentTime[1]),this.HttpClient.post("/admin/article/getList",e).then(function(e){console.log(e),200===e.data.code&&(t.contentData=e.data.data.data)})},getArticleWord:function(){var t=this;this.HttpClient.post("/admin/article/getTotalAndAverageWord").then(function(e){console.log(e),200===e.data.code&&(t.total=e.data.data.total,t.wordAverage=e.data.data.total_word/e.data.data.total)})},updateButton:function(t,e){this.$router.push({path:"/index/article/article-modify",query:{id:t,articleId:e}})},agreeButton:function(t){this.id=t,this.approveDialog=!0},rejectButton:function(t){var e=this;console.log(t),this.id=t.article_id;this.HttpClient.post("/admin/webReview/getList",{type:"upload"}).then(function(t){console.log(t.data),200===t.data.code&&(e.disableDialogList=t.data.data)}),this.disableDialog=!0},deleteButton:function(t){this.id=t,this.$refs.delete.deleteDialog=!0},makeArticle:function(t){var e=this,a={article_id:this.id,status:t};console.log(this.disableDialogRadio),3===t&&(a.refuse=this.rejectReason,a.review_id=this.disableDialogRadio),this.HttpClient.post("/admin/article/changeStatus",a).then(function(t){console.log(t),200===t.data.code?(e.$message.success("操作成功"),setTimeout(function(){e.getArticleList()},500)):e.$message.error("操作失败")})},confirmAgree:function(){this.makeArticle(1),this.approveDialog=!1},confirmReject:function(){this.makeArticle(3),this.disableDialog=!1},confirmDelete:function(){this.makeArticle(0)},currentChange:function(t){this.currentPage=t,this.getArticleList()}},created:function(){this.getArticleList(),this.getArticleWord()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"articleManagement"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"articleManagement_main"},[t._m(0),t._v(" "),a("div",{staticClass:"articleManagement_content"},[a("div",{staticClass:"articleManagement_table"},[a("form",[a("div",{staticClass:"content_header"},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.getArticleList},model:{value:t.contentTime,callback:function(e){t.contentTime=e},expression:"contentTime"}}),t._v(" "),a("div",{staticClass:"content_header_search"},[a("el-input",{attrs:{placeholder:"用户昵称"},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getArticleList(e):null}},model:{value:t.nickname,callback:function(e){t.nickname=e},expression:"nickname"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getArticleList},slot:"append"})],1),t._v(" "),a("el-input",{attrs:{placeholder:"名称"},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.getArticleList(e):null}},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getArticleList},slot:"append"})],1)],1)],1),t._v(" "),a("div",{staticClass:"content_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contentData,border:""}},[a("el-table-column",{attrs:{prop:"id",sortable:"",width:"80px",align:"center",label:"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",width:"150px","show-overflow-tooltip":"",align:"center",label:"文章标题"}}),t._v(" "),a("el-table-column",{attrs:{prop:"nickname",width:"150px","show-overflow-tooltip":"",align:"center",label:"昵称"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.nickname?a("span",[t._v(t._s(e.row.nickname))]):a("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"word_num",width:"110px","show-overflow-tooltip":"",align:"center",label:"字数"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.word_num?a("span",[t._v(t._s(e.row.word_num))]):a("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"cate_name",width:"150px","show-overflow-tooltip":"",align:"center",label:"所属板块",filters:[{text:"汽车",value:"汽车"},{text:"摩托车",value:"摩托车"},{text:"模型",value:"模型"},{text:"智能设备",value:"智能设备"}],"filter-method":t.filterHandler}}),t._v(" "),a("el-table-column",{attrs:{prop:"user_type",width:"120px","show-overflow-tooltip":"",align:"center",label:"用户类别",filters:[{text:"专业商家",value:2},{text:"普通用户",value:1},{text:"普通商家",value:3}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(2===e.row.user_type?"专业商家":1===e.row.user_type?"普通用户":"普通商家"))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"is_course",width:"120px","show-overflow-tooltip":"",align:"center",label:"文章类别",filters:[{text:"教程",value:1},{text:"普通",value:0}],"filter-method":t.filterHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(1===e.row.is_course?"教程":"普通"))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",width:"160px","show-overflow-tooltip":"",align:"center",sortable:"",label:"创建时间"}}),t._v(" "),a("el-table-column",{attrs:{width:"120px",align:"center","show-overflow-tooltip":"",label:"通过状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{class:1===e.row.status||4===e.row.status?"normal_color":"notpass_color"},[t._v(t._s(1===e.row.status||4===e.row.status?"已通过":"未通过"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"review",width:"120px","show-overflow-tooltip":"",align:"center",label:"审核状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{class:2===e.row.status?"audit_color":"wait_color"},[t._v(t._s(2===e.row.status?"未审核":"已审核"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1!==e.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.agreeButton(e.row.article_id)}}},[t._v("批准")]):t._e(),t._v(" "),3!==e.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.rejectButton(e.row)}}},[t._v("驳回")]):t._e(),t._v(" "),1!==e.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.updateButton(e.row.id,e.row.article_id)}}},[t._v("修改")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"}},[t._v("预览")]),t._v(" "),3===e.row.status?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.deleteButton(e.row.article_id)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)])])])]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"approveDialog",visible:t.approveDialog,center:""},on:{"update:visible":function(e){t.approveDialog=e}}},[a("span",{staticClass:"approveDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),a("div",{staticClass:"approveDialog_box"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("p",[t._v("确定批准吗？")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.approveDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmAgree}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"470px","custom-class":"disableDialog",visible:t.disableDialog},on:{"update:visible":function(e){t.disableDialog=e}}},[a("span",{staticClass:"disableDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jinyong"}),t._v("驳回")]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("理由：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},[a("el-input",{attrs:{type:"textarea",resize:"none",rows:4},model:{value:t.rejectReason,callback:function(e){t.rejectReason=e},expression:"rejectReason"}})],1)]),t._v(" "),a("div",{staticClass:"disable_dialog_box"},[a("div",{staticClass:"disable_dialog_left"},[t._v("类别：")]),t._v(" "),a("div",{staticClass:"disable_dialog_right"},t._l(t.disableDialogList,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.review_id},model:{value:t.disableDialogRadio,callback:function(e){t.disableDialogRadio=e},expression:"disableDialogRadio"}},[t._v(t._s(e.name))])}))]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.disableDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmReject}},[t._v("确 定")])],1)]),t._v(" "),a("ModalDelete",{ref:"delete",on:{doDelete:t.confirmDelete}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[this._v("文章管理")]),this._v(" "),e("div",{staticClass:"refresh"},[e("i",{staticClass:"iconfont icon-shuaxin"}),e("span",[this._v("刷新")])])])}]};var s=a("VU/8")(l,n,!1,function(t){a("l//x")},null,null);e.default=s.exports}});