webpackJsonp([139],{"2DL7":function(e,t){},UuTf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),i=n.n(a),s=n("exGp"),r=n.n(s),l=n("ZPfm"),o=n("+jNi"),c=new(n("GKmE").a),d={name:"EncyclopediaContents",components:{BreadCrumb:l.a,DeleteModal:o.a},data:function(){return{breadData:[{id:1,name:"百科",urls:"/index/encyclopedia/encyclopedia",icon:"icon-home"},{id:2,name:"目录分配情况",urls:"/index/encyclopedia/encyclopediaContents",icon:"icon-home"}],warmImg:n("GvV1"),searchObj:{},modifyObj:{},removeVisible:!1,currentPage:1,pageSize:25,total:0,sectorSelection:"",firstLevel:null,secondary:null,thirdLevel:null,menuList:[],firstMenuList:[],secondMenuList:[],threeMenuList:[],muneIdObj:{muneId:"",id:0},firstMuneIdObj:{firstMuneId:"",id:0},secondMuneIdObj:{secondMuneId:"",id:0},threeMuneIdObj:{threeMuneId:"",id:0},viewFirstLevel:!1,viewSecondary:!1,viewThirdLevel:!1,tableData:[]}},created:function(){this.getTableList(null),this.getModelList()},methods:{handleChangeStartTime:function(){console.log(this.searchObj.startTime),this.getTableList(this.searchObj)},handleChangeEndTime:function(){console.log(this.searchObj.endTime),this.getTableList(this.searchObj)},cloneContents:function(){this.viewFirstLevel=!1,this.viewSecondary=!1,this.viewThirdLevel=!1},filterPlate:function(e,t,n){return t[n.property]===e},filterSecondary:function(e,t,n){return t[n.property]===e},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},removeModal:function(e){this.removeVisible=!0,this.modifyObj=e,console.log("modifyObj:",this.modifyObj)},search:function(){this.getTableList(this.searchObj),console.log("searchObj:",this.searchObj)},remove:function(){var e=this;return r()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.modifyObj),t.next=3,e.HttpClient.post("/admin/menuRelationship/destroy",{menu_id:e.modifyObj.menu_id,relation_id:e.modifyObj.encyclopedia_id});case 3:n=t.sent,c.getApiMessage(n),e.removeVisible=!1,setTimeout(function(){e.search()},500);case 7:case"end":return t.stop()}},t,e)}))()},currentChange:function(e){var t=this;return r()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.currentPage=e,t.search();case 2:case"end":return n.stop()}},n,t)}))()},changeModel:function(e){var t=this;return r()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("menu"!==e){n.next=9;break}return t.viewFirstLevel=!0,console.log(t.sectorSelection),t.searchObj.menu_id=t.sectorSelection.menu_id,t.search(),n.next=7,t.getFirstMenuList();case 7:n.next=28;break;case 9:if("firstMenu"!==e){n.next=18;break}return t.viewSecondary=!0,console.log(t.firstLevel),t.searchObj.menu_id=t.firstLevel.menu_id,t.search(),n.next=16,t.getSecondMenuList();case 16:n.next=28;break;case 18:if("secondMenu"!==e){n.next=27;break}return console.log(t.secondary),t.searchObj.menu_id=t.secondary.menu_id,t.search(),t.viewThirdLevel=!0,n.next=25,t.getThreeMenuList();case 25:n.next=28;break;case 27:"threeMenu"===e&&(console.log(t.thirdLevel),t.searchObj.menu_id=t.thirdLevel.menu_id,t.search());case 28:console.log("sectorSelection:",t.sectorSelection);case 29:case"end":return n.stop()}},n,t)}))()},getTableList:function(e){var t=this;return r()(i.a.mark(function n(){var a,s;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a={page:t.currentPage},e&&(a.start_time=e.startTime,a.end_time=e.endTime,a.id=e.idSearch,a.title=e.titleSearch,a.menu_id=e.menu_id),n.next=4,t.HttpClient.post("/admin/encyclopedias/getListByMajorMenuId",a);case 4:s=n.sent,t.tableData=u(s.data.data.data),console.log("tableData:",t.tableData),t.total=s.data.data.total;case 8:case"end":return n.stop()}},n,t)}))()},getModelList:function(){var e=this;return r()(i.a.mark(function t(){var n,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.HttpClient.post("/admin/menu/getList",{menu_type:3});case 2:n=t.sent,a=v(n.data.data),e.menuList=a.menuList,e.menuList[0]&&(e.muneId=e.menuList[0].menu_id,e.pid=e.muneId);case 6:case"end":return t.stop()}},t,e)}))()},getFirstMenuList:function(){var e=this;return r()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.HttpClient.post("/admin/menu/getOneChild",{menu_id:e.sectorSelection.menu_id,menu_type:3});case 2:n=t.sent,e.firstMenuList=n.data.data.child,e.secondMenuList=[],e.threeMenuList=[];case 6:case"end":return t.stop()}},t,e)}))()},getSecondMenuList:function(){var e=this;return r()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.HttpClient.post("/admin/menu/getOneChild",{menu_id:e.firstLevel.menu_id,menu_type:3});case 2:n=t.sent,e.secondMenuList=n.data.data.child,e.threeMenuList=[];case 5:case"end":return t.stop()}},t,e)}))()},getThreeMenuList:function(){var e=this;return r()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.HttpClient.post("/admin/menu/getOneChild",{menu_id:e.secondary.menu_id,menu_type:3});case 2:n=t.sent,e.threeMenuList=n.data.data.child;case 4:case"end":return t.stop()}},t,e)}))()}}};function u(e){var t=[];if(e&&e.length>0)for(var n in e){var a=e[n];if(a.model="",a.firstMenu="",a.secondMenu="",a.threeMenu="",a.menu&&a.menu.length>0)for(var i in a.menu)"0"==a.menu[i].type?a.model=a.menu[i].name:"1"==a.menu[i].type?""==a.firstMenu&&(a.firstMenu=a.menu[i].name):"2"==a.menu[i].type?""==a.secondMenu&&(a.secondMenu=a.menu[i].name):"3"==a.menu[i].type&&""==a.threeMenu&&(a.threeMenu=a.menu[i].name);t.push(a)}return t}function v(e){var t=[{name:"全部",id:0,menu_id:0}];if(e)for(var n in e)"0"==e[n].type&&t.push(e[n]);return{menuList:t}}var h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"encyclopediaContents"},[n("BreadCrumb",{staticClass:"bread",attrs:{breadData:e.breadData}}),e._v(" "),n("div",{staticClass:"encyclopedia_main"},[e._m(0),e._v(" "),n("div",{staticClass:"encyclopedia_box"},[n("div",{staticClass:"encyclopedia_header"},[n("el-radio-group",{model:{value:e.sectorSelection,callback:function(t){e.sectorSelection=t},expression:"sectorSelection"}},e._l(e.menuList,function(t){return n("el-radio",{key:t.id,attrs:{label:t},on:{change:function(t){e.changeModel("menu")}}},[e._v(e._s(t.name))])}))],1),e._v(" "),n("div",{staticClass:"encyclopedia_content"},[n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewFirstLevel,expression:"viewFirstLevel"}],staticClass:"encyclopedia_list"},[n("div",{staticClass:"encyclopedia_list_box"},[n("div",{staticClass:"encyclopedia_list_title"},[e._v("一级目录")]),e._v(" "),n("el-radio-group",{model:{value:e.firstLevel,callback:function(t){e.firstLevel=t},expression:"firstLevel"}},e._l(e.firstMenuList,function(t){return n("el-radio",{key:t.id,attrs:{label:t},on:{change:function(t){e.changeModel("firstMenu")}}},[e._v(e._s(t.name))])}))],1)])]),e._v(" "),n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewSecondary,expression:"viewSecondary"}],staticClass:"encyclopedia_list"},[n("div",{staticClass:"encyclopedia_list_box"},[n("div",{staticClass:"encyclopedia_list_title"},[e._v("二级目录")]),e._v(" "),n("el-radio-group",{model:{value:e.secondary,callback:function(t){e.secondary=t},expression:"secondary"}},e._l(e.secondMenuList,function(t){return n("el-radio",{key:t.id,attrs:{label:t},on:{change:function(t){e.changeModel("secondMenu")}}},[e._v(e._s(t.name))])}))],1)])]),e._v(" "),n("el-collapse-transition",[n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewThirdLevel,expression:"viewThirdLevel"}],staticClass:"encyclopedia_list"},[n("div",{staticClass:"encyclopedia_list_box"},[n("div",{staticClass:"encyclopedia_list_title"},[e._v("三级目录")]),e._v(" "),n("el-radio-group",{model:{value:e.thirdLevel,callback:function(t){e.thirdLevel=t},expression:"thirdLevel"}},e._l(e.threeMenuList,function(t){return n("el-radio",{key:t.id,attrs:{label:t},on:{change:function(t){e.changeModel("threeMenu")}}},[e._v(e._s(t.name))])}))],1)])])],1)]),e._v(" "),n("div",{staticClass:"encyclopedia_table"},[n("div",{staticClass:"encyclopedia_header"},[n("div",{staticClass:"encyclopedia_left"},[n("div",{staticClass:"encyclopedia_list_num"},[e._v("当前目录下总数： "+e._s(e.total))]),e._v(" "),n("div",{staticClass:"encyclopedia_left_time"},[n("div",{staticClass:"date_item"},[n("p",{staticClass:"date_label"},[e._v("开始")]),e._v(" "),n("el-date-picker",{attrs:{type:"date",size:"mini",placeholder:"选择开始日期"},on:{change:e.handleChangeStartTime},model:{value:e.searchObj.startTime,callback:function(t){e.$set(e.searchObj,"startTime",t)},expression:"searchObj.startTime"}})],1),e._v(" "),n("div",{staticClass:"date_item"},[n("p",{staticClass:"date_label"},[e._v("截止")]),e._v(" "),n("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择截止日期"},on:{change:e.handleChangeEndTime},model:{value:e.searchObj.endTime,callback:function(t){e.$set(e.searchObj,"endTime",t)},expression:"searchObj.endTime"}})],1)])]),e._v(" "),n("div",{staticClass:"encyclopedia_search"},[n("div",[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"百科题目搜索"},model:{value:e.searchObj.titleSearch,callback:function(t){e.$set(e.searchObj,"titleSearch",t)},expression:"searchObj.titleSearch"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1),e._v(" "),n("div",[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"百科ID搜索"},model:{value:e.searchObj.idSearch,callback:function(t){e.$set(e.searchObj,"idSearch",t)},expression:"searchObj.idSearch"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)])]),e._v(" "),n("div",{staticClass:"encyclopedia_content"},[n("el-table",{attrs:{data:e.tableData,border:!0}},[n("el-table-column",{attrs:{label:"ID",align:"center",width:"100",prop:"id",sortable:"","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"百科题目",align:"center","show-overflow-tooltip":"",width:"180",prop:"title"}}),e._v(" "),n("el-table-column",{attrs:{label:"学科板块",align:"center","show-overflow-tooltip":"",width:"110",prop:"model"}}),e._v(" "),n("el-table-column",{attrs:{label:"一级目录",align:"center","show-overflow-tooltip":"",width:"130",prop:"firstMenu"}}),e._v(" "),n("el-table-column",{attrs:{label:"二级目录",align:"center","show-overflow-tooltip":"",width:"130",prop:"secondMenu"}}),e._v(" "),n("el-table-column",{attrs:{label:"三级目录",align:"center","show-overflow-tooltip":"",width:"130",prop:"threeMenu"}}),e._v(" "),n("el-table-column",{attrs:{label:"分配时间",align:"center","show-overflow-tooltip":"",width:"180",prop:"created_at",sortable:""}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center","class-name":"encyclopedia_scope"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"encyclopedia_btm"},[n("el-button",{attrs:{size:"medium ",type:"text"},on:{click:function(n){e.removeModal(t.row)}}},[e._v("删除")]),e._v(" "),n("el-button",{attrs:{size:"medium ",type:"text"}},[e._v("预览")])],1)]}}])})],1),e._v(" "),e.total?n("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total,"page-size":e.pageSize},on:{"current-change":e.currentChange}}):e._e()],1)])]),e._v(" "),n("el-dialog",{attrs:{visible:e.removeVisible,width:"300px"},on:{"update:visible":function(t){e.removeVisible=t}}},[n("div",{staticClass:"dialog_delete_head_title",attrs:{slot:"title"},slot:"title"},[n("i",{staticClass:"delete_icon"}),e._v(" "),n("span",[e._v("删除")])]),e._v(" "),n("div",[n("img",{staticClass:"boolean_delete",attrs:{src:e.warmImg}}),e._v(" "),n("p",[e._v("确定删除吗？")])]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-row",{staticClass:"row_e"},[n("el-button",{staticClass:"btn_deletes",attrs:{size:"small"},on:{click:function(t){e.removeVisible=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{staticClass:"btn_delete",attrs:{type:"primary",size:"small"},on:{click:e.remove}},[e._v("提交")])],1)],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"encyclopedia_title"},[t("div",{staticClass:"title"},[this._v("目录分配情况")])])}]};var m=n("VU/8")(d,h,!1,function(e){n("2DL7")},null,null);t.default=m.exports}});