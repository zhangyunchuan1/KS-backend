webpackJsonp([53],{njCH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("bOdI"),l=a.n(i),o={name:"VideoDistribution",components:{BreadCrumb:a("ZPfm").a},data:function(){var t;return t={breadData:[{id:1,name:"视频",urls:"/index/video/video",icon:"icon-home"},{id:2,name:"专业目录分配",urls:"/index/video/videoDistribution",icon:"icon-home"}],startTime:"",endTime:"",topicSearch:"",disableDialogRadio:null,tableData:[],addDirectoryDialog:!1,subject:1,firstLevel:1,secondary:1,thirdLevel:1,fourthLevel:1,allDirectoryDialog:!1,carSelect:1,engineeringSelect:1,controlSelect:1},l()(t,"startTime",null),l()(t,"endTime",null),l()(t,"title",null),l()(t,"subjectData",[]),l()(t,"oneCatalog",[]),l()(t,"twoCatalog",[]),l()(t,"threeCatalog",[]),l()(t,"fourCatalog",[]),l()(t,"fiveCatalog",[]),l()(t,"disableDialogRadio1",null),l()(t,"disableDialogRadio2",null),l()(t,"disableDialogRadio3",null),l()(t,"disableDialogRadio4",null),l()(t,"menuId",null),l()(t,"videoId",null),l()(t,"menu",[]),l()(t,"addId",null),l()(t,"pageSize",25),l()(t,"total",0),l()(t,"currentPage",1),t},mounted:function(){this.getPassQuestionList(this.startTime,this.endTime,this.title)},methods:{handleOpenAll:function(t){console.log(t),this.menu=t,this.allDirectoryDialog=!0},handleAddCatalog:function(){var t=this;console.log(this.addId,this.videoId),this.HttpClient.post("/admin/menuRelationship/create",{menu_id:this.addId,relation_id:this.videoId,type:1,relation_type:2}).then(function(e){console.log(e),200===e.data.code?(t.$message.success(e.data.msg),setTimeout(function(){t.getPassQuestionList(t.startTime,t.endTime,t.title),t.addDirectoryDialog=!1,console.log("eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee")},800)):t.$message.error(e.data.msg)})},qq:function(t){console.log(t),this.menuId=t.menu_id,1===t.type&&(this.twoCatalog=[],this.threeCatalog=[],this.fourCatalog=[]),2===t.type&&(this.threeCatalog=[],this.fourCatalog=[]),3===t.type&&(this.fourCatalog=[]),4===t.type&&console.log("点击了4及"),this.getNextCatalog(t.menu_id,t.type)},tt:function(t){this.oneCatalog=[],this.twoCatalog=[],this.threeCatalog=[],this.fourCatalog=[],console.log(t),this.getChildeCatalogList(t.menu_id)},handleOpenAddCatalog:function(t){this.videoId=t,this.getSubjectCatalog(),this.addDirectoryDialog=!0},getNextCatalog:function(t,e){var a=this;this.HttpClient.post("/admin/menu/getOneChild",{menu_id:t,menu_type:3}).then(function(i){console.log(i),200===i.data.code&&(1===e?(a.twoCatalog=i.data.data.child,a.addId=t):2===e?(a.addId=t,a.threeCatalog=i.data.data.child):3===e?(a.addId=t,a.fourCatalog=i.data.data.child):4===e&&(a.addId=t,a.fiveCatalog=i.data.data.child))})},getChildeCatalogList:function(t){var e=this;this.HttpClient.post("/admin/menu/getOneChild",{menu_id:t,menu_type:3}).then(function(t){console.log(t);for(var a=0;a<t.data.data.child.length;a++)1===t.data.data.child[a].type?e.oneCatalog.push(t.data.data.child[a]):2===t.data.data.child[a].type?e.twoCatalog.push(t.data.data.child[a]):3===t.data.data.child[a].type&&e.threeCatalog.push(t.data.data.child[a]);console.log(e.oneCatalog,e.twoCatalog,e.threeCatalog)})},getSubjectCatalog:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:3}).then(function(e){console.log(e),t.subjectData=e.data.data})},getPassQuestionList:function(t,e,a){var i=this;this.HttpClient.post("/admin/videos/getListWithMajorMenu",{status:1,start_time:t,end_time:e,title:a,size:this.pageSize,page:this.currentPage}).then(function(t){console.log(t),i.tableData=t.data.data.data,i.total=t.data.data.total;for(var e=0;e<t.data.data.data.length;e++)if(0!==t.data.data.data[e].menu.length)for(var a=0;a<t.data.data.data[e].menu[0].length;a++){console.log(t.data.data.data[e].menu[0].length),console.log(t.data.data.data[e].menu[0][a]);var l=t.data.data.data[e].menu[0][a].type;0==l&&(i.tableData[e].subject=t.data.data.data[e].menu[0][a].name),1==l&&(i.tableData[e].menu_1=t.data.data.data[e].menu[0][a].name),2==l&&(i.tableData[e].menu_2=t.data.data.data[e].menu[0][a].name),3==l&&(i.tableData[e].menu_3=t.data.data.data[e].menu[0][a].name),4==l&&(i.tableData[e].menu_4=t.data.data.data[e].menu[0][a].name)}})},currentChange:function(t){this.currentPage=t,this.getPassQuestionList()},handleChangeTitle:function(){""===this.topicSearch?this.title=null:this.title=this.topicSearch,this.title=this.topicSearch},handleTitleSearch:function(){this.getPassQuestionList(this.startTime,this.endTime,this.title)},handleStartTime:function(t){this.getPassQuestionList(this.startTime,this.endTime,this.title)},handleEndTime:function(t){this.getPassQuestionList(this.startTime,this.endTime,this.title)},filterPlate:function(t,e,a){return e[a.property]===t},filterSecondary:function(t,e,a){return e[a.property]===t},handleRemove:function(t,e){console.log(t,e)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"questionDistributionc"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"question_main"},[t._m(0),t._v(" "),a("div",{staticClass:"question_header"},[a("div",{staticClass:"question_select"},[a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[t._v("开始")]),t._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期"},on:{change:t.handleStartTime},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}})],1),t._v(" "),a("div",{staticClass:"date_item"},[a("p",{staticClass:"date_label"},[t._v("截止")]),t._v(" "),a("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期"},on:{change:t.handleEndTime},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1)]),t._v(" "),a("div",{staticClass:"question_search"},[a("div",[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"题目搜索"},on:{change:t.handleChangeTitle},model:{value:t.topicSearch,callback:function(e){t.topicSearch=e},expression:"topicSearch"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleTitleSearch},slot:"append"})],1)],1)])]),t._v(" "),a("div",{staticClass:"question_content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"ID",align:"center",width:"65",prop:"id",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"视频题目",align:"center",prop:"title",width:"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"所属板块",align:"center",width:"110","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.category))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"是否分配",align:"center",filters:[{text:"已分配",value:1},{text:"未分配",value:0}],"filter-method":t.filterSecondary,prop:"menu.length",width:"130","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.menu.length>0?a("span",[t._v("已分配")]):t._e(),t._v(" "),0==e.row.menu.length?a("span",[t._v("未分配")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"通过时间",align:"center",width:"160",prop:"created_at",sortable:"","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"一级目录",align:"center",width:"130","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.menu_1))]),t._v(" "),e.row.menu_1?t._e():a("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"二级目录",align:"center",width:"130","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.menu_2))]),t._v(" "),e.row.menu_2?t._e():a("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"三级目录",align:"center",width:"130","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.menu_3))]),t._v(" "),e.row.menu_3?t._e():a("span",{staticClass:"sortout_color"},[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"question_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"question_btm"},[a("div",{on:{click:function(a){t.handleOpenAddCatalog(e.row.video_id)}}},[t._v("添加目录")]),t._v(" "),a("div",[t._v("预览")]),t._v(" "),a("div",{on:{click:function(a){t.handleOpenAll(e.row.menu)}}},[t._v("所有目录")])])]}}])})],1),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)]),t._v(" "),a("el-dialog",{attrs:{width:"800px","custom-class":"addDirectoryDialog",visible:t.addDirectoryDialog},on:{"update:visible":function(e){t.addDirectoryDialog=e}}},[a("span",{staticClass:"addDirectoryDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jia-xianxingfangkuang"}),t._v("添加目录")]),t._v(" "),a("div",{staticClass:"addDirectoryDialog_box"},[a("div",{staticClass:"box_list"},[a("div",{staticClass:"box_list_title"},[t._v("学科板块：")]),t._v(" "),a("div",{staticClass:"box_list_main"},[a("el-radio-group",{model:{value:t.subject,callback:function(e){t.subject=e},expression:"subject"}},t._l(t.subjectData,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.menu_id},on:{change:function(a){t.tt(e)}},model:{value:t.disableDialogRadio,callback:function(e){t.disableDialogRadio=e},expression:"disableDialogRadio"}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("div",{staticClass:"box_list"},[a("div",{staticClass:"box_list_title"},[t._v("一级目录：")]),t._v(" "),a("div",{staticClass:"box_list_main"},[a("el-radio-group",{model:{value:t.firstLevel,callback:function(e){t.firstLevel=e},expression:"firstLevel"}},t._l(t.oneCatalog,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.menu_id},on:{change:function(a){t.qq(e)}},model:{value:t.disableDialogRadio1,callback:function(e){t.disableDialogRadio1=e},expression:"disableDialogRadio1"}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("div",{staticClass:"box_list"},[a("div",{staticClass:"box_list_title"},[t._v("二级目录：")]),t._v(" "),a("div",{staticClass:"box_list_main"},[a("el-radio-group",{model:{value:t.secondary,callback:function(e){t.secondary=e},expression:"secondary"}},t._l(t.twoCatalog,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.menu_id},on:{change:function(a){t.qq(e)}},model:{value:t.disableDialogRadio2,callback:function(e){t.disableDialogRadio2=e},expression:"disableDialogRadio2"}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("div",{staticClass:"box_list"},[a("div",{staticClass:"box_list_title"},[t._v("三级目录：")]),t._v(" "),a("div",{staticClass:"box_list_main"},[a("el-radio-group",{model:{value:t.thirdLevel,callback:function(e){t.thirdLevel=e},expression:"thirdLevel"}},t._l(t.threeCatalog,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.menu_id},on:{change:function(a){t.qq(e)}},model:{value:t.disableDialogRadio3,callback:function(e){t.disableDialogRadio3=e},expression:"disableDialogRadio3"}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("div",{staticClass:"box_list"},[a("div",{staticClass:"box_list_title",staticStyle:{color:"#000"}},[t._v("四级目录：")]),t._v(" "),a("div",{staticClass:"box_list_main"},[a("el-radio-group",{model:{value:t.fourthLevel,callback:function(e){t.fourthLevel=e},expression:"fourthLevel"}},t._l(t.fourCatalog,function(e,i){return a("el-radio",{key:i,attrs:{border:"",label:e.menu_id},on:{change:function(a){t.qq(e)}},model:{value:t.disableDialogRadio4,callback:function(e){t.disableDialogRadio4=e},expression:"disableDialogRadio4"}},[t._v(t._s(e.name))])}))],1)])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addDirectoryDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleAddCatalog}},[t._v("添 加")])],1)]),t._v(" "),a("el-dialog",{attrs:{width:"800px","custom-class":"allDirectoryDialog",visible:t.allDirectoryDialog},on:{"update:visible":function(e){t.allDirectoryDialog=e}}},[a("span",{staticClass:"allDirectoryDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-jia-xianxingfangkuang"}),t._v("所有目录")]),t._v(" "),a("div",{staticClass:"allDirectoryDialog_box"},t._l(t.menu,function(e,i){return a("div",{key:i,staticClass:"box_list"},[t._l(e,function(e,i){return 0===e.type?a("div",{key:i,staticClass:"box_list_title"},[t._v(t._s(e.name)+":")]):t._e()}),t._v(" "),a("div",{staticClass:"box_list_main"},[a("el-radio-group",{model:{value:t.carSelect,callback:function(e){t.carSelect=e},expression:"carSelect"}},[t._l(e,function(e,i){return 1===e.type?a("el-radio",{key:i,attrs:{label:1}},[t._v(t._s(e.name))]):t._e()}),t._v(" "),t._l(e,function(e,i){return 2===e.type?a("el-radio",{key:i,attrs:{label:2}},[t._v(t._s(e.name))]):t._e()}),t._v(" "),t._l(e,function(e,i){return 3===e.type?a("el-radio",{key:i,attrs:{label:3}},[t._v(t._s(e.name))]):t._e()}),t._v(" "),t._l(e,function(e,i){return 4===e.type?a("el-radio",{key:i,attrs:{label:4}},[t._v(t._s(e.name))]):t._e()})],2)],1)],2)})),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.allDirectoryDialog=!1}}},[t._v("关 闭")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"question_title"},[e("div",{staticClass:"title"},[this._v("专业目录分配")])])}]};var s=a("VU/8")(o,n,!1,function(t){a("seJH")},null,null);e.default=s.exports},seJH:function(t,e){}});