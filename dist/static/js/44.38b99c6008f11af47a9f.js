webpackJsonp([44],{Gz9O:function(t,e){},gEpT:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("ZPfm"),o=a("QL8K"),s=a.n(o),n={name:"HeaderAdvert",components:{BreadCrumb:l.a},data:function(){return{breadData:[{id:1,name:"商城",urls:"/index/mall/mall/Mall",icon:"icon-home"},{id:2,name:"商城广告",urls:"/index/service/Service",icon:"icon-home"},{id:3,name:"中部广告",urls:"/index/service/NewTaskAll",icon:"icon-home"}],tableData:[],tmps:[],options:[{value:1,label:"图片外部链接"},{value:2,label:"产品ID搜索"}],choseValue:"",RemarksDialog:!1,total:null,imageUrl:null,title:"",url:"",product_int:"",mall:"",isShowProductDialog:!1,products:{},productCover:""}},mounted:function(){this.getMessageList()},methods:{getMessageList:function(){var t=this;this.HttpClient.get("/admin/advertisement").then(function(e){var a=e.data,l=a.code,o=a.data;200===l&&(t.tableData=o.data.filter(function(t){return 2===t.layout}))})},handleOpenAddAd:function(){this.RemarksDialog=!0,this.getMallTmp()},getMallTmp:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:1,type:0}).then(function(e){var a=e.data,l=a.code,o=a.data;200===l&&(t.tmps=o)})},searchID:function(){var t=this;this.HttpClient.post("/admin/marketProduct/baseInfo",{id:this.product_int}).then(function(e){var a=e.data,l=a.code,o=a.msg,n=a.data;if(console.log(o),200===l){t.products=n,t.isShowProductDialog=!0;var i=n.show_picture[0].path;t.productCover=""+s.a.imageUrl+i}else t.$message.error("暂无此ID")})},changeStatus:function(t){var e=this,a=t.id,l=t.status;l=1===l?3:1,this.HttpClient.post("/admin/advertisement/changeStatus",{id:a,status:l}).then(function(t){var a=t.data,l=a.code,o=a.msg;200===l?(e.$message.success(o),setTimeout(function(){e.getMessageList()},500)):e.$message.error(o)})},deleteAdv:function(t){var e=this;this.HttpClient.delete("/admin/advertisement/"+t).then(function(t){var a=t.data,l=a.code,o=a.msg;200===l?(e.$message.success(o),setTimeout(function(){e.getMessageList()},500)):e.$message.error(o)})},checkProduct:function(t){window.open(t.url,"_blank")},beforeAvatarUpload:function(t){var e=this,a="image/jpeg"===t.type;t.size;if(!a)return this.$message.error("上传图片只能是 JPG 格式!");this.HttpClient.form("/admin/uploadOneImage",{images:t}).then(function(t){var a=t.data,l=a.code,o=a.msg,s=a.path;200===l?(e.$message.success(o),e.imageUrl=s):e.$message.error(o)})},handleSubmitNewAdv:function(){var t=this;if(1===this.choseValue)var e={title:this.title,image:this.imageUrl,url:this.url,layout:2};else e={title:this.title,image:this.imageUrl,product_int:this.product_int,product_name:this.products.title?this.products.title:"",company_name:this.products.company_name,layout:2};console.log(e),this.HttpClient.post("/admin/advertisement",e).then(function(e){var a=e.data,l=a.code,o=a.msg;200===l?(t.$message.success(o),t.RemarksDialog=!1,t.title="",t.choseValue="",t.mall="",t.url="",t.product_int="",t.product_name="",t.company_name="",setTimeout(function(){t.getMessageList()},500)):t.$message.error(o)})},handleCurrentChange:function(t){console.log(t)}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"HeaderAdvert"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"newInformation_main"},[t._m(0),t._v(" "),a("div",{staticClass:"tiledai",on:{click:t.handleOpenAddAd}},[t._v("创建新广告")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content_main"},[a("div",{staticClass:"content_table"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"广告标题",align:"center",width:"200",prop:"title","show-overflow-tooltip":"",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.title?a("span",[t._v(t._s(e.row.title))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品ID",align:"center",width:"150","show-overflow-tooltip":"",prop:"id"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.id?a("span",[t._v(t._s(e.row.id))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"产品名称",align:"center",width:"200","show-overflow-tooltip":"",prop:"product_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.product_name?a("span",[t._v(t._s(e.row.product_name))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"所属板块",align:"center",width:"150","show-overflow-tooltip":"",prop:"folder_name"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.folder_name?a("span",[t._v(t._s(e.row.folder_name))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"访问次数",align:"center",width:"100","show-overflow-tooltip":"",prop:"view_num"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.view_num?a("span",[t._v(t._s(e.row.view_num))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"购买总数",align:"center",width:"150","show-overflow-tooltip":"",prop:"sole_num"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.sole_num?a("span",[t._v(t._s(e.row.sole_num))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"150","show-overflow-tooltip":"",prop:"created_at"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.created_at?a("span",[t._v(t._s(e.row.created_at))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center",width:"80","show-overflow-tooltip":"",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?a("span",[t._v("删除")]):t._e(),t._v(" "),1===e.row.status?a("span",[t._v("上线")]):t._e(),t._v(" "),2===e.row.status?a("span",[t._v("审核")]):t._e(),t._v(" "),3===e.row.status?a("span",[t._v("下线")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center","class-name":"mallReview_scope"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"mallReview_btm"},[a("el-button",{on:{click:function(a){t.checkProduct(e.row)}}},[t._v("预览")]),t._v(" "),a("div",{on:{click:function(a){t.changeStatus(e.row)}}},[1===e.row.status?a("el-button",[t._v("下线")]):t._e(),t._v(" "),3===e.row.status?a("el-button",[t._v("上线")]):t._e()],1),t._v(" "),a("el-button",{on:{click:function(a){t.deleteAdv(e.row.id)}}},[t._v("删除")]),t._v(" "),a("el-button",[t._v("购买记录")])],1)]}}])})],1)],1)])])]),t._v(" "),t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":25},on:{"current-change":function(e){t.handleCurrentChange(e)}}}):t._e(),t._v(" "),a("el-dialog",{attrs:{visible:t.RemarksDialog,width:"750px","custom-class":"RemarksDialog"},on:{"update:visible":function(e){t.RemarksDialog=e}}},[a("span",{staticClass:"RemarksDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-edit-square"}),t._v("创建新广告\n    ")]),t._v(" "),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://test.kslab.com/api/article/null","show-file-list":!0,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"广告标题"}},[a("el-input",{model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"选择链接"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.choseValue,callback:function(e){t.choseValue=e},expression:"choseValue"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),1==t.choseValue?a("div",[a("el-form-item",{attrs:{label:"图片链接"}},[a("el-input",{model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1)],1):t._e(),t._v(" "),2==t.choseValue?a("div",[a("el-form-item",{attrs:{label:"产品id"}},[a("div",{staticClass:"flex"},[a("el-input",{model:{value:t.product_int,callback:function(e){t.product_int=e},expression:"product_int"}}),t._v(" \n            "),a("el-button",{attrs:{type:"primary"},on:{click:t.searchID}},[t._v("搜索")])],1)])],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"商城板块"}},[a("el-select",{attrs:{placeholder:"活动区域"},model:{value:t.mall,callback:function(e){t.mall=e},expression:"mall"}},t._l(t.tmps,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.RemarksDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmitNewAdv}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.isShowProductDialog,"custom-class":"product-dialog",width:"500px"},on:{"update:visible":function(e){t.isShowProductDialog=e}}},[a("div",{staticClass:"flex"},[a("img",{staticClass:"product-cover",attrs:{src:t.productCover}}),t._v(" "),a("div",[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"产品名称"}},[a("el-input",{model:{value:t.products.title,callback:function(e){t.$set(t.products,"title",e)},expression:"products.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商家名称"}},[a("el-input",{model:{value:t.products.company_name,callback:function(e){t.$set(t.products,"company_name",e)},expression:"products.company_name"}})],1)],1)],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowProductDialog=!1}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("中部广告")]),this._v(" "),e("p",{staticStyle:{cursor:"pointer"}},[e("i",{staticClass:"iconfont icon-shuaxin"}),this._v("\n        刷新\n      ")])])}]};var r=a("VU/8")(n,i,!1,function(t){a("Gz9O")},null,null);e.default=r.exports}});