webpackJsonp([71],{CyHF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"ProductCatalogAssignment",components:{BreadCrumb:a("ZPfm").a},data:function(){return{breadData:[{id:1,name:"功能控制",urls:"/index/functionControl",icon:"icon-home"},{id:2,name:"商城菜单管理",urls:"/index/functionControl/mallManagement/mall-management",icon:"icon-home"},{id:3,name:"产品目录分配",urls:"/index/functionControl/mallManagement/product-catalog-assignment",icon:"icon-home"}],selectVideotitle:"",selectVideotitleid:"",menuList:[],options:[],value:"",secondOptions:[],secondValue:"",thirdOptions:[],thirdValue:"",listData:[],productData:[],selectproductNum:"",selectData:{},selectNumchoseData:[],productType:"",productID:"",centerDialogVisible:!1,selectNum:"1",currentPage:1,pageSize:20,total:0}},mounted:function(){this.getTypelist(),this.getselectOptionFn(1,"","",this.datalevel)},methods:{getTypelist:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:1,type:0}).then(function(e){console.log(e),200===e.data.code&&(t.menuList=e.data.data,t.selectVideotitle=t.menuList[1].menu_id,t.getlistData())})},getlistData:function(){var t=this,e={size:this.pageSize,page:this.currentPage,hasProperty:!1,id:this.productID,name:this.productType};this.HttpClient.post("/admin/category/lists",e).then(function(e){console.log(e),200===e.data.code&&(t.listData=e.data.data.data,t.total=e.data.data.total)})},getselectOptionFn:function(t,e,a,i){var s=this,l={isFolder:t,menu_id:e,last_menu:a};console.log(l),this.HttpClient.post("/shop/menu/getOneChild",l).then(function(t){console.log(t),200==t.data.code&&(""==a?0===i?s.options=t.data.data.child:1==i?s.secondOptions=t.data.data.child:2==i&&(s.thirdOptions=t.data.data.child):3==i&&(s.productData=t.data.data))})},changefirstValue:function(){console.log(this.value),this.datalevel=2,this.secondValue="",this.thirdValue="",this.productData=[],this.getselectOptionFn(0,this.value,"",1)},changesecondValue:function(){console.log(this.secondValue),this.datalevel=3,this.thirdValue="",this.productData=[],this.getselectOptionFn(0,this.secondValue,"",2)},changethirdValue:function(){console.log(this.thirdValue),this.getselectOptionFn(0,0,this.thirdValue,3)},changeproTypeModel:function(t){console.log(t),this.selectVideotitleid=t.menu_id,this.value="",this.secondValue="",this.thirdValue="",this.getselectOptionFn(0,this.selectVideotitleid,"",0)},searchProductID:function(){this.getlistData()},searchProductType:function(){this.getlistData()},addList:function(t){var e=this;if(this.thirdValue){var a={menu_id:this.thirdValue,relation_id:t.id,type:2,relation_type:10};this.HttpClient.post("/admin/menuRelationship/create",a).then(function(t){console.log(t),200==t.data.code?(e.$message.success(t.data.msg),setTimeout(function(){e.getselectOptionFn(0,0,e.thirdValue,e.datalevel)},500)):e.$message.error(t.data.msg)})}else this.$message.error("请选择三级目录")},changesSelectFn:function(){1==this.selectNum?this.selectNumchoseData=this.selectData.property_select:2==this.selectNum&&(this.selectNumchoseData=this.selectData.property_num)},changeProduct:function(t){var e=this;this.selectNum="1",this.centerDialogVisible=!0,this.HttpClient.get("/admin/category/edit",{id:t.id}).then(function(t){if(console.log(t),200==t.data.code){var a=[],i=[];t.data.data.property.forEach(function(t,e){1==t.rule||2==t.rule?a.push(t):3!=t.rule&&4!=t.rule&&5!=t.rule||i.push(t)}),e.selectData.property_select=a,e.selectNumchoseData=a,e.selectData.property_num=i}})},deleteProduct:function(t){var e=this,a={menu_id:this.thirdValue,relation_id:t};this.HttpClient.post("/admin/menuRelationship/destroy",a).then(function(t){200==t.data.code&&(e.$message.success(t.data.msg),setTimeout(function(){e.getselectOptionFn(0,0,e.thirdValue,e.datalevel)},500))})},currentChange:function(t){this.currentPage=t,this.getlistData()}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"productcatalogAssignment"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"video_titlebox"},[t._m(0),t._v(" "),a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"productbox"},[a("div",{staticClass:"product_header"},[a("div",{staticClass:"choseType"},[t._v("选择")]),t._v(" "),a("el-radio-group",{attrs:{size:"small"},model:{value:t.selectVideotitle,callback:function(e){t.selectVideotitle=e},expression:"selectVideotitle"}},t._l(t.menuList,function(e,i){return a("el-radio",{key:i,attrs:{label:e.name,border:""},on:{change:function(a){t.changeproTypeModel(e)}}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("div",{staticClass:"product_header"},[a("div",{staticClass:"selects"},[a("el-select",{attrs:{placeholder:"一级目录"},on:{change:function(e){t.changefirstValue()}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,function(t){return a("el-option",{key:t.menu_id,attrs:{label:t.name,value:t.menu_id}})})),t._v(" "),a("el-select",{attrs:{placeholder:"二级目录"},on:{change:function(e){t.changesecondValue()}},model:{value:t.secondValue,callback:function(e){t.secondValue=e},expression:"secondValue"}},t._l(t.secondOptions,function(t){return a("el-option",{key:t.menu_id,attrs:{label:t.name,value:t.menu_id}})})),t._v(" "),a("el-select",{attrs:{placeholder:"三级目录"},on:{change:function(e){t.changethirdValue()}},model:{value:t.thirdValue,callback:function(e){t.thirdValue=e},expression:"thirdValue"}},t._l(t.thirdOptions,function(t){return a("el-option",{key:t.menu_id,attrs:{label:t.name,value:t.menu_id}})}))],1)]),t._v(" "),a("div",{staticClass:"listtable"},[a("div",{staticClass:"product_header"},[a("div",{staticClass:"productlistbox"},[a("p",{staticStyle:{"text-align":"left"}},[t._v("现包含产品类型")]),t._v(" "),a("div",{staticStyle:{"text-align":"left","margin-top":"10px"}},t._l(t.productData,function(e){return a("el-radio",{key:e.name,attrs:{label:e.id,border:"",size:"medium"},on:{change:function(a){t.changeProduct(e)}},model:{value:t.selectproductNum,callback:function(e){t.selectproductNum=e},expression:"selectproductNum"}},[t._v("\n                "+t._s(e.name)+"\n                "),a("el-button",{attrs:{icon:"el-icon-delete"},on:{click:function(a){t.deleteProduct(e.id)}}})],1)}))])])])]),t._v(" "),a("div",{staticClass:"productbox"},[a("div",{staticClass:"product_header"},[a("div",{staticClass:"product_header_search"},[a("el-input",{attrs:{placeholder:"请输入产品类型",clearable:""},on:{change:t.searchProductType},model:{value:t.productType,callback:function(e){t.productType=e},expression:"productType"}}),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchProductType}},[t._v("搜索")])],1),t._v(" "),a("div",{staticClass:"product_header_search"},[a("el-input",{attrs:{placeholder:"请输入产品ID",clearable:""},on:{change:t.searchProductID},model:{value:t.productID,callback:function(e){t.productID=e},expression:"productID"}}),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchProductID}},[t._v("搜索")])],1)]),t._v(" "),a("div",{staticClass:"listtable"},[a("div",{staticClass:"product_header"},t._l(t.listData,function(e,i){return a("div",{key:i,staticClass:"imgAndwordBox"},[a("div",{staticClass:"imgbox"},[a("img",{staticClass:"image",attrs:{src:t.Tools.handleImg(e.image)}})]),t._v(" "),a("div",{staticStyle:{padding:"14px","margin-top":"5px"}},[a("p",{staticClass:"imglist"},[t._v(t._s(e.name))]),t._v(" "),a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(a){t.addList(e)}}},[t._v("添加")])],1)])})),t._v(" "),a("div",{staticClass:"block"},[t.total?a("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)])])]),t._v(" "),a("div",[a("el-dialog",{attrs:{title:"选择框和数字区间",visible:t.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("div",{staticClass:"showinfo"},[a("div",[a("el-radio",{attrs:{label:"1",border:""},on:{change:t.changesSelectFn},model:{value:t.selectNum,callback:function(e){t.selectNum=e},expression:"selectNum"}},[t._v("选择框")]),t._v(" "),a("el-radio",{attrs:{label:"2",border:""},on:{change:t.changesSelectFn},model:{value:t.selectNum,callback:function(e){t.selectNum=e},expression:"selectNum"}},[t._v("数字区间")])],1),t._v(" "),t._l(t.selectNumchoseData,function(e,i){return a("div",{key:i,staticStyle:{"margin-top":"10px"}},[a("div",[a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.property_name))]),t._v(" "),a("el-tag",{attrs:{type:"success"}},[t._v(t._s(1==e.rule?"单选":2==e.rule?"多选":3==e.rule?"整数":4==e.rule?"一位小数":5==e.rule?"两位小数":""))])],1),t._v(" "),1==t.selectNum?a("div",{staticStyle:{"margin-top":"10px"}},t._l(e.values,function(e,i){return a("el-tag",{key:i},[t._v(t._s(e.value))])})):t._e(),t._v(" "),2==t.selectNum?a("div",{staticStyle:{"margin-top":"10px"}},[a("el-tag",[t._v(t._s(e.unit_cn+"("+e.unit+")"))])],1):t._e()])})],2)])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"videopage_title"},[e("div",{staticClass:"title"},[this._v("产品目录分配")])])}]};var l=a("VU/8")(i,s,!1,function(t){a("u+d3")},null,null);e.default=l.exports},"u+d3":function(t,e){}});