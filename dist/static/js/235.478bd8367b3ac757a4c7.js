webpackJsonp([235],{ChbU:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"Business-Connection",data:function(){return{breadData:[{id:1,name:"企业",urls:"/index/question/question",icon:"icon-home"},{id:2,name:"企业关系",urls:"/index/question/questionContents",icon:"icon-home"}],companySearch:"",companyData:[{attachment:""}],remarkVisible:!1,accessoryVisible:!1,confirmDialog:!1,remark:"",historyData:[],id:"",status:null,index:0,currentPage:1,pageSize:25,total:0}},components:{BreadCrumb:s("ZPfm").a},methods:{getCompanyList:function(){var t=this,a={page:this.currentPage,size:this.pageSize};this.companySearch&&(a.company_name=this.companySearch),this.HttpClient.post("/admin/cooperation/lists",a).then(function(a){console.log(a),200===a.data.code&&(t.companyData=a.data.data.data,t.total=a.data.data.total)})},getRemarkList:function(t){var a=this;this.HttpClient.post("/admin/remarkLog/lists",{source_id:t}).then(function(t){console.log(t),200===t.data.code?(a.historyData=t.data.data,a.$set(a.historyData,a.historyData.length-1,a.historyData[a.historyData.length-1])):a.historyData=[]})},changeStatus:function(t){var a=this;this.HttpClient.post("/admin/cooperation/changeStatus",{status:t,business_id:this.id}).then(function(t){console.log(t),200===t.data.code?(a.$message.success(t.data.msg),setTimeout(function(){a.getCompanyList()},500)):a.$message.error(t.data.msg)})},continueButton:function(t){this.id=t,this.status=2,this.confirmDialog=!0},interestButton:function(t){this.id=t,this.status=0,this.confirmDialog=!0},finishButton:function(t){this.id=t,this.status=3,this.confirmDialog=!0},addRemark:function(){var t=this;this.HttpClient.post("/admin/remarkLog/create",{content:this.remark,source_id:this.id}).then(function(a){console.log(a),200===a.data.code?(t.$message.success(a.data.msg),t.remark="",setTimeout(function(){t.getRemarkList(t.id)},500)):t.$message.error(a.data.msg)})},remarkButton:function(t){this.id=t,this.remarkVisible=!0,this.getRemarkList(t)},accessoryButton:function(t){console.log(t),this.index=t,this.accessoryVisible=!0},confirmOperation:function(){this.confirmDialog=!1,this.changeStatus(this.status)},currentChange:function(t){this.currentPage=t,this.getCompanyList()}},created:function(){this.getCompanyList()}},e={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"business_connection"},[s("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),s("div",{staticClass:"business_main"},[t._m(0),t._v(" "),s("div",{staticClass:"business_header"},[s("div",{staticClass:"business_search"},[s("div",[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"公司名称搜索"},model:{value:t.companySearch,callback:function(a){t.companySearch=a},expression:"companySearch"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)])]),t._v(" "),s("div",{staticClass:"business_content"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.companyData,border:!0}},[s("el-table-column",{attrs:{label:"ID",align:"center",width:"65",prop:"id",sortable:""}}),t._v(" "),s("el-table-column",{attrs:{label:"公司名称",align:"center",width:"280"},scopedSlots:t._u([{key:"default",fn:function(a){return[s("p",[t._v(t._s(a.row.company_name))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"联系人",align:"center",width:"110"},scopedSlots:t._u([{key:"default",fn:function(a){return[s("p",[t._v(t._s(a.row.name))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"企业电话",align:"center",prop:"phone",width:"180"}}),t._v(" "),s("el-table-column",{attrs:{label:"状态",align:"center",width:"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n                            "+t._s(0===a.row.status?"不感兴趣":1===a.row.status?"待联系":2===a.row.status?"继续跟进":"结束")+"\n                        ")]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"创建时间",align:"center",width:"180",prop:"created_at",sortable:""}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center","class-name":"business_scope"},scopedSlots:t._u([{key:"default",fn:function(a){return[s("div",{staticClass:"business_btm"},[1===a.row.status?s("div",{on:{click:function(s){t.continueButton(a.row.business_id)}}},[t._v("继续跟进")]):t._e(),t._v(" "),2===a.row.status||1===a.row.status?s("div",{on:{click:function(s){t.interestButton(a.row.business_id)}}},[t._v("不感兴趣")]):t._e(),t._v(" "),2===a.row.status?s("div",{on:{click:function(s){t.finishButton(a.row.business_id)}}},[t._v("结束")]):t._e(),t._v(" "),s("div",{on:{click:function(s){t.remarkButton(a.row.business_id)}}},[t._v("备注")]),t._v(" "),s("div",{on:{click:function(s){t.accessoryButton(a.$index)}}},[t._v("查看详情附件")])])]}}])})],1),t._v(" "),t.total?s("el-pagination",{attrs:{layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.currentChange}}):t._e()],1)]),t._v(" "),s("el-dialog",{attrs:{visible:t.remarkVisible,width:"470px","custom-class":"remarkDialog"},on:{"update:visible":function(a){t.remarkVisible=a}}},[s("span",{staticClass:"remarkDialog_title",attrs:{slot:"title"},slot:"title"},[s("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),s("div",{staticClass:"remarkDialog_main"},[s("div",{staticClass:"remarkTitle"},[t._v("内容")]),t._v(" "),s("div",{staticClass:"remarkInput"},[s("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:t.remark,callback:function(a){t.remark=a},expression:"remark"}})],1),t._v(" "),s("div",{staticClass:"remarkTitle"},[t._v("历史")]),t._v(" "),s("div",{staticClass:"remarkHistory"},t._l(t.historyData,function(a,i){return s("div",{key:i},[s("div",{staticClass:"remarkHistoryUser"},[s("i",{staticClass:"iconfont icon-dian"}),s("p",[t._v(t._s(a.create_name))]),s("span",[t._v(t._s(a.created_at))])]),t._v(" "),s("p",[t._v(t._s(a.content))])])}))]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(a){t.remarkVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.addRemark}},[t._v("提 交")])],1)]),t._v(" "),s("el-dialog",{attrs:{visible:t.accessoryVisible,width:"400px"},on:{"update:visible":function(a){t.accessoryVisible=a}}},[s("div",{staticClass:"dialog_head_title",attrs:{slot:"title"},slot:"title"},[s("i",{staticClass:"iconfont icon-faxian examine_icon"}),t._v(" "),s("span",[t._v("查看详情")])]),t._v(" "),s("div",{staticClass:"examine_content"},[s("div",{staticClass:"examine_list"},[s("div",{staticClass:"examine_text",domProps:{innerHTML:t._s(t.companyData[t.index].content)}})])]),t._v(" "),s("div",{staticClass:"img_content"},[s("div",{staticClass:"img_items"},t._l(t.companyData[t.index].attachment,function(a,i){return s("a",{key:i,class:i%3==0?"img_item1":"img_item",attrs:{href:t.Tools.handleImg(a)+"?attname="}},[s("img",{staticClass:"img",attrs:{src:t.Tools.handleImg(a)+"?imageView2/1/w/60/h/60",alt:""}}),t._v(" "),s("div",{staticClass:"modal_img"},[s("i",{staticClass:"el-icon-download modal_icon"})])])}))]),t._v(" "),s("div",{staticClass:"user_footer",attrs:{slot:"footer"},slot:"footer"},[s("el-row",[s("el-button",{staticClass:"btn_foot",attrs:{type:"primary"},on:{click:function(a){t.accessoryVisible=!1}}},[t._v("关闭")])],1)],1)]),t._v(" "),s("el-dialog",{attrs:{width:"470px","custom-class":"confirmDialog",visible:t.confirmDialog,center:""},on:{"update:visible":function(a){t.confirmDialog=a}}},[s("span",{staticClass:"confirmDialog_title",attrs:{slot:"title"},slot:"title"},[s("i",{staticClass:"iconfont icon-huaban4"})]),t._v(" "),s("div",{staticClass:"confirmDialog_box"},[s("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),s("p",[t._v("确定"+t._s(0===t.status?"不感兴趣":2===t.status?"继续跟进":"结束")+"吗？")])]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(a){t.confirmDialog=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.confirmOperation}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"business_title"},[a("div",{staticClass:"title"},[this._v("企业关系")])])}]};var n=s("VU/8")(i,e,!1,function(t){s("hfSL")},null,null);a.default=n.exports},hfSL:function(t,a){}});