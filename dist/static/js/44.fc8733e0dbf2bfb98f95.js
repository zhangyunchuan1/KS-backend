webpackJsonp([44],{IqRt:function(t,a){},lgt0:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("bOdI"),l=e.n(i),o={name:"EncyclopediaDistribution",components:{BreadCrumb:e("ZPfm").a},data:function(){var t;return t={breadData:[{id:1,name:"商城目录",urls:"/index/encyclopedia/encyclopedia",icon:"icon-home"},{id:2,name:"专业目录分配",urls:"/index/encyclopedia/encyclopediaDistribution",icon:"icon-home"}],startTime:"",endTime:"",topicSearch:"",disableDialogRadio:null,tableData:[],addDirectoryDialog:!1,subject:1,firstLevel:1,secondary:1,thirdLevel:1,fourthLevel:1,allDirectoryDialog:!1,carSelect:1,engineeringSelect:1,controlSelect:1},l()(t,"startTime",null),l()(t,"endTime",null),l()(t,"title",null),l()(t,"subjectData",[]),l()(t,"oneCatalog",[]),l()(t,"twoCatalog",[]),l()(t,"threeCatalog",[]),l()(t,"fourCatalog",[]),l()(t,"fiveCatalog",[]),l()(t,"disableDialogRadio1",null),l()(t,"disableDialogRadio2",null),l()(t,"disableDialogRadio3",null),l()(t,"disableDialogRadio4",null),l()(t,"menuId",null),l()(t,"productId",null),l()(t,"menu",[]),l()(t,"addId",null),l()(t,"currentPage",1),l()(t,"total",null),t},mounted:function(){this.getPassQuestionList(),this.getSubjectCatalog()},methods:{handlePreview:function(){this.$message.warning("此功能跳转前台页面，暂未开放！")},handleOpenAll:function(t){this.menu=t,this.allDirectoryDialog=!0},handleAddCatalog:function(){var t=this;console.log(this.addId,this.productId),this.HttpClient.post("/admin/menuRelationship/create",{menu_id:this.addId,relation_id:this.productId,type:1,relation_type:9}).then(function(a){console.log(a),200===a.data.code?(t.$message.success(a.data.msg),setTimeout(function(){t.getPassQuestionList()},400),t.addDirectoryDialog=!1):t.$message.error(a.data.msg)})},qq:function(t){this.menuId=t.menu_id,1===t.type&&(this.twoCatalog=[],this.threeCatalog=[],this.fourCatalog=[]),2===t.type&&(this.threeCatalog=[],this.fourCatalog=[]),3===t.type&&(this.fourCatalog=[]),t.type,this.getNextCatalog(t.menu_id,t.type)},tt:function(t){this.oneCatalog=[],this.twoCatalog=[],this.threeCatalog=[],this.fourCatalog=[],this.getChildeCatalogList(t)},handleOpenAddCatalog:function(t){this.productId=t,this.oneCatalog=[],this.threeCatalog=[],this.fourCatalog=[],this.getSubjectCatalog(),this.addDirectoryDialog=!0},getNextCatalog:function(t,a){var e=this;this.HttpClient.post("/admin/menu/getOneChild",{menu_id:t,menu_type:3}).then(function(i){200===i.data.code&&(1===a?(e.twoCatalog=i.data.data.child,e.addId=t):2===a?(e.addId=t,e.threeCatalog=i.data.data.child):3===a?(e.addId=t,e.fourCatalog=i.data.data.child):4===a&&(e.addId=t,e.fiveCatalog=i.data.data.child))})},getChildeCatalogList:function(t){var a=this;this.HttpClient.post("/admin/menu/getOneChild",{menu_id:t.menu_id,menu_type:3}).then(function(t){a.oneCatalog=t.data.data.child})},getSubjectCatalog:function(){var t=this;this.HttpClient.post("/admin/menu/getList",{menu_type:3}).then(function(a){t.subjectData=a.data.data})},getPassQuestionList:function(){var t=this,a={start_time:this.startTime,end_time:this.endTime,title:this.title,page:this.currentPage,size:25};this.HttpClient.post("/admin/marketProduct/getListsWithMajorMenu",a).then(function(a){console.log(a),t.tableData=a.data.data.data,t.total=a.data.data.total;for(var e=0;e<a.data.data.data.length;e++)if(0!==a.data.data.data[e].menu.length){t.tableData[e].is_distribution=1;for(var i=0;i<a.data.data.data[e].menu[0].length;i++){var l=a.data.data.data[e].menu[0][i].type;0==l&&(t.tableData[e].subject=a.data.data.data[e].menu[0][i].name),1==l&&(t.tableData[e].menu_1=a.data.data.data[e].menu[0][i].name),2==l&&(t.tableData[e].menu_2=a.data.data.data[e].menu[0][i].name),3==l&&(t.tableData[e].menu_3=a.data.data.data[e].menu[0][i].name),4==l&&(t.tableData[e].menu_4=a.data.data.data[e].menu[0][i].name)}}else t.tableData[e].is_distribution=0})},handleChangeTitle:function(){""===this.topicSearch?this.title=null:this.title=this.topicSearch,this.title=this.topicSearch},handleTitleSearch:function(){this.getPassQuestionList()},handleStartTime:function(t){this.getPassQuestionList()},handleEndTime:function(t){this.getPassQuestionList()},handleCurrentChange:function(t){this.currentPage=t,this.getPassQuestionList()},filterPlate:function(t,a,e){return a[e.property]===t},filterSecondary:function(t,a,e){return a[e.property]===t},filterDistribution:function(t,a,e){return a[e.property]===t},handleRemove:function(t,a){},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0}}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"ptoductDistribution"},[e("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),e("div",{staticClass:"question_main"},[t._m(0),t._v(" "),e("div",{staticClass:"question_header"},[e("div",{staticClass:"question_select"},[e("div",{staticClass:"date_item"},[e("p",{staticClass:"date_label"},[t._v("开始")]),t._v(" "),e("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期"},on:{change:t.handleStartTime},model:{value:t.startTime,callback:function(a){t.startTime=a},expression:"startTime"}})],1),t._v(" "),e("div",{staticClass:"date_item"},[e("p",{staticClass:"date_label"},[t._v("截止")]),t._v(" "),e("el-date-picker",{staticClass:"date_picker_1",attrs:{type:"date",size:"mini",placeholder:"选择日期"},on:{change:t.handleEndTime},model:{value:t.endTime,callback:function(a){t.endTime=a},expression:"endTime"}})],1)]),t._v(" "),e("div",{staticClass:"question_search"},[e("div",[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:"商品名称搜索"},on:{change:t.handleChangeTitle},model:{value:t.topicSearch,callback:function(a){t.topicSearch=a},expression:"topicSearch"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleTitleSearch},slot:"append"})],1)],1)])]),t._v(" "),e("div",{staticClass:"question_content"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0}},[e("el-table-column",{attrs:{label:"产品ID",align:"center","show-overflow-tooltip":"",width:"100",prop:"id",sortable:""}}),t._v(" "),e("el-table-column",{attrs:{label:"商品名称","show-overflow-tooltip":"",align:"center",prop:"title",width:"200"}}),t._v(" "),e("el-table-column",{attrs:{label:"商家名称",align:"center","show-overflow-tooltip":"",prop:"title",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{label:"产品类型","show-overflow-tooltip":"",align:"center",width:"110"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.category?e("span",[t._v(t._s(a.row.category))]):e("span",{staticClass:"sortout_color"},[t._v("暂无")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"是否分配",align:"center","show-overflow-tooltip":"",filters:[{text:"已分配",value:1},{text:"未分配",value:0}],"filter-method":t.filterDistribution,prop:"is_distribution",width:"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.is_distribution?e("span",{staticClass:"normal_color"},[t._v("已分配")]):t._e(),t._v(" "),0==a.row.is_distribution?e("span",{staticClass:"sortout_color"},[t._v("未分配")]):t._e()]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"通过时间","show-overflow-tooltip":"",align:"center",width:"160",prop:"created_at",sortable:""}}),t._v(" "),e("el-table-column",{attrs:{label:"一级目录",align:"center","show-overflow-tooltip":"",width:"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.menu_1_name))]),t._v(" "),a.row.menu_1?t._e():e("span",[t._v("无")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"二级目录",align:"center","show-overflow-tooltip":"",width:"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.menu_2_name))]),t._v(" "),a.row.menu_2?t._e():e("span",[t._v("无")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"三级目录",align:"center","show-overflow-tooltip":"",width:"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.menu_3_name))]),t._v(" "),a.row.menu_3?t._e():e("span",[t._v("无")])]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(e){t.handleOpenAddCatalog(a.row.product_id)}}},[t._v("添加目录")]),t._v(" "),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(e){t.handleOpenAll(a.row.menu)}}},[t._v("所有目录")]),t._v(" "),e("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:t.handlePreview}},[t._v("预览")])]}}])})],1)],1),t._v(" "),e("div",{staticClass:"paging"},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":25,total:t.total},on:{"current-change":function(a){t.handleCurrentChange(a)}}})],1)]),t._v(" "),e("el-dialog",{attrs:{width:"800px","custom-class":"addDirectoryDialog",visible:t.addDirectoryDialog},on:{"update:visible":function(a){t.addDirectoryDialog=a}}},[e("span",{staticClass:"addDirectoryDialog_title",attrs:{slot:"title"},slot:"title"},[e("i",{staticClass:"iconfont icon-jia-xianxingfangkuang"}),t._v("添加目录")]),t._v(" "),e("div",{staticClass:"addDirectoryDialog_box"},[e("div",{staticClass:"box_list"},[e("div",{staticClass:"box_list_title"},[t._v("学科板块：")]),t._v(" "),e("div",{staticClass:"box_list_main"},[e("el-radio-group",{model:{value:t.subject,callback:function(a){t.subject=a},expression:"subject"}},t._l(t.subjectData,function(a,i){return e("el-radio",{key:i,attrs:{border:"",label:a.menu_id},on:{change:function(e){t.tt(a)}},model:{value:t.disableDialogRadio,callback:function(a){t.disableDialogRadio=a},expression:"disableDialogRadio"}},[t._v(t._s(a.name))])}))],1)]),t._v(" "),e("div",{staticClass:"box_list"},[e("div",{staticClass:"box_list_title"},[t._v("一级目录：")]),t._v(" "),e("div",{staticClass:"box_list_main"},[e("el-radio-group",{model:{value:t.firstLevel,callback:function(a){t.firstLevel=a},expression:"firstLevel"}},t._l(t.oneCatalog,function(a,i){return e("el-radio",{key:i,attrs:{border:"",label:a.menu_id},on:{change:function(e){t.qq(a)}},model:{value:t.disableDialogRadio1,callback:function(a){t.disableDialogRadio1=a},expression:"disableDialogRadio1"}},[t._v(t._s(a.name))])}))],1)]),t._v(" "),e("div",{staticClass:"box_list"},[e("div",{staticClass:"box_list_title"},[t._v("二级目录：")]),t._v(" "),e("div",{staticClass:"box_list_main"},[e("el-radio-group",{model:{value:t.secondary,callback:function(a){t.secondary=a},expression:"secondary"}},t._l(t.twoCatalog,function(a,i){return e("el-radio",{key:i,attrs:{border:"",label:a.menu_id},on:{change:function(e){t.qq(a)}},model:{value:t.disableDialogRadio2,callback:function(a){t.disableDialogRadio2=a},expression:"disableDialogRadio2"}},[t._v(t._s(a.name))])}))],1)]),t._v(" "),e("div",{staticClass:"box_list"},[e("div",{staticClass:"box_list_title"},[t._v("三级目录：")]),t._v(" "),e("div",{staticClass:"box_list_main"},[e("el-radio-group",{model:{value:t.thirdLevel,callback:function(a){t.thirdLevel=a},expression:"thirdLevel"}},t._l(t.threeCatalog,function(a,i){return e("el-radio",{key:i,attrs:{border:"",label:a.menu_id},on:{change:function(e){t.qq(a)}},model:{value:t.disableDialogRadio3,callback:function(a){t.disableDialogRadio3=a},expression:"disableDialogRadio3"}},[t._v(t._s(a.name))])}))],1)])]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.addDirectoryDialog=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.handleAddCatalog}},[t._v("添 加")])],1)]),t._v(" "),e("el-dialog",{attrs:{width:"800px","custom-class":"allDirectoryDialog",visible:t.allDirectoryDialog},on:{"update:visible":function(a){t.allDirectoryDialog=a}}},[e("span",{staticClass:"allDirectoryDialog_title",attrs:{slot:"title"},slot:"title"},[e("i",{staticClass:"iconfont icon-jia-xianxingfangkuang"}),t._v("所有目录")]),t._v(" "),e("div",{staticClass:"allDirectoryDialog_box"},t._l(t.menu,function(a,i){return e("div",{key:i,staticClass:"box_list"},[t._l(a,function(a,i){return 0===a.type?e("div",{key:i,staticClass:"box_list_title"},[t._v(t._s(a.name)+":")]):t._e()}),t._v(" "),e("div",{staticClass:"box_list_main"},[e("el-radio-group",{model:{value:t.carSelect,callback:function(a){t.carSelect=a},expression:"carSelect"}},[t._l(a,function(a,i){return 1===a.type?e("el-radio",{key:i,attrs:{label:1}},[t._v(t._s(a.name))]):t._e()}),t._v(" "),t._l(a,function(a,i){return 2===a.type?e("el-radio",{key:i,attrs:{label:1}},[t._v(t._s(a.name))]):t._e()}),t._v(" "),t._l(a,function(a,i){return 3===a.type?e("el-radio",{key:i,attrs:{label:1}},[t._v(t._s(a.name))]):t._e()}),t._v(" "),t._l(a,function(a,i){return 4===a.type?e("el-radio",{key:i,attrs:{label:1}},[t._v(t._s(a.name))]):t._e()})],2)],1)],2)})),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.allDirectoryDialog=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(a){t.allDirectoryDialog=!1}}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"question_title"},[a("div",{staticClass:"title"},[this._v("专业目录分配")])])}]};var s=e("VU/8")(o,n,!1,function(t){e("IqRt")},null,null);a.default=s.exports}});