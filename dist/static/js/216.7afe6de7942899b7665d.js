webpackJsonp([216],{"2OvU":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),o=a.n(s),i={name:"DialogueManagementSupervisor",components:{BreadCrumb:a("ZPfm").a},data:function(){return{breadData:[{id:1,name:"商城",urls:"/index/mall/mall/Mall",icon:"icon-home"},{id:2,name:"客服",urls:"/index/service/Service",icon:"icon-home"},{id:3,name:"对话管理-主管",urls:"/index/service/DialogueManagementSupervisor",icon:"icon-home"}],tableData:[],chatDialog:!1,innerVisible:!1,shieldDialog:!1,shieldRadio:null,blockReasons:"",cloneChartDialog:!1,createTaskDialog:!1,taskMarks:"",taskReason:"",taskType:"",row:{},messageData:[],replyContent:""}},mounted:function(){this.getTableData()},methods:{handleReply:function(){var t=this;console.log(this.replyContent,this.row.manager_id),this.HttpClient.post("/admin/receive/message",{manager_id:this.row.manager_id,content:this.replyContent,send_time:this.getNowFormatDate()}).then(function(e){console.log(e),200===e.data.code&&(t.messageData.push({send_time:t.getNowFormatDate(),content:t.replyContent,send_nickname:t.row.send_nickname,type:1}),t.replyContent="")})},getTableData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;this.HttpClient.post("/admin/director/message",{page:e,page_size:a}).then(function(e){console.log(e);var a=e.data,s=a.code,o=a.data,i=(o.total,o.data);200===s&&(t.tableData=i)})},openModalAndGetRowData:function(t,e){this[t]=!0,this.row=e,"chatDialog"===t&&this.getChatRecord({cs_id:this.row.cs_id,list_uid:this.row.user_id,page:1})},handleBlock:function(){var t=this,e={manager_id:this.row.manager_id,block_type:this.shieldRadio,block_reasons:this.blockReasons,block_time:this.getNowFormatDate()};this.HttpClient.post("/admin/block/user",e).then(function(e){var a=e.data,s=a.code,o=a.msg;200===s?t.$message.success(o):t.$message.error(o)})},handleEndMessage:function(){var t=this,e=this.row.manager_id;this.HttpClient.post("/admin/end/message",{manager_id:e}).then(function(e){var a=e.data,s=a.code,o=a.msg;200===s?(t.cloneChartDialog=!1,t.$message.success(o)):t.$message.error(o)})},handleCreateTask:function(){var t=this,e={customer_id:this.row.customer_id,remarks:this.taskMarks,reasons:this.taskReason,type:this.taskType};this.HttpClient.post("/admin/create/task",e).then(function(e){var a=e.data,s=a.code,o=a.msg;200===s&&(t.$message.success(o),t.createTaskDialog=!1)})},getChatRecord:function(t){var e=this;this.HttpClient.post("/admin/message/info",o()({},t,{page_size:10})).then(function(t){console.log(t.data),e.messageData=t.data.data.data.reverse()})},getNowFormatDate:function(){var t=new Date,e=t.getMonth()+1,a=t.getDate();return e>=1&&e<=9&&(e="0"+e),a>=0&&a<=9&&(a="0"+a),t.getFullYear()+"-"+e+"-"+a+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"newInformation"},[a("BreadCrumb",{staticClass:"bread",attrs:{breadData:t.breadData}}),t._v(" "),a("div",{staticClass:"newInformation_main"},[t._m(0),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"content_main"},[a("div",{staticClass:"content_table"},[a("el-table",{attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{label:"最新的对话时间",align:"center",width:"180",prop:"updated_at","show-overflow-tooltip":"",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"客服姓名",align:"center","show-overflow-tooltip":"",width:"220",prop:"admin_name"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户昵称",align:"center",width:"220","show-overflow-tooltip":"",prop:"nickname"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户类型",align:"center",width:"200","show-overflow-tooltip":"",prop:"user_type"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.user_type?a("span",[t._v("用户")]):t._e(),t._v(" "),2===e.row.user_type?a("span",[t._v("商家")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"类型",align:"center",width:"100","show-overflow-tooltip":"",prop:"dialog_type"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.dialog_type?a("span",[t._v("任务")]):t._e(),t._v(" "),1===e.row.dialog_type?a("span",[t._v("对话")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center",width:"100","show-overflow-tooltip":"",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.status?a("span",[t._v("未开始")]):t._e(),t._v(" "),2===e.row.status?a("span",[t._v("已回复")]):t._e(),t._v(" "),3===e.row.status?a("span",[t._v("未回复")]):t._e(),t._v(" "),4===e.row.status?a("span",[t._v("已结束")]):t._e(),t._v(" "),5===e.row.status?a("span",[t._v("被屏蔽")]):t._e(),t._v(" "),6===e.row.status?a("span",[t._v("已交接")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"500",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.openModalAndGetRowData("chatDialog",e.row)}}},[t._v("对话")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.openModalAndGetRowData("shieldDialog",e.row)}}},[t._v("屏蔽用户")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.openModalAndGetRowData("cloneChartDialog",e.row)}}},[t._v("结束对话")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.openModalAndGetRowData("createTaskDialog",e.row)}}},[t._v("创建任务")])]}}])})],1)],1)])])]),t._v(" "),a("el-dialog",{attrs:{visible:t.chatDialog,width:"800px","custom-class":"chatDialog"},on:{"update:visible":function(e){t.chatDialog=e}}},[a("span",{staticClass:"chatDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-mail"}),t._v("对话- 是个狼人")]),t._v(" "),a("div",{staticClass:"chatDialog_main"},[a("div",{staticClass:"main_content"},t._l(t.messageData,function(e,s){return a("div",{key:s},[2===e.type?a("div",{staticClass:"user_chat chat_list"},[a("span",[t._v(t._s(e.send_time))]),t._v(" "),a("p",[t._v(t._s(e.content))])]):t._e(),t._v(" "),1===e.type?a("div",{staticClass:"service_chat chat_list"},[a("p",{staticClass:"service_message"},[a("span",{staticClass:"service_serviceName"},[t._v(t._s(e.admin_name))]),t._v(" "),a("span",{staticClass:"service_time"},[t._v(t._s(e.send_time))])]),t._v(" "),a("p",{staticClass:"chat_content"},[t._v(t._s(e.content))])]):t._e()])})),t._v(" "),a("div",{staticClass:"char_input"},[a("el-input",{attrs:{type:"textarea",resize:"none",placeholder:"输入回复内容，请文明用语",rows:2},model:{value:t.replyContent,callback:function(e){t.replyContent=e},expression:"replyContent"}})],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.chatDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleReply}},[t._v("回 复")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.shieldDialog,width:"400px","custom-class":"shieldDialog"},on:{"update:visible":function(e){t.shieldDialog=e}}},[a("span",{staticClass:"shieldDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont\n    icon-jinyong"}),t._v("屏蔽 - "+t._s(t.row.nickname))]),t._v(" "),a("div",{staticClass:"shieldDialog_main"},[a("div",{staticClass:"main_content"},[a("el-input",{attrs:{"popper-class":"content_textarea",type:"textarea",resize:"none",rows:4,placeholder:"请输入屏蔽理由"},model:{value:t.blockReasons,callback:function(e){t.blockReasons=e},expression:"blockReasons"}}),t._v(" "),a("div",{staticClass:"content_radio"},[a("p",[t._v("屏蔽类别")]),t._v(" "),a("el-radio-group",{model:{value:t.shieldRadio,callback:function(e){t.shieldRadio=e},expression:"shieldRadio"}},[a("el-radio",{attrs:{border:"",label:1}},[t._v("骂人")]),t._v(" "),a("el-radio",{attrs:{border:"",label:2}},[t._v("要退货")]),t._v(" "),a("el-radio",{attrs:{border:"",label:3}},[t._v("要退款")]),t._v(" "),a("el-radio",{attrs:{border:"",label:4}},[t._v("嫌发货慢")])],1)],1)],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.shieldDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleBlock}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.cloneChartDialog,width:"400px","custom-class":"cloneChartDialog"},on:{"update:visible":function(e){t.cloneChartDialog=e}}},[a("span",{staticClass:"cloneChartDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-close-circle"}),t._v("结束对话")]),t._v(" "),a("div",{staticClass:"cloneChartDialog_main"},[a("div",{staticClass:"main_content"},[a("i",{staticClass:"iconfont icon-warning-circle"}),t._v(" "),a("div",[t._v("确认结束对话吗？")])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cloneChartDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleEndMessage}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.createTaskDialog,width:"400px","custom-class":"shieldDialog"},on:{"update:visible":function(e){t.createTaskDialog=e}}},[a("span",{staticClass:"shieldDialog_title",attrs:{slot:"title"},slot:"title"},[a("i",{staticClass:"iconfont icon-edit-square"}),t._v("创建任务\n    ")]),t._v(" "),a("div",{staticClass:"shieldDialog_main"},[a("div",{staticClass:"main_content"},[a("div",{staticClass:"content_title"},[t._v("任务备注")]),t._v(" "),a("el-input",{attrs:{"popper-class":"content_textarea",type:"textarea",resize:"none",rows:2,placeholder:"请输入内容"},model:{value:t.taskMarks,callback:function(e){t.taskMarks=e},expression:"taskMarks"}}),t._v(" "),a("div",{staticClass:"content_title"},[t._v("申请原因")]),t._v(" "),a("el-input",{attrs:{"popper-class":"content_textarea",type:"textarea",resize:"none",rows:2,placeholder:"请输入申请原因"},model:{value:t.taskReason,callback:function(e){t.taskReason=e},expression:"taskReason"}}),t._v(" "),a("div",{staticClass:"content_radio"},[a("p",[t._v("任务类别选择")]),t._v(" "),a("el-radio-group",{model:{value:t.taskType,callback:function(e){t.taskType=e},expression:"taskType"}},[a("el-radio",{attrs:{label:"1"}},[t._v("商城")]),t._v(" "),a("el-radio",{attrs:{label:"2"}},[t._v("活动")]),t._v(" "),a("el-radio",{attrs:{label:"3"}},[t._v("服务")]),t._v(" "),a("el-radio",{attrs:{label:"4"}},[t._v("投诉")])],1)],1)],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.createTaskDialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreateTask}},[t._v("确 定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("p",[this._v("对话管理-主管")]),this._v(" "),e("p",{staticStyle:{cursor:"pointer"}},[e("i",{staticClass:"iconfont icon-shuaxin"}),this._v("\n        刷新\n      ")])])}]};var l=a("VU/8")(i,n,!1,function(t){a("LgII")},null,null);e.default=l.exports},LgII:function(t,e){}});